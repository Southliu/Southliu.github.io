import{c as W,b as j,h as ct,g as st,e as V,f as Lt,d as It}from"./@babel_runtime@7.20.6-0b96ec9f.js";import{r}from"./react@18.2.0-d68edc9f.js";import{u as Kt,b as Tt,B as Vt}from"./rc-select@14.1.16_biqbaboplfbrettd7655fr4n2y-8d8f0265.js";import{T as _t,c as Nt,d as Je}from"./rc-tree@5.7.2_biqbaboplfbrettd7655fr4n2y-a2b27221.js";import{e as Mt,K as re,t as Pt,a as Re,h as lt}from"./rc-util@5.25.2_biqbaboplfbrettd7655fr4n2y-d56f244c.js";import"./classnames@2.3.2-96a48171.js";import"./react-is@16.13.1-45594b43.js";var dt=r.exports.createContext(null),ft=r.exports.createContext(null);function At(e){return Array.isArray(e)?e:e!==void 0?[e]:[]}function Ht(e){var t=e||{},n=t.label,i=t.value,l=t.children,u=i||"value";return{_title:n?[n]:["title","label"],value:u,key:u,children:l||"children"}}function Ye(e){return!e||e.disabled||e.disableCheckbox||e.checkable===!1}function Ot(e,t){var n=[];function i(l){l.forEach(function(u){var a=u[t.children];a&&(n.push(u[t.value]),i(a))})}return i(e),n}function ot(e){return e==null}var $t={width:0,height:0,display:"flex",overflow:"hidden",opacity:0,border:0,padding:0,margin:0},Rt=function(t,n){var i=Kt(),l=i.prefixCls,u=i.multiple,a=i.searchValue,c=i.toggleOpen,o=i.open,d=i.notFoundContent,v=r.exports.useContext(ft),w=v.virtual,C=v.listHeight,b=v.listItemHeight,L=v.treeData,I=v.fieldNames,U=v.onSelect,O=v.dropdownMatchSelectWidth,B=v.treeExpandAction,g=r.exports.useContext(dt),K=g.checkable,_=g.checkedKeys,ne=g.halfCheckedKeys,H=g.treeExpandedKeys,We=g.treeDefaultExpandAll,me=g.treeDefaultExpandedKeys,ye=g.onTreeExpand,je=g.treeIcon,Ue=g.showTreeIcon,xe=g.switcherIcon,Ce=g.treeLine,Se=g.treeNodeFilterProp,be=g.loadData,ae=g.treeLoadedKeys,Ee=g.treeMotion,ke=g.onTreeLoad,De=g.keyEntities,G=r.exports.useRef(),le=Mt(function(){return L},[o,L],function(h,E){return E[0]&&h[1]!==E[1]}),we=r.exports.useMemo(function(){return K?{checked:_,halfChecked:ne}:null},[K,_,ne]);r.exports.useEffect(function(){if(o&&!u&&_.length){var h;(h=G.current)===null||h===void 0||h.scrollTo({key:_[0]})}},[o]);var oe=String(a).toLowerCase(),Le=function(E){return oe?String(E[Se]).toLowerCase().includes(oe):!1},ie=r.exports.useState(me),ue=W(ie,2),Q=ue[0],Ie=ue[1],Ke=r.exports.useState(null),ce=W(Ke,2),se=ce[0],de=ce[1],Te=r.exports.useMemo(function(){return H?j(H):a?se:Q},[Q,se,H,a]);r.exports.useEffect(function(){a&&de(Ot(L,I))},[a]);var Be=function(E){Ie(E),de(E),ye&&ye(E)},J=function(E){E.preventDefault()},$=function(E,Y){var P=Y.node;K&&Ye(P)||(U(P.key,{selected:!_.includes(P.key)}),u||c(!1))},Ve=r.exports.useState(null),M=W(Ve,2),fe=M[0],_e=M[1],N=De[fe];if(r.exports.useImperativeHandle(n,function(){var h;return{scrollTo:(h=G.current)===null||h===void 0?void 0:h.scrollTo,onKeyDown:function(Y){var P,Ne=Y.which;switch(Ne){case re.UP:case re.DOWN:case re.LEFT:case re.RIGHT:(P=G.current)===null||P===void 0||P.onKeyDown(Y);break;case re.ENTER:{if(N){var Me=(N==null?void 0:N.node)||{},X=Me.selectable,Pe=Me.value;X!==!1&&$(null,{node:{key:fe},selected:!_.includes(Pe)})}break}case re.ESC:c(!1)}},onKeyUp:function(){}}}),le.length===0)return r.exports.createElement("div",{role:"listbox",className:"".concat(l,"-empty"),onMouseDown:J},d);var ve={fieldNames:I};return ae&&(ve.loadedKeys=ae),Te&&(ve.expandedKeys=Te),r.exports.createElement("div",{onMouseDown:J},N&&o&&r.exports.createElement("span",{style:$t,"aria-live":"assertive"},N.node.value),r.exports.createElement(_t,ct({ref:G,focusable:!1,prefixCls:"".concat(l,"-tree"),treeData:le,height:C,itemHeight:b,virtual:w!==!1&&O!==!1,multiple:u,icon:je,showIcon:Ue,switcherIcon:xe,showLine:Ce,loadData:a?null:be,motion:Ee,activeKey:fe,checkable:K,checkStrictly:!0,checkedKeys:we,selectedKeys:K?[]:_,defaultExpandAll:We},ve,{onActiveChange:_e,onSelect:$,onCheck:$,onExpand:Be,onLoad:ke,filterTreeNode:Le,expandAction:B})))},vt=r.exports.forwardRef(Rt);vt.displayName="OptionList";var ht=function(){return null},Ft="SHOW_ALL",pt="SHOW_PARENT",ze="SHOW_CHILD";function it(e,t,n,i){var l=new Set(e);return t===ze?e.filter(function(u){var a=n[u];return!(a&&a.children&&a.children.some(function(c){var o=c.node;return l.has(o[i.value])})&&a.children.every(function(c){var o=c.node;return Ye(o)||l.has(o[i.value])}))}):t===pt?e.filter(function(u){var a=n[u],c=a?a.parent:null;return!(c&&!Ye(c.node)&&l.has(c.key))}):e}var Wt=["children","value"];function gt(e){return Pt(e).map(function(t){if(!r.exports.isValidElement(t)||!t.type)return null;var n=t,i=n.key,l=n.props,u=l.children,a=l.value,c=st(l,Wt),o=V({key:i,value:a},c),d=gt(u);return d.length&&(o.children=d),o}).filter(function(t){return t})}function qe(e){if(!e)return e;var t=V({},e);return"props"in t||Object.defineProperty(t,"props",{get:function(){return Re(!1,"New `rc-tree-select` not support return node instance as argument anymore. Please consider to remove `props` access."),t}}),t}function jt(e,t,n,i,l,u){var a=null,c=null;function o(){function d(v){var w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"0",C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return v.map(function(b,L){var I="".concat(w,"-").concat(L),U=b[u.value],O=n.includes(U),B=d(b[u.children]||[],I,O),g=r.exports.createElement(ht,b,B.map(function(_){return _.node}));if(t===U&&(a=g),O){var K={pos:I,node:g,children:B};return C||c.push(K),K}return null}).filter(function(b){return b})}c||(c=[],d(i),c.sort(function(v,w){var C=v.node.props.value,b=w.node.props.value,L=n.indexOf(C),I=n.indexOf(b);return L-I}))}Object.defineProperty(e,"triggerNode",{get:function(){return Re(!1,"`triggerNode` is deprecated. Please consider decoupling data with node."),o(),a}}),Object.defineProperty(e,"allCheckedNodes",{get:function(){return Re(!1,"`allCheckedNodes` is deprecated. Please consider decoupling data with node."),o(),l?c:c.map(function(v){var w=v.node;return w})}})}function Ut(e,t){var n=t.id,i=t.pId,l=t.rootPId,u={},a=[],c=e.map(function(o){var d=V({},o),v=d[n];return u[v]=d,d.key=d.key||v,d});return c.forEach(function(o){var d=o[i],v=u[d];v&&(v.children=v.children||[],v.children.push(o)),(d===l||!v&&l===null)&&a.push(o)}),a}function Bt(e,t,n){return r.exports.useMemo(function(){return e?n?Ut(e,V({id:"id",pId:"pId",rootPId:null},n!==!0?n:{})):e:gt(t)},[t,n,e])}const Gt=function(e){var t=r.exports.useRef({valueLabels:new Map});return r.exports.useMemo(function(){var n=t.current.valueLabels,i=new Map,l=e.map(function(u){var a,c=u.value,o=(a=u.label)!==null&&a!==void 0?a:n.get(c);return i.set(c,o),V(V({},u),{},{label:o})});return t.current.valueLabels=i,[l]},[e])};function ut(e){var t=r.exports.useRef();t.current=e;var n=r.exports.useCallback(function(){return t.current.apply(t,arguments)},[]);return n}const Jt=function(e,t){return r.exports.useMemo(function(){var n=Nt(e,{fieldNames:t,initWrapper:function(l){return V(V({},l),{},{valueEntities:new Map})},processEntity:function(l,u){var a=l.node[t.value];u.valueEntities.set(a,l)}});return n},[e,t])},Yt=function(e,t,n,i){return r.exports.useMemo(function(){var l=e.map(function(o){var d=o.value;return d}),u=t.map(function(o){var d=o.value;return d}),a=l.filter(function(o){return!i[o]});if(n){var c=Je(l,!0,i);l=c.checkedKeys,u=c.halfCheckedKeys}return[Array.from(new Set([].concat(j(a),j(l)))),u]},[e,t,n,i])},qt=function(e,t,n){var i=n.treeNodeFilterProp,l=n.filterTreeNode,u=n.fieldNames,a=u.children;return r.exports.useMemo(function(){if(!t||l===!1)return e;var c;if(typeof l=="function")c=l;else{var o=t.toUpperCase();c=function(w,C){var b=C[i];return String(b).toUpperCase().includes(o)}}function d(v){var w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return v.map(function(C){var b=C[a],L=w||c(t,qe(C)),I=d(b||[],L);return L||I.length?V(V({},C),{},Lt({isLeaf:void 0},a,I)):null}).filter(function(C){return C})}return d(e)},[e,t,a,i,l])};var zt=["id","prefixCls","value","defaultValue","onChange","onSelect","onDeselect","searchValue","inputValue","onSearch","autoClearSearchValue","filterTreeNode","treeNodeFilterProp","showCheckedStrategy","treeNodeLabelProp","multiple","treeCheckable","treeCheckStrictly","labelInValue","fieldNames","treeDataSimpleMode","treeData","children","loadData","treeLoadedKeys","onTreeLoad","treeDefaultExpandAll","treeExpandedKeys","treeDefaultExpandedKeys","onTreeExpand","treeExpandAction","virtual","listHeight","listItemHeight","onDropdownVisibleChange","dropdownMatchSelectWidth","treeLine","treeIcon","showTreeIcon","switcherIcon","treeMotion"];function Qt(e){return!e||It(e)!=="object"}var Xt=r.exports.forwardRef(function(e,t){var n=e.id,i=e.prefixCls,l=i===void 0?"rc-tree-select":i,u=e.value,a=e.defaultValue,c=e.onChange,o=e.onSelect,d=e.onDeselect,v=e.searchValue,w=e.inputValue,C=e.onSearch,b=e.autoClearSearchValue,L=b===void 0?!0:b,I=e.filterTreeNode,U=e.treeNodeFilterProp,O=U===void 0?"value":U,B=e.showCheckedStrategy,g=B===void 0?ze:B,K=e.treeNodeLabelProp,_=e.multiple,ne=e.treeCheckable,H=e.treeCheckStrictly,We=e.labelInValue,me=e.fieldNames,ye=e.treeDataSimpleMode,je=e.treeData,Ue=e.children,xe=e.loadData,Ce=e.treeLoadedKeys,Se=e.onTreeLoad,be=e.treeDefaultExpandAll,ae=e.treeExpandedKeys,Ee=e.treeDefaultExpandedKeys,ke=e.onTreeExpand,De=e.treeExpandAction,G=e.virtual,le=e.listHeight,we=le===void 0?200:le,oe=e.listItemHeight,Le=oe===void 0?20:oe,ie=e.onDropdownVisibleChange,ue=e.dropdownMatchSelectWidth,Q=ue===void 0?!0:ue,Ie=e.treeLine,Ke=e.treeIcon,ce=e.showTreeIcon,se=e.switcherIcon,de=e.treeMotion,Te=st(e,zt),Be=Tt(n),J=ne&&!H,$=ne||H,Ve=H||We,M=$||_,fe=lt(a,{value:u}),_e=W(fe,2),N=_e[0],ve=_e[1],h=r.exports.useMemo(function(){return Ht(me)},[JSON.stringify(me)]),E=lt("",{value:v!==void 0?v:w,postState:function(s){return s||""}}),Y=W(E,2),P=Y[0],Ne=Y[1],Me=function(s){Ne(s),C==null||C(s)},X=Bt(je,Ue,ye),Pe=Jt(X,h),T=Pe.keyEntities,q=Pe.valueEntities,Qe=r.exports.useCallback(function(f){var s=[],p=[];return f.forEach(function(m){q.has(m)?p.push(m):s.push(m)}),{missingRawValues:s,existRawValues:p}},[q]),Xe=qt(X,P,{fieldNames:h,treeNodeFilterProp:O,filterTreeNode:I}),Ze=r.exports.useCallback(function(f){if(f){if(K)return f[K];for(var s=h._title,p=0;p<s.length;p+=1){var m=f[s[p]];if(m!==void 0)return m}}},[h,K]),he=r.exports.useCallback(function(f){var s=At(f);return s.map(function(p){return Qt(p)?{value:p}:p})},[]),Ae=r.exports.useCallback(function(f){var s=he(f);return s.map(function(p){var m=p.label,D=p.value,S=p.halfChecked,y,x=q.get(D);if(x){var k;m=(k=m)!==null&&k!==void 0?k:Ze(x.node),y=x.node.disabled}else if(m===void 0){var R=he(N).find(function(pe){return pe.value===D});m=R.label}return{label:m,value:D,halfChecked:S,disabled:y}})},[q,Ze,he,N]),et=r.exports.useMemo(function(){return he(N)},[he,N]),mt=r.exports.useMemo(function(){var f=[],s=[];return et.forEach(function(p){p.halfChecked?s.push(p):f.push(p)}),[f,s]},[et]),tt=W(mt,2),Z=tt[0],rt=tt[1],nt=r.exports.useMemo(function(){return Z.map(function(f){return f.value})},[Z]),yt=Yt(Z,rt,J,T),at=W(yt,2),ee=at[0],He=at[1],xt=r.exports.useMemo(function(){var f=it(ee,g,T,h),s=f.map(function(S){var y,x,k;return(y=(x=T[S])===null||x===void 0||(k=x.node)===null||k===void 0?void 0:k[h.value])!==null&&y!==void 0?y:S}),p=s.map(function(S){var y=Z.find(function(x){return x.value===S});return{value:S,label:y==null?void 0:y.label}}),m=Ae(p),D=m[0];return!M&&D&&ot(D.value)&&ot(D.label)?[]:m.map(function(S){var y;return V(V({},S),{},{label:(y=S.label)!==null&&y!==void 0?y:S.value})})},[h,M,ee,Z,Ae,g,T]),Ct=Gt(xt),St=W(Ct,1),bt=St[0],Oe=ut(function(f,s,p){var m=Ae(f);if(ve(m),L&&Ne(""),c){var D=f;if(J){var S=it(f,g,T,h);D=S.map(function(A){var F=q.get(A);return F?F.node[h.value]:A})}var y=s||{triggerValue:void 0,selected:void 0},x=y.triggerValue,k=y.selected,R=D;if(H){var pe=rt.filter(function(A){return!D.includes(A.value)});R=[].concat(j(R),j(pe))}var ge=Ae(R),z={preValue:Z,triggerValue:x},te=!0;(H||p==="selection"&&!k)&&(te=!1),jt(z,x,f,X,te,h),$?z.checked=k:z.selected=k;var $e=Ve?ge:ge.map(function(A){return A.value});c(M?$e:$e[0],Ve?null:ge.map(function(A){return A.label}),z)}}),Ge=r.exports.useCallback(function(f,s){var p,m=s.selected,D=s.source,S=T[f],y=S==null?void 0:S.node,x=(p=y==null?void 0:y[h.value])!==null&&p!==void 0?p:f;if(!M)Oe([x],{selected:!0,triggerValue:x},"option");else{var k=m?[].concat(j(nt),[x]):ee.filter(function(F){return F!==x});if(J){var R=Qe(k),pe=R.missingRawValues,ge=R.existRawValues,z=ge.map(function(F){return q.get(F).key}),te;if(m){var $e=Je(z,!0,T);te=$e.checkedKeys}else{var A=Je(z,{checked:!1,halfCheckedKeys:He},T);te=A.checkedKeys}k=[].concat(j(pe),j(te.map(function(F){return T[F].node[h.value]})))}Oe(k,{selected:m,triggerValue:x},D||"option")}m||!M?o==null||o(x,qe(y)):d==null||d(x,qe(y))},[Qe,q,T,h,M,nt,Oe,J,o,d,ee,He]),Et=r.exports.useCallback(function(f){if(ie){var s={};Object.defineProperty(s,"documentClickClose",{get:function(){return Re(!1,"Second param of `onDropdownVisibleChange` has been removed."),!1}}),ie(f,s)}},[ie]),kt=ut(function(f,s){var p=f.map(function(m){return m.value});if(s.type==="clear"){Oe(p,{},"selection");return}s.values.length&&Ge(s.values[0].value,{selected:!1,source:"selection"})}),Dt=r.exports.useMemo(function(){return{virtual:G,dropdownMatchSelectWidth:Q,listHeight:we,listItemHeight:Le,treeData:Xe,fieldNames:h,onSelect:Ge,treeExpandAction:De}},[G,Q,we,Le,Xe,h,Ge,De]),wt=r.exports.useMemo(function(){return{checkable:$,loadData:xe,treeLoadedKeys:Ce,onTreeLoad:Se,checkedKeys:ee,halfCheckedKeys:He,treeDefaultExpandAll:be,treeExpandedKeys:ae,treeDefaultExpandedKeys:Ee,onTreeExpand:ke,treeIcon:Ke,treeMotion:de,showTreeIcon:ce,switcherIcon:se,treeLine:Ie,treeNodeFilterProp:O,keyEntities:T}},[$,xe,Ce,Se,ee,He,be,ae,Ee,ke,Ke,de,ce,se,Ie,O,T]);return r.exports.createElement(ft.Provider,{value:Dt},r.exports.createElement(dt.Provider,{value:wt},r.exports.createElement(Vt,ct({ref:t},Te,{id:Be,prefixCls:l,mode:M?"multiple":void 0,displayValues:bt,onDisplayValuesChange:kt,searchValue:P,onSearch:Me,OptionList:vt,emptyOptions:!X.length,onDropdownVisibleChange:Et,dropdownMatchSelectWidth:Q}))))}),Fe=Xt;Fe.TreeNode=ht;Fe.SHOW_ALL=Ft;Fe.SHOW_PARENT=pt;Fe.SHOW_CHILD=ze;export{Fe as G,Ft as S,ht as T,pt as a,ze as b};
