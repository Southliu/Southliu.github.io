{"version":3,"file":"@rc-component_context.40aebe85.js","sources":["../../../node_modules/.pnpm/@rc-component+context@1.3.0_biqbaboplfbrettd7655fr4n2y/node_modules/@rc-component/context/es/context.js","../../../node_modules/.pnpm/@rc-component+context@1.3.0_biqbaboplfbrettd7655fr4n2y/node_modules/@rc-component/context/es/Immutable.js"],"sourcesContent":["import _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport useEvent from \"rc-util/es/hooks/useEvent\";\nimport useLayoutEffect from \"rc-util/es/hooks/useLayoutEffect\";\nimport isEqual from \"rc-util/es/isEqual\";\nimport * as React from 'react';\nimport { unstable_batchedUpdates } from 'react-dom';\nexport function createContext(defaultValue) {\n  var Context = /*#__PURE__*/React.createContext(undefined);\n\n  var Provider = function Provider(_ref) {\n    var value = _ref.value,\n        children = _ref.children;\n    var valueRef = React.useRef(value);\n    valueRef.current = value;\n\n    var _React$useState = React.useState(function () {\n      return {\n        getValue: function getValue() {\n          return valueRef.current;\n        },\n        listeners: new Set()\n      };\n    }),\n        _React$useState2 = _slicedToArray(_React$useState, 1),\n        context = _React$useState2[0];\n\n    useLayoutEffect(function () {\n      unstable_batchedUpdates(function () {\n        context.listeners.forEach(function (listener) {\n          listener(value);\n        });\n      });\n    }, [value]);\n    return /*#__PURE__*/React.createElement(Context.Provider, {\n      value: context\n    }, children);\n  };\n\n  return {\n    Context: Context,\n    Provider: Provider,\n    defaultValue: defaultValue\n  };\n}\n/** e.g. useSelect(userContext) => user */\n\nexport function useContext(holder, selector) {\n  var eventSelector = useEvent(typeof selector === 'function' ? selector : function (ctx) {\n    if (selector === undefined) {\n      return ctx;\n    }\n\n    if (!Array.isArray(selector)) {\n      return ctx[selector];\n    }\n\n    var obj = {};\n    selector.forEach(function (key) {\n      obj[key] = ctx[key];\n    });\n    return obj;\n  });\n  var context = React.useContext(holder === null || holder === void 0 ? void 0 : holder.Context);\n\n  var _ref2 = context || {},\n      listeners = _ref2.listeners,\n      getValue = _ref2.getValue;\n\n  var valueRef = React.useRef();\n  valueRef.current = eventSelector(context ? getValue() : holder === null || holder === void 0 ? void 0 : holder.defaultValue);\n\n  var _React$useState3 = React.useState({}),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      forceUpdate = _React$useState4[1];\n\n  useLayoutEffect(function () {\n    if (!context) {\n      return;\n    }\n\n    function trigger(nextValue) {\n      var nextSelectorValue = eventSelector(nextValue);\n\n      if (!isEqual(valueRef.current, nextSelectorValue, true)) {\n        forceUpdate({});\n      }\n    }\n\n    listeners.add(trigger);\n    return function () {\n      listeners.delete(trigger);\n    };\n  }, [context]);\n  return valueRef.current;\n}","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport { supportRef } from \"rc-util/es/ref\";\nimport * as React from 'react';\nvar ImmutableContext = /*#__PURE__*/React.createContext(0);\n\n/**\n * Get render update mark by `makeImmutable` root.\n * Do not deps on the return value as render times\n * but only use for `useMemo` or `useCallback` deps.\n */\nexport function useImmutableMark() {\n  return React.useContext(ImmutableContext);\n}\n/**\n * Wrapped Component will be marked as Immutable.\n * When Component parent trigger render,\n * it will notice children component (use with `responseImmutable`) node that parent has updated.\n\n * @param Component Passed Component\n * @param triggerRender Customize trigger `responseImmutable` children re-render logic. Default will always trigger re-render when this component re-render.\n */\n\nexport function makeImmutable(Component, shouldTriggerRender) {\n  var refAble = supportRef(Component);\n\n  var ImmutableComponent = function ImmutableComponent(props, ref) {\n    var refProps = refAble ? {\n      ref: ref\n    } : {};\n    var renderTimesRef = React.useRef(0);\n    var prevProps = React.useRef(props);\n\n    if ( // Always trigger re-render if not provide `notTriggerRender`\n    !shouldTriggerRender || shouldTriggerRender(prevProps.current, props)) {\n      renderTimesRef.current += 1;\n    }\n\n    prevProps.current = props;\n    return /*#__PURE__*/React.createElement(ImmutableContext.Provider, {\n      value: renderTimesRef.current\n    }, /*#__PURE__*/React.createElement(Component, _extends({}, props, refProps)));\n  };\n\n  if (process.env.NODE_ENV !== 'production') {\n    ImmutableComponent.displayName = \"ImmutableRoot(\".concat(Component.displayName || Component.name, \")\");\n  }\n\n  return refAble ? /*#__PURE__*/React.forwardRef(ImmutableComponent) : ImmutableComponent;\n}\n/**\n * Wrapped Component with `React.memo`.\n * But will rerender when parent with `makeImmutable` rerender.\n */\n\nexport function responseImmutable(Component, propsAreEqual) {\n  var refAble = supportRef(Component);\n\n  var ImmutableComponent = function ImmutableComponent(props, ref) {\n    var refProps = refAble ? {\n      ref: ref\n    } : {};\n    useImmutableMark();\n    return /*#__PURE__*/React.createElement(Component, _extends({}, props, refProps));\n  };\n\n  if (process.env.NODE_ENV !== 'production') {\n    ImmutableComponent.displayName = \"ImmutableResponse(\".concat(Component.displayName || Component.name, \")\");\n  }\n\n  return refAble ? /*#__PURE__*/React.memo( /*#__PURE__*/React.forwardRef(ImmutableComponent), propsAreEqual) : /*#__PURE__*/React.memo(ImmutableComponent, propsAreEqual);\n}"],"names":["createContext","defaultValue","Context","React.createContext","Provider","_ref","value","children","valueRef","React.useRef","_React$useState","React.useState","_React$useState2","_slicedToArray","context","useLayoutEffect","unstable_batchedUpdates","listener","React.createElement","useContext","holder","selector","eventSelector","useEvent","ctx","obj","key","React.useContext","_ref2","listeners","getValue","_React$useState3","_React$useState4","forceUpdate","trigger","nextValue","nextSelectorValue","isEqual","ImmutableContext","useImmutableMark","makeImmutable","Component","shouldTriggerRender","refAble","supportRef","ImmutableComponent","props","ref","refProps","renderTimesRef","prevProps","_extends","React.forwardRef","responseImmutable","propsAreEqual","React.memo"],"mappings":"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"}