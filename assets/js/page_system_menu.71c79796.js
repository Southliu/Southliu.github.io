import{j as s,r as n}from"./react.981c89a4.js";import{v as Y,I as j,S as $,r as i,A as L,d as Z}from"./components_Business.0c4299c0.js";import{M as b,d as U,e as ee}from"./components_Dates.3063684e.js";import{u as te}from"./page_content_article.3e44a9cb.js";import{c as S}from"./layouts.26760549.js";import{u as ae}from"./components_Fullscreen.5c803250.js";import{U as ne,D as se}from"./components_Buttons.ebec7860.js";import{B as oe}from"./components_Content.1396454a.js";import{B as re}from"./components_Search.57568f1b.js";import{B as ie}from"./components_Modal.3a148aea.js";import{B as ce}from"./components_Form.3d2fbff8.js";import{B as le}from"./components_Table.54f76119.js";import{B as ue}from"./components_Pagination.cd27b53e.js";import{m as R}from"./antd.c52db168.js";const me=[{label:"状态",name:"status",component:"Select",componentProps:{options:b}},{label:"模块",name:"module",wrapperCol:170,component:"Select",componentProps:{options:U}},{label:"控制器",name:"controller",component:"Input"}],pe=e=>[{title:"ID",dataIndex:"id",width:200},{title:"名称",dataIndex:"name",width:200},{title:"状态",dataIndex:"status",width:200,render:r=>s.jsx("span",{children:Y(r,b)})},{title:"模块",dataIndex:"module",width:200},{title:"控制器",dataIndex:"controller",width:200},{title:"创建时间",dataIndex:"created_at",width:200},{title:"更新时间",dataIndex:"updated_at",width:200},{title:"操作",dataIndex:"operate",width:200,fixed:"right",render:(r,C)=>e(r,C)}],de=e=>[{label:"名称",name:"name",rules:j,component:"Input"},{label:"状态",name:"status",rules:$,component:"Select",componentProps:{options:b}},{label:"模块",name:"module",rules:$,component:"Select",componentProps:{options:U}},{label:"控制器",name:"controller",rules:j,component:"Input"},{label:"创建菜单",name:"actions",hidden:!!e,component:"CheckboxGroup",componentProps:{options:ee}}];function fe(e){return i.get("/authority/menu/index",{params:e})}function ge(e){return i.get(`/authority/menu/${e}`)}function he(e){return i.post("/authority/menu",e)}function Se(e,r){return i.put(`/authority/menu/${e}`,r)}function xe(e){return i.delete(`/authority/menu/${e}`)}function Me(e){return i.get("/authority/menu/tree",{params:e})}function Ue(e){return i.put("/authority/menu/authorize/save",e)}const x={page:1,pageSize:20},M={status:1};function _e(){te("菜单管理");const e=n.useRef(null),r=n.useRef(null),[C,m]=n.useState(!1),[u,p]=n.useState(!1),[_,d]=n.useState(!1),[F,P]=n.useState(L),[I,D]=n.useState(""),[N,T]=n.useState(M),[E,w]=n.useState(x.page),[y,k]=n.useState(x.pageSize),[z,O]=n.useState(0),[A,v]=n.useState([]),{permissions:f}=ae(),g="/authority/menu",c={page:S(`${g}/index`,f),create:S(`${g}/create`,f),update:S(`${g}/update`,f),delete:S(`${g}/delete`,f)},Q=t=>{w(1),l({page:1,pageSize:y,...t})},l=n.useCallback(async t=>{try{p(!0);const{data:{data:a}}=await fe(t),{items:o,total:h}=a;O(h),v(o)}finally{p(!1)}},[]);n.useEffect(()=>{c.page&&l({...x})},[l,c.page]);const V=()=>{m(!0),P(L),D(""),T(M)},q=async t=>{try{m(!0),P(Z(t)),D(t),d(!0);const{data:{data:a}}=await ge(t);T(a)}finally{d(!1)}},G=()=>{var t;(t=r.current)==null||t.handleSubmit()},H=()=>{m(!1)},B=()=>{var o;const a={...((o=e.current)==null?void 0:o.getFieldsValue())||{},page:E,pageSize:y};l(a)},J=async t=>{try{d(!0);const a=()=>I?Se(I,t):he(t),{data:o}=await a();R.success((o==null?void 0:o.message)||"操作成功"),m(!1),B()}finally{d(!1)}},K=async t=>{try{p(!0);const{data:a}=await xe(t);(a==null?void 0:a.code)===200&&(R.success((a==null?void 0:a.message)||"删除成功"),B())}finally{p(!1)}},W=n.useCallback((t,a)=>{var h;w(t),k(a);const o=(h=e.current)==null?void 0:h.getFieldsValue();l({...o,page:t,pageSize:a})},[l]),X=(t,a)=>s.jsxs(s.Fragment,{children:[c.update===!0&&s.jsx(ne,{className:"mr-5px",isLoading:u,onClick:()=>q(a.id)}),c.delete===!0&&s.jsx(se,{className:"mr-5px",isLoading:u,handleDelete:()=>K(a.id)})]});return s.jsx(oe,{isPermission:c.page,children:s.jsxs(s.Fragment,{children:[s.jsx(re,{formRef:e,list:me,data:x,isLoading:u,isCreate:c.create,onCreate:V,handleFinish:Q}),s.jsx(le,{loading:u,columns:pe(X),dataSource:A}),s.jsx(ue,{disabled:u,current:E,pageSize:y,total:z,onChange:W}),s.jsx(ie,{width:600,title:F,open:C,confirmLoading:_,onOk:G,onCancel:H,children:s.jsx(ce,{formRef:r,list:de(I),data:N,labelCol:{span:4},wrapperCol:{span:19},handleFinish:J})})]})})}export{_e as P,Me as g,Ue as s};
