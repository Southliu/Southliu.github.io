import{e as Y,f as A,i as Ue,j as Ye,a as de,_ as pe,c as w,d as ge,g as Oe,h as ze}from"./@babel_runtime.0b96ec9f.js";import{r as o}from"./react.017637b6.js";import{c as G}from"./classnames.96a48171.js";import{R as We}from"./rc-resize-observer.c02c0b35.js";import{f as y,E as Ke,b as re}from"./rc-util.88348ebb.js";var me=o.exports.forwardRef(function(r,v){var u=r.height,e=r.offset,f=r.children,a=r.prefixCls,s=r.onInnerResize,t={},n={display:"flex",flexDirection:"column"};return e!==void 0&&(t={height:u,position:"relative",overflow:"hidden"},n=Y(Y({},n),{},{transform:"translateY(".concat(e,"px)"),position:"absolute",left:0,right:0,top:0})),o.exports.createElement("div",{style:t},o.exports.createElement(We,{onResize:function(c){var l=c.offsetHeight;l&&s&&s()}},o.exports.createElement("div",{style:n,className:G(A({},"".concat(a,"-holder-inner"),a)),ref:v},f)))});me.displayName="Filler";var je=20;function he(r){return"touches"in r?r.touches[0].pageY:r.pageY}var Ve=function(r){Ue(u,r);var v=Ye(u);function u(){var e;de(this,u);for(var f=arguments.length,a=new Array(f),s=0;s<f;s++)a[s]=arguments[s];return e=v.call.apply(v,[this].concat(a)),e.moveRaf=null,e.scrollbarRef=o.exports.createRef(),e.thumbRef=o.exports.createRef(),e.visibleTimeout=null,e.state={dragging:!1,pageY:null,startTop:null,visible:!1},e.delayHidden=function(){clearTimeout(e.visibleTimeout),e.setState({visible:!0}),e.visibleTimeout=setTimeout(function(){e.setState({visible:!1})},2e3)},e.onScrollbarTouchStart=function(t){t.preventDefault()},e.onContainerMouseDown=function(t){t.stopPropagation(),t.preventDefault()},e.patchEvents=function(){window.addEventListener("mousemove",e.onMouseMove),window.addEventListener("mouseup",e.onMouseUp),e.thumbRef.current.addEventListener("touchmove",e.onMouseMove),e.thumbRef.current.addEventListener("touchend",e.onMouseUp)},e.removeEvents=function(){var t;window.removeEventListener("mousemove",e.onMouseMove),window.removeEventListener("mouseup",e.onMouseUp),(t=e.scrollbarRef.current)===null||t===void 0||t.removeEventListener("touchstart",e.onScrollbarTouchStart),e.thumbRef.current&&(e.thumbRef.current.removeEventListener("touchstart",e.onMouseDown),e.thumbRef.current.removeEventListener("touchmove",e.onMouseMove),e.thumbRef.current.removeEventListener("touchend",e.onMouseUp)),y.cancel(e.moveRaf)},e.onMouseDown=function(t){var n=e.props.onStartMove;e.setState({dragging:!0,pageY:he(t),startTop:e.getTop()}),n(),e.patchEvents(),t.stopPropagation(),t.preventDefault()},e.onMouseMove=function(t){var n=e.state,i=n.dragging,c=n.pageY,l=n.startTop,d=e.props.onScroll;if(y.cancel(e.moveRaf),i){var p=he(t)-c,m=l+p,S=e.getEnableScrollRange(),x=e.getEnableHeightRange(),_=x?m/x:0,D=Math.ceil(_*S);e.moveRaf=y(function(){d(D)})}},e.onMouseUp=function(){var t=e.props.onStopMove;e.setState({dragging:!1}),t(),e.removeEvents()},e.getSpinHeight=function(){var t=e.props,n=t.height,i=t.count,c=n/i*10;return c=Math.max(c,je),c=Math.min(c,n/2),Math.floor(c)},e.getEnableScrollRange=function(){var t=e.props,n=t.scrollHeight,i=t.height;return n-i||0},e.getEnableHeightRange=function(){var t=e.props.height,n=e.getSpinHeight();return t-n||0},e.getTop=function(){var t=e.props.scrollTop,n=e.getEnableScrollRange(),i=e.getEnableHeightRange();if(t===0||n===0)return 0;var c=t/n;return c*i},e.showScroll=function(){var t=e.props,n=t.height,i=t.scrollHeight;return i>n},e}return pe(u,[{key:"componentDidMount",value:function(){this.scrollbarRef.current.addEventListener("touchstart",this.onScrollbarTouchStart),this.thumbRef.current.addEventListener("touchstart",this.onMouseDown)}},{key:"componentDidUpdate",value:function(f){f.scrollTop!==this.props.scrollTop&&this.delayHidden()}},{key:"componentWillUnmount",value:function(){this.removeEvents(),clearTimeout(this.visibleTimeout)}},{key:"render",value:function(){var f=this.state,a=f.dragging,s=f.visible,t=this.props.prefixCls,n=this.getSpinHeight(),i=this.getTop(),c=this.showScroll(),l=c&&s;return o.exports.createElement("div",{ref:this.scrollbarRef,className:G("".concat(t,"-scrollbar"),A({},"".concat(t,"-scrollbar-show"),c)),style:{width:8,top:0,bottom:0,right:0,position:"absolute",display:l?null:"none"},onMouseDown:this.onContainerMouseDown,onMouseMove:this.delayHidden},o.exports.createElement("div",{ref:this.thumbRef,className:G("".concat(t,"-scrollbar-thumb"),A({},"".concat(t,"-scrollbar-thumb-moving"),a)),style:{width:"100%",height:n,top:i,left:0,position:"absolute",background:"rgba(0, 0, 0, 0.5)",borderRadius:99,cursor:"pointer",userSelect:"none"},onMouseDown:this.onMouseDown}))}}]),u}(o.exports.Component);function Ae(r){var v=r.children,u=r.setRef,e=o.exports.useCallback(function(f){u(f)},[]);return o.exports.cloneElement(v,{ref:e})}function Ge(r,v,u,e,f,a){var s=a.getKey;return r.slice(v,u+1).map(function(t,n){var i=v+n,c=f(t,i,{}),l=s(t);return o.exports.createElement(Ae,{key:l,setRef:function(p){return e(t,p)}},c)})}var Ze=function(){function r(){de(this,r),this.maps=void 0,this.maps=Object.create(null)}return pe(r,[{key:"set",value:function(u,e){this.maps[u]=e}},{key:"get",value:function(u){return this.maps[u]}}]),r}();function qe(r,v,u){var e=o.exports.useState(0),f=w(e,2),a=f[0],s=f[1],t=o.exports.useRef(new Map),n=o.exports.useRef(new Ze),i=o.exports.useRef();function c(){y.cancel(i.current)}function l(){c(),i.current=y(function(){t.current.forEach(function(p,m){if(p&&p.offsetParent){var S=Ke(p),x=S.offsetHeight;n.current.get(m)!==x&&n.current.set(m,S.offsetHeight)}}),s(function(p){return p+1})})}function d(p,m){var S=r(p),x=t.current.get(S);m?(t.current.set(S,m),l()):t.current.delete(S),!x!=!m&&(m?v==null||v(p):u==null||u(p))}return o.exports.useEffect(function(){return c},[]),[d,l,n.current,a]}function Be(r,v,u,e,f,a,s,t){var n=o.exports.useRef();return function(i){if(i==null){t();return}if(y.cancel(n.current),typeof i=="number")s(i);else if(i&&ge(i)==="object"){var c,l=i.align;"index"in i?c=i.index:c=v.findIndex(function(S){return f(S)===i.key});var d=i.offset,p=d===void 0?0:d,m=function S(x,_){if(!(x<0||!r.current)){var D=r.current.clientHeight,b=!1,I=_;if(D){for(var Z=_||l,F=0,E=0,k=0,q=Math.min(v.length,c),L=0;L<=q;L+=1){var B=f(v[L]);E=F;var N=u.get(B);k=E+(N===void 0?e:N),F=k,L===c&&N===void 0&&(b=!0)}var C=null;switch(Z){case"top":C=E-p;break;case"bottom":C=k-D+p;break;default:{var R=r.current.scrollTop,M=R+D;E<R?I="top":k>M&&(I="bottom")}}C!==null&&C!==r.current.scrollTop&&s(C)}n.current=y(function(){b&&a(),S(x-1,I)})}};m(3)}}}function Je(r,v,u){var e=r.length,f=v.length,a,s;if(e===0&&f===0)return null;e<f?(a=r,s=v):(a=v,s=r);var t={__EMPTY_ITEM__:!0};function n(m){return m!==void 0?u(m):t}for(var i=null,c=Math.abs(e-f)!==1,l=0;l<s.length;l+=1){var d=n(a[l]),p=n(s[l]);if(d!==p){i=l,c=c||d!==n(s[l+1]);break}}return i===null?null:{index:i,multiple:c}}function Qe(r,v,u){var e=o.exports.useState(r),f=w(e,2),a=f[0],s=f[1],t=o.exports.useState(null),n=w(t,2),i=n[0],c=n[1];return o.exports.useEffect(function(){var l=Je(a||[],r||[],v);(l==null?void 0:l.index)!==void 0&&(u==null||u(l.index),c(r[l.index])),s(r)},[r]),[i]}var Xe=(typeof navigator>"u"?"undefined":ge(navigator))==="object"&&/Firefox/i.test(navigator.userAgent);const Re=function(r,v){var u=o.exports.useRef(!1),e=o.exports.useRef(null);function f(){clearTimeout(e.current),u.current=!0,e.current=setTimeout(function(){u.current=!1},50)}var a=o.exports.useRef({top:r,bottom:v});return a.current.top=r,a.current.bottom=v,function(s){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=s<0&&a.current.top||s>0&&a.current.bottom;return t&&n?(clearTimeout(e.current),u.current=!1):(!n||u.current)&&f(),!u.current&&n}};function et(r,v,u,e){var f=o.exports.useRef(0),a=o.exports.useRef(null),s=o.exports.useRef(null),t=o.exports.useRef(!1),n=Re(v,u);function i(l){if(!!r){y.cancel(a.current);var d=l.deltaY;f.current+=d,s.current=d,!n(d)&&(Xe||l.preventDefault(),a.current=y(function(){var p=t.current?10:1;e(f.current*p),f.current=0}))}}function c(l){!r||(t.current=l.detail===s.current)}return[i,c]}var tt=14/15;function rt(r,v,u){var e=o.exports.useRef(!1),f=o.exports.useRef(0),a=o.exports.useRef(null),s=o.exports.useRef(null),t,n=function(d){if(e.current){var p=Math.ceil(d.touches[0].pageY),m=f.current-p;f.current=p,u(m)&&d.preventDefault(),clearInterval(s.current),s.current=setInterval(function(){m*=tt,(!u(m,!0)||Math.abs(m)<=.1)&&clearInterval(s.current)},16)}},i=function(){e.current=!1,t()},c=function(d){t(),d.touches.length===1&&!e.current&&(e.current=!0,f.current=Math.ceil(d.touches[0].pageY),a.current=d.target,a.current.addEventListener("touchmove",n),a.current.addEventListener("touchend",i))};t=function(){a.current&&(a.current.removeEventListener("touchmove",n),a.current.removeEventListener("touchend",i))},re(function(){return r&&v.current.addEventListener("touchstart",c),function(){var l;(l=v.current)===null||l===void 0||l.removeEventListener("touchstart",c),t(),clearInterval(s.current)}},[r])}var nt=["prefixCls","className","height","itemHeight","fullHeight","style","data","children","itemKey","virtual","component","onScroll","onVisibleChange"],ot=[],at={overflowY:"auto",overflowAnchor:"none"};function it(r,v){var u=r.prefixCls,e=u===void 0?"rc-virtual-list":u,f=r.className,a=r.height,s=r.itemHeight,t=r.fullHeight,n=t===void 0?!0:t,i=r.style,c=r.data,l=r.children,d=r.itemKey,p=r.virtual,m=r.component,S=m===void 0?"div":m,x=r.onScroll,_=r.onVisibleChange,D=Oe(r,nt),b=!!(p!==!1&&a&&s),I=b&&c&&s*c.length>a,Z=o.exports.useState(0),F=w(Z,2),E=F[0],k=F[1],q=o.exports.useState(!1),L=w(q,2),B=L[0],N=L[1],C=G(e,f),R=c||ot,M=o.exports.useRef(),ne=o.exports.useRef(),oe=o.exports.useRef(),P=o.exports.useCallback(function(h){return typeof d=="function"?d(h):h==null?void 0:h[d]},[d]),Se={getKey:P};function O(h){k(function(g){var T;typeof h=="function"?T=h(g):T=h;var $=_e(T);return M.current.scrollTop=$,$})}var ae=o.exports.useRef({start:0,end:R.length}),xe=o.exports.useRef(),Me=Qe(R,P),be=w(Me,1),Ee=be[0];xe.current=Ee;var Te=qe(P,null,null),z=w(Te,4),ye=z[0],ie=z[1],ue=z[2],He=z[3],W=o.exports.useMemo(function(){if(!b)return{scrollHeight:void 0,start:0,end:R.length-1,offset:void 0};if(!I){var h;return{scrollHeight:((h=ne.current)===null||h===void 0?void 0:h.offsetHeight)||0,start:0,end:R.length-1,offset:void 0}}for(var g=0,T,$,H,$e=R.length,U=0;U<$e;U+=1){var Fe=R[U],Pe=P(Fe),ve=ue.get(Pe),te=g+(ve===void 0?s:ve);te>=E&&T===void 0&&(T=U,$=g),te>E+a&&H===void 0&&(H=U),g=te}return T===void 0&&(T=0,$=0,H=Math.ceil(a/s)),H===void 0&&(H=R.length-1),H=Math.min(H+1,R.length),{scrollHeight:g,start:T,end:H,offset:$}},[I,b,E,R,He,a]),J=W.scrollHeight,K=W.start,j=W.end,we=W.offset;ae.current.start=K,ae.current.end=j;var Q=J-a,X=o.exports.useRef(Q);X.current=Q;function _e(h){var g=h;return Number.isNaN(X.current)||(g=Math.min(g,X.current)),g=Math.max(g,0),g}var se=E<=0,le=E>=Q,De=Re(se,le);function Le(h){var g=h;O(g)}function Ce(h){var g=h.currentTarget.scrollTop;g!==E&&O(g),x==null||x(h)}var Ie=et(b,se,le,function(h){O(function(g){var T=g+h;return T})}),ce=w(Ie,2),ee=ce[0],fe=ce[1];rt(b,M,function(h,g){return De(h,g)?!1:(ee({preventDefault:function(){},deltaY:h}),!0)}),re(function(){function h(g){b&&g.preventDefault()}return M.current.addEventListener("wheel",ee),M.current.addEventListener("DOMMouseScroll",fe),M.current.addEventListener("MozMousePixelScroll",h),function(){M.current&&(M.current.removeEventListener("wheel",ee),M.current.removeEventListener("DOMMouseScroll",fe),M.current.removeEventListener("MozMousePixelScroll",h))}},[b]);var ke=Be(M,R,ue,s,P,ie,O,function(){var h;(h=oe.current)===null||h===void 0||h.delayHidden()});o.exports.useImperativeHandle(v,function(){return{scrollTo:ke}}),re(function(){if(_){var h=R.slice(K,j+1);_(h,R)}},[K,j,R]);var Ne=Ge(R,K,j,ye,l,Se),V=null;return a&&(V=Y(A({},n?"height":"maxHeight",a),at),b&&(V.overflowY="hidden",B&&(V.pointerEvents="none"))),o.exports.createElement("div",ze({style:Y(Y({},i),{},{position:"relative"}),className:C},D),o.exports.createElement(S,{className:"".concat(e,"-holder"),style:V,ref:M,onScroll:Ce},o.exports.createElement(me,{prefixCls:e,height:J,offset:we,onInnerResize:ie,ref:ne},Ne)),b&&o.exports.createElement(Ve,{ref:oe,prefixCls:e,scrollTop:E,height:a,scrollHeight:J,count:R.length,onScroll:Le,onStartMove:function(){N(!0)},onStopMove:function(){N(!1)}}))}var ut=o.exports.forwardRef(it);ut.displayName="List";export{ut as L};
