import{r as e,e as n}from"./react@18.2.0.CwGjMYfB.js";import{r as t}from"./react-dom@18.2.0_react@18.2.0.BN8LbORn.js";var r=function(){return r=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e},r.apply(this,arguments)};function o(e,n,t){if(t||2===arguments.length)for(var r,o=0,i=n.length;o<i;o++)!r&&o in n||(r||(r=Array.prototype.slice.call(n,0,o)),r[o]=n[o]);return e.concat(r||Array.prototype.slice.call(n))}"function"==typeof SuppressedError&&SuppressedError;var i,c={exports:{}},u={};
/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
c.exports=function(){if(i)return u;i=1;var e=n,t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,c=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function f(e,n,r){var i,u={},f=null,l=null;for(i in void 0!==r&&(f=""+r),void 0!==n.key&&(f=""+n.key),void 0!==n.ref&&(l=n.ref),n)o.call(n,i)&&!a.hasOwnProperty(i)&&(u[i]=n[i]);if(e&&e.defaultProps)for(i in n=e.defaultProps)void 0===u[i]&&(u[i]=n[i]);return{$$typeof:t,type:e,key:f,ref:l,props:u,_owner:c.current}}return u.Fragment=r,u.jsx=f,u.jsxs=f,u}();var a=c.exports;function f(e){return null==e}function l(e){return"[object RegExp]"===Object.prototype.toString.call(e)}function s(e){return Array.isArray(e)}var v=e.createContext({active:!1,destroy:function(){},refresh:function(){}}),d=function(){return e.useContext(v)},m=e.memo((function(n){var t=n.children,r=n.active,o=n.destroy,i=n.refresh,c=e.useMemo((function(){return{active:r,destroy:o,refresh:i}}),[r,o,i]);return a.jsx(v.Provider,{value:c,children:t})}),(function(e,n){return e.active===n.active})),h=d,p=function(n,t,r){void 0===t&&(t=!1);var i=d().active,c=e.useRef(!1);e.useEffect((function(){if(!t||c.current){var e=n(i);return function(){(function(e){return"function"==typeof e})(e)&&e()}}c.current=!0}),o([i],r,!0))},y=e.memo((function(n){var r=n.containerDivRef,o=n.active,i=n.children,c=n.destroy,u=n.name,f=n.refresh,l=n.errorElement,s=void 0===l?e.Fragment:l,v=n.cacheDivClassName,d=void 0===v?"cache-component":v,h=n.renderCount,p=n.async,y=n.microAsync,b=e.useRef(!1);b.current=b.current||o;var x=e.useMemo((function(){var e=document.createElement("div");return e.setAttribute("data-name",u),e.setAttribute("style","height: 100%"),e.setAttribute("data-render-count",h.toString()),e.className=d,e}),[h]);e.useLayoutEffect((function(){var e=r.current;function n(){null==e||e.appendChild(x),x.classList.add("active"),x.setAttribute("data-active","true")}x.classList.remove("active","inactive"),o?(0!==(null==e?void 0:e.childNodes.length)&&(null==e||e.childNodes.forEach((function(n){null==e||e.removeChild(n)}))),p?y?Promise.resolve().then((function(){n()})):setTimeout((function(){n()}),0):n()):(null==e?void 0:e.contains(x))&&(x.setAttribute("data-active","false"),x.classList.add("inactive"),x.remove())}),[o,r,x]);var C=e.useCallback((function(){c(u)}),[c,u]);return b.current?t.createPortal(a.jsx(s,{children:a.jsx(m,{active:o,destroy:C,refresh:f,children:i})}),x,u):null})),b={PRE:function(e){return e.shift(),e},LRU:function(e){var n=e.reduce((function(e,n){return e.lastActiveTime<n.lastActiveTime?e:n}));return e.splice(e.indexOf(n),1),e}};function x(n){var t=this,i=n.aliveRef,c=n.cache,u=void 0===c||c,v=n.strategy,d=void 0===v?"LRU":v,m=n.activeName,h=n.children,p=n.max,x=void 0===p?10:p,C=n.errorElement,g=n.suspenseElement,E=void 0===g?e.Fragment:g,w=n.animationWrapper,A=void 0===w?e.Fragment:w,j=n.onBeforeActive,_=n.containerDivRef,R=n.cacheDivClassName,O=n.async,k=void 0!==O&&O,S=n.microAsync,T=void 0===S||S,N=_||e.useRef(null),P=e.useState([]),L=P[0],D=P[1];e.useLayoutEffect((function(){var t;f(m)||(t=function(){D((function(e){if(e=e.filter((function(e){return e.cache})),!f(n.exclude)){var t=s(n.exclude)?n.exclude:[n.exclude];e=e.filter((function(e){return!t.some((function(n){return l(n)?n.test(e.name):e.name===n}))}))}if(!f(n.include)){var r=s(n.include)?n.include:[n.include];e=e.filter((function(e){return r.some((function(n){return l(n)?n.test(e.name):e.name===n}))}))}var i=Date.now();if(e.find((function(e){return e.name===m})))return e.map((function(e){return e.name===m?(j&&j(m),{name:m,cache:u,lastActiveTime:i,ele:h,renderCount:e.renderCount}):e}));if(j&&j(m),e.length>=x){var c=b[d];if(!c)throw new Error("strategy ".concat(d," is not supported"));e=c(e)}return o(o([],e,!0),[{name:m,cache:u,lastActiveTime:i,ele:h,renderCount:0}],!1)}))},"function"==typeof e.startTransition?e.startTransition(t):t())}),[h,m,D,x,u,d,n.exclude,n.include]),e.useImperativeHandle(i,(function(){return{getCaches:function(){return L},removeCache:function(e){return function(e,n,t,r){return new(t||(t=Promise))((function(n,o){function i(e){try{u(r.next(e))}catch(n){o(n)}}function c(e){try{u(r.throw(e))}catch(n){o(n)}}function u(e){var r;e.done?n(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(i,c)}u((r=r.apply(e,[])).next())}))}(t,0,void 0,(function(){return function(n,t){var r,o,i,c,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return c={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function a(a){return function(f){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;c&&(c=0,a[0]&&(u=0)),u;)try{if(r=1,o&&(i=2&a[0]?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return u.label++,{value:a[1],done:!1};case 5:u.label++,o=a[1],a=[0];continue;case 7:a=u.ops.pop(),u.trys.pop();continue;default:if(!((i=(i=u.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){u=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){u.label=a[1];break}if(6===a[0]&&u.label<i[1]){u.label=i[1],i=a;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(a);break}i[2]&&u.ops.pop(),u.trys.pop();continue}a=t.call(n,u)}catch(e){a=[6,e],o=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,f])}}}(this,(function(n){return[2,new Promise((function(n){setTimeout((function(){D((function(n){return o([],n.filter((function(n){return n.name!==e})),!0)})),n()}),0)}))]}))}))},cleanAllCache:function(){D([])},cleanOtherCache:function(){D((function(e){return o([],e.filter((function(e){return e.name===m})),!0)}))},refresh:function(e){D((function(n){var t=e||m;return n.map((function(e){return e.name===t?r(r({},e),{renderCount:e.renderCount+1}):e}))}))}}}),[L,D,m]);var F=e.useCallback((function(e){D((function(n){return n.filter((function(n){return n.name!==e}))}))}),[D]),I=e.useCallback((function(e){D((function(n){var t=e||m;return n.map((function(e){return e.name===t?r(r({},e),{renderCount:e.renderCount+1}):e}))}))}),[D,m]);return a.jsxs(e.Fragment,{children:[a.jsx(A,{children:a.jsx("div",{ref:N,className:"keep-alive-render",style:{height:"100%"}})}),a.jsx(E,{children:L.map((function(e){var n=e.name,t=e.ele,r=e.renderCount;return a.jsx(y,{async:k,microAsync:T,renderCount:r,containerDivRef:N,errorElement:C,active:m===n,name:n,destroy:F,refresh:I,cacheDivClassName:R,children:t},n)}))})]})}export{x as L,p as N,h as T};
