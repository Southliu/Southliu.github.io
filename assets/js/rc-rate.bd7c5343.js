import{i as k,j as D,a as S,_ as x,d as V,b as F}from"./@babel_runtime.8927ffbd.js";import{R as h}from"./react.1c7e6da0.js";import{K as y,F as M}from"./rc-util.ec6b8c77.js";import{c as K}from"./classnames.2e4736b8.js";function E(v){var f=v.pageXOffset,i="scrollLeft";if(typeof f!="number"){var n=v.document;f=n.documentElement[i],typeof f!="number"&&(f=n.body[i])}return f}function L(v){var f,i,n=v.ownerDocument,e=n.body,r=n&&n.documentElement,a=v.getBoundingClientRect();return f=a.left,i=a.top,f-=r.clientLeft||e.clientLeft||0,i-=r.clientTop||e.clientTop||0,{left:f,top:i}}function $(v){var f=L(v),i=v.ownerDocument,n=i.defaultView||i.parentWindow;return f.left+=E(n),f.left}var I=function(v){k(i,v);var f=D(i);function i(){var n;S(this,i);for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];return n=f.call.apply(f,[this].concat(r)),n.onHover=function(t){var l=n.props,o=l.onHover,s=l.index;o(t,s)},n.onClick=function(t){var l=n.props,o=l.onClick,s=l.index;o(t,s)},n.onKeyDown=function(t){var l=n.props,o=l.onClick,s=l.index;t.keyCode===13&&o(t,s)},n}return x(i,[{key:"getClassName",value:function(){var e=this.props,r=e.prefixCls,a=e.index,t=e.value,l=e.allowHalf,o=e.focused,s=a+1,u=r;return t===0&&a===0&&o?u+=" ".concat(r,"-focused"):l&&t+.5>=s&&t<s?(u+=" ".concat(r,"-half ").concat(r,"-active"),o&&(u+=" ".concat(r,"-focused"))):(u+=s<=t?" ".concat(r,"-full"):" ".concat(r,"-zero"),s===t&&o&&(u+=" ".concat(r,"-focused"))),u}},{key:"render",value:function(){var e=this.onHover,r=this.onClick,a=this.onKeyDown,t=this.props,l=t.disabled,o=t.prefixCls,s=t.character,u=t.characterRender,p=t.index,d=t.count,c=t.value,C=typeof s=="function"?s(this.props):s,m=h.createElement("li",{className:this.getClassName()},h.createElement("div",{onClick:l?null:r,onKeyDown:l?null:a,onMouseMove:l?null:e,role:"radio","aria-checked":c>p?"true":"false","aria-posinset":p+1,"aria-setsize":d,tabIndex:l?-1:0},h.createElement("div",{className:"".concat(o,"-first")},C),h.createElement("div",{className:"".concat(o,"-second")},C)));return u&&(m=u(m,this.props)),m}}]),i}(h.Component);function H(){}var B=function(v){k(i,v);var f=D(i);function i(n){var e;S(this,i),e=f.call(this,n),e.stars=void 0,e.rate=void 0,e.onHover=function(a,t){var l=e.props.onHoverChange,o=e.getStarValue(t,a.pageX),s=e.state.cleanedValue;o!==s&&e.setState({hoverValue:o,cleanedValue:null}),l(o)},e.onMouseLeave=function(){var a=e.props.onHoverChange;e.setState({hoverValue:void 0,cleanedValue:null}),a(void 0)},e.onClick=function(a,t){var l=e.props.allowClear,o=e.state.value,s=e.getStarValue(t,a.pageX),u=!1;l&&(u=s===o),e.onMouseLeave(),e.changeValue(u?0:s),e.setState({cleanedValue:u?s:null})},e.onFocus=function(){var a=e.props.onFocus;e.setState({focused:!0}),a&&a()},e.onBlur=function(){var a=e.props.onBlur;e.setState({focused:!1}),a&&a()},e.onKeyDown=function(a){var t=a.keyCode,l=e.props,o=l.count,s=l.allowHalf,u=l.onKeyDown,p=l.direction,d=p==="rtl",c=e.state.value;t===y.RIGHT&&c<o&&!d?(s?c+=.5:c+=1,e.changeValue(c),a.preventDefault()):t===y.LEFT&&c>0&&!d||t===y.RIGHT&&c>0&&d?(s?c-=.5:c-=1,e.changeValue(c),a.preventDefault()):t===y.LEFT&&c<o&&d&&(s?c+=.5:c+=1,e.changeValue(c),a.preventDefault()),u&&u(a)},e.saveRef=function(a){return function(t){e.stars[a]=t}},e.saveRate=function(a){e.rate=a};var r=n.value;return r===void 0&&(r=n.defaultValue),e.stars={},e.state={value:r,focused:!1,cleanedValue:null},e}return x(i,[{key:"componentDidMount",value:function(){var e=this.props,r=e.autoFocus,a=e.disabled;r&&!a&&this.focus()}},{key:"getStarDOM",value:function(e){return M(this.stars[e])}},{key:"getStarValue",value:function(e,r){var a=this.props,t=a.allowHalf,l=a.direction,o=l==="rtl",s=e+1;if(t){var u=this.getStarDOM(e),p=$(u),d=u.clientWidth;(o&&r-p>d/2||!o&&r-p<d/2)&&(s-=.5)}return s}},{key:"focus",value:function(){var e=this.props.disabled;e||this.rate.focus()}},{key:"blur",value:function(){var e=this.props.disabled;e||this.rate.blur()}},{key:"changeValue",value:function(e){var r=this.props.onChange;"value"in this.props||this.setState({value:e}),r(e)}},{key:"render",value:function(){for(var e=this.props,r=e.count,a=e.allowHalf,t=e.style,l=e.prefixCls,o=e.disabled,s=e.className,u=e.character,p=e.characterRender,d=e.tabIndex,c=e.direction,C=this.state,m=C.value,b=C.hoverValue,R=C.focused,w=[],_=o?"".concat(l,"-disabled"):"",g=0;g<r;g+=1)w.push(h.createElement(I,{ref:this.saveRef(g),index:g,count:r,disabled:o,prefixCls:"".concat(l,"-star"),allowHalf:a,value:b===void 0?m:b,onClick:this.onClick,onHover:this.onHover,key:g,character:u,characterRender:p,focused:R}));var N=K(l,_,s,F({},"".concat(l,"-rtl"),c==="rtl"));return h.createElement("ul",{className:N,style:t,onMouseLeave:o?null:this.onMouseLeave,tabIndex:o?-1:d,onFocus:o?null:this.onFocus,onBlur:o?null:this.onBlur,onKeyDown:o?null:this.onKeyDown,ref:this.saveRate,role:"radiogroup"},w)}}],[{key:"getDerivedStateFromProps",value:function(e,r){return"value"in e&&e.value!==void 0?V(V({},r),{},{value:e.value}):r}}]),i}(h.Component);B.defaultProps={defaultValue:0,count:5,allowHalf:!1,allowClear:!0,style:{},prefixCls:"rc-rate",onChange:H,character:"â˜…",onHoverChange:H,tabIndex:0,direction:"ltr"};export{B as R};
