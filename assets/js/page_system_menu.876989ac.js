import{j as o,a as $,F as L}from"./components_Bottom.b6a39c54.js";import{r as n}from"./react.75970298.js";import{v as ee,I as M,S as R,r as i,A as U,d as te}from"./components_Business.9c2eaebd.js";import{M as P,d as N,e as ae}from"./components_Dates.f71120f5.js";import{u as ne}from"./page_content_article.fdcf680a.js";import{a as se}from"./react-redux.df11dbf8.js";import{c as S}from"./layouts.a9a30c12.js";import{U as oe,D as re}from"./components_Buttons.9e23d5c1.js";import{B as ie}from"./components_Content.225b3cd7.js";import{B as ce}from"./components_Search.95ece36e.js";import{B as le}from"./components_Modal.cd41ab4a.js";import{B as ue}from"./components_Form.2ea9a913.js";import{B as me}from"./components_Table.1feef0ad.js";import{B as pe}from"./components_Pagination.cae73e50.js";import{m as _}from"./antd.04139c5f.js";const de=[{label:"状态",name:"status",component:"Select",componentProps:{options:P}},{label:"模块",name:"module",wrapperCol:170,component:"Select",componentProps:{options:N}},{label:"控制器",name:"controller",component:"Input"}],fe=t=>[{title:"ID",dataIndex:"id",width:200},{title:"名称",dataIndex:"name",width:200},{title:"状态",dataIndex:"status",width:200,render:r=>o("span",{children:ee(r,P)})},{title:"模块",dataIndex:"module",width:200},{title:"控制器",dataIndex:"controller",width:200},{title:"创建时间",dataIndex:"created_at",width:200},{title:"更新时间",dataIndex:"updated_at",width:200},{title:"操作",dataIndex:"operate",width:200,fixed:"right",render:(r,I)=>t(r,I)}],he=t=>[{label:"名称",name:"name",rules:M,component:"Input"},{label:"状态",name:"status",rules:R,component:"Select",componentProps:{options:P}},{label:"模块",name:"module",rules:R,component:"Select",componentProps:{options:N}},{label:"控制器",name:"controller",rules:M,component:"Input"},{label:"创建菜单",name:"actions",hidden:!!t,component:"CheckboxGroup",componentProps:{options:ae}}];function ge(t){return i.get("/authority/menu/index",{params:t})}function Se(t){return i.get(`/authority/menu/${t}`)}function Ce(t){return i.post("/authority/menu",t)}function Ie(t,r){return i.put(`/authority/menu/${t}`,r)}function ye(t){return i.delete(`/authority/menu/${t}`)}function Ne(t){return i.get("/authority/menu/tree",{params:t})}function ke(t){return i.put("/authority/menu/authorize/save",t)}const C={page:1,pageSize:20},F={status:1};function ze(){ne("菜单管理");const t=n.useRef(null),r=n.useRef(null),[I,m]=n.useState(!1),[u,p]=n.useState(!1),[k,d]=n.useState(!1),[z,x]=n.useState(U),[y,D]=n.useState(""),[O,T]=n.useState(F),[w,B]=n.useState(C.page),[b,A]=n.useState(C.pageSize),[j,v]=n.useState(0),[Q,V]=n.useState([]),f=se(e=>e.user.permissions),h="/authority/menu",c={page:S(`${h}/index`,f),create:S(`${h}/create`,f),update:S(`${h}/update`,f),delete:S(`${h}/delete`,f)},q=e=>{B(1),l({page:1,pageSize:b,...e})},l=n.useCallback(async e=>{try{p(!0);const{data:{data:a}}=await ge(e),{items:s,total:g}=a;v(g),V(s)}finally{p(!1)}},[]);n.useEffect(()=>{c.page&&l({...C})},[l,c.page]);const G=()=>{m(!0),x(U),D(""),T(F)},H=async e=>{try{m(!0),x(te(e)),D(e),d(!0);const{data:{data:a}}=await Se(e);T(a)}finally{d(!1)}},J=()=>{var e;(e=r.current)==null||e.handleSubmit()},K=()=>{m(!1)},E=()=>{var s;const a={...((s=t.current)==null?void 0:s.getFieldsValue())||{},page:w,pageSize:b};l(a)},W=async e=>{try{d(!0);const a=()=>y?Ie(y,e):Ce(e),{data:s}=await a();_.success((s==null?void 0:s.message)||"操作成功"),m(!1),E()}finally{d(!1)}},X=async e=>{try{p(!0);const{data:a}=await ye(e);(a==null?void 0:a.code)===200&&(_.success((a==null?void 0:a.message)||"删除成功"),E())}finally{p(!1)}},Y=n.useCallback((e,a)=>{var g;B(e),A(a);const s=(g=t.current)==null?void 0:g.getFieldsValue();l({...s,page:e,pageSize:a})},[l]),Z=(e,a)=>$(L,{children:[c.update===!0&&o(oe,{className:"mr-5px",isLoading:u,onClick:()=>H(a.id)}),c.delete===!0&&o(re,{className:"mr-5px",isLoading:u,handleDelete:()=>X(a.id)})]});return o(ie,{isPermission:c.page,children:$(L,{children:[o(ce,{formRef:t,list:de,data:C,isLoading:u,isCreate:c.create,onCreate:G,handleFinish:q}),o(me,{loading:u,columns:fe(Z),dataSource:Q}),o(pe,{disabled:u,current:w,pageSize:b,total:j,onChange:Y}),o(le,{width:600,title:z,open:I,confirmLoading:k,onOk:J,onCancel:K,children:o(ue,{formRef:r,list:he(y),data:O,labelCol:{span:4},wrapperCol:{span:19},handleFinish:W})})]})})}export{ze as P,Ne as g,ke as s};
