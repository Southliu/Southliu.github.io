import{c as U,e as B,b as ur,a as _,d as Lr,_ as Ir}from"./@babel_runtime@7.19.0-130d17ca.js";import{r as i}from"./react@18.2.0-9cdefec6.js";import{u as Kr,b as Tr,B as Vr}from"./rc-select@14.1.13_biqbaboplfbrettd7655fr4n2y-1ece5e19.js";import{T as _r,c as Nr,d as Ge}from"./rc-tree@5.7.0_biqbaboplfbrettd7655fr4n2y-d230242a.js";import{d as Mr,K as ae,t as Pr,w as He,f as ar}from"./rc-util@5.24.4_biqbaboplfbrettd7655fr4n2y-ae37cd3a.js";import"./classnames@2.3.2-d75d9a59.js";import"./react-is@16.13.1-140c6955.js";import{j as Q,b as Ar}from"./@ant-design_icons@4.7.0_biqbaboplfbrettd7655fr4n2y-770bcbdb.js";var cr=i.createContext(null),dr=i.createContext(null);function Hr(e){return Array.isArray(e)?e:e!==void 0?[e]:[]}function Or(e){var r=e||{},t=r.label,a=r.value,o=r.children,c=a||"value";return{_title:t?[t]:["title","label"],value:c,key:c,children:o||"children"}}function Je(e){return!e||e.disabled||e.disableCheckbox||e.checkable===!1}function $r(e,r){var t=[];function a(o){o.forEach(function(c){t.push(c[r.value]);var n=c[r.children];n&&a(n)})}return a(e),t}function lr(e){return e==null}var Rr={width:0,height:0,display:"flex",overflow:"hidden",opacity:0,border:0,padding:0,margin:0},Fr=function(r,t){var a=Kr(),o=a.prefixCls,c=a.multiple,n=a.searchValue,u=a.toggleOpen,l=a.open,h=a.notFoundContent,f=i.useContext(dr),L=f.virtual,S=f.listHeight,k=f.listItemHeight,I=f.treeData,K=f.fieldNames,G=f.onSelect,F=f.dropdownMatchSelectWidth,J=f.treeExpandAction,p=i.useContext(cr),T=p.checkable,N=p.checkedKeys,le=p.halfCheckedKeys,O=p.treeExpandedKeys,$e=p.treeDefaultExpandAll,pe=p.treeDefaultExpandedKeys,ge=p.onTreeExpand,Re=p.treeIcon,Fe=p.showTreeIcon,ye=p.switcherIcon,me=p.treeLine,Ce=p.treeNodeFilterProp,Se=p.loadData,ie=p.treeLoadedKeys,be=p.treeMotion,ke=p.onTreeLoad,xe=p.keyEntities,Y=i.useRef(),oe=Mr(function(){return I},[l,I],function(x,E){return E[0]&&x[1]!==E[1]}),Ee=i.useMemo(function(){return T?{checked:N,halfChecked:le}:null},[T,N,le]);i.useEffect(function(){if(l&&!c&&N.length){var x;(x=Y.current)===null||x===void 0||x.scrollTo({key:N[0]})}},[l]);var ue=String(n).toLowerCase(),we=function(E){return ue?String(E[Ce]).toLowerCase().includes(ue):!1},ce=i.useState(pe),de=U(ce,2),X=de[0],De=de[1],Le=i.useState(null),se=U(Le,2),fe=se[0],ve=se[1],Ie=i.useMemo(function(){return O?B(O):n?fe:X},[X,fe,O,n]);i.useEffect(function(){n&&ve($r(I,K))},[n]);var We=function(E){De(E),ve(E),ge&&ge(E)},q=function(E){E.preventDefault()},W=function(E,R){var P=R.node;T&&Je(P)||(G(P.key,{selected:!N.includes(P.key)}),c||u(!1))},Ke=i.useState(null),M=U(Ke,2),C=M[0],je=M[1],$=xe[C];if(i.useImperativeHandle(t,function(){var x;return{scrollTo:(x=Y.current)===null||x===void 0?void 0:x.scrollTo,onKeyDown:function(R){var P,D=R.which;switch(D){case ae.UP:case ae.DOWN:case ae.LEFT:case ae.RIGHT:(P=Y.current)===null||P===void 0||P.onKeyDown(R);break;case ae.ENTER:{if($){var A=($==null?void 0:$.node)||{},Te=A.selectable,Ve=A.value;Te!==!1&&W(null,{node:{key:C},selected:!N.includes(Ve)})}break}case ae.ESC:u(!1)}},onKeyUp:function(){}}}),oe.length===0)return Q("div",{role:"listbox",className:"".concat(o,"-empty"),onMouseDown:q,children:h});var Z={fieldNames:K};return ie&&(Z.loadedKeys=ie),Ie&&(Z.expandedKeys=Ie),Ar("div",{onMouseDown:q,children:[$&&l&&Q("span",{style:Rr,"aria-live":"assertive",children:$.node.value}),Q(_r,{ref:Y,focusable:!1,prefixCls:"".concat(o,"-tree"),treeData:oe,height:S,itemHeight:k,virtual:L!==!1&&F!==!1,multiple:c,icon:Re,showIcon:Fe,switcherIcon:ye,showLine:me,loadData:n?null:Se,motion:be,activeKey:C,checkable:T,checkStrictly:!0,checkedKeys:Ee,selectedKeys:T?[]:N,defaultExpandAll:$e,...Z,onActiveChange:je,onSelect:W,onCheck:W,onExpand:We,onLoad:ke,filterTreeNode:we,expandAction:J})]})},sr=i.forwardRef(Fr);sr.displayName="OptionList";var fr=function(){return null},Wr="SHOW_ALL",vr="SHOW_PARENT",qe="SHOW_CHILD";function ir(e,r,t,a){var o=new Set(e);return r===qe?e.filter(function(c){var n=t[c];return!(n&&n.children&&n.children.some(function(u){var l=u.node;return o.has(l[a.value])})&&n.children.every(function(u){var l=u.node;return Je(l)||o.has(l[a.value])}))}):r===vr?e.filter(function(c){var n=t[c],u=n?n.parent:null;return!(u&&!Je(u.node)&&o.has(u.key))}):e}var jr=["children","value"];function hr(e){return Pr(e).map(function(r){if(!i.isValidElement(r)||!r.type)return null;var t=r.key,a=r.props,o=a.children,c=a.value,n=ur(a,jr),u=_({key:t,value:c},n),l=hr(o);return l.length&&(u.children=l),u}).filter(function(r){return r})}function Ye(e){if(!e)return e;var r=_({},e);return"props"in r||Object.defineProperty(r,"props",{get:function(){return He(!1,"New `rc-tree-select` not support return node instance as argument anymore. Please consider to remove `props` access."),r}}),r}function Ur(e,r,t,a,o,c){var n=null,u=null;function l(){function h(f){var L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"0",S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return f.map(function(k,I){var K="".concat(L,"-").concat(I),G=k[c.value],F=t.includes(G),J=h(k[c.children]||[],K,F),p=Q(fr,{...k,children:J.map(function(N){return N.node})});if(r===G&&(n=p),F){var T={pos:K,node:p,children:J};return S||u.push(T),T}return null}).filter(function(k){return k})}u||(u=[],h(a),u.sort(function(f,L){var S=f.node.props.value,k=L.node.props.value,I=t.indexOf(S),K=t.indexOf(k);return I-K}))}Object.defineProperty(e,"triggerNode",{get:function(){return He(!1,"`triggerNode` is deprecated. Please consider decoupling data with node."),l(),n}}),Object.defineProperty(e,"allCheckedNodes",{get:function(){return He(!1,"`allCheckedNodes` is deprecated. Please consider decoupling data with node."),l(),o?u:u.map(function(f){var L=f.node;return L})}})}function Br(e,r){var t=r.id,a=r.pId,o=r.rootPId,c={},n=[],u=e.map(function(l){var h=_({},l),f=h[t];return c[f]=h,h.key=h.key||f,h});return u.forEach(function(l){var h=l[a],f=c[h];f&&(f.children=f.children||[],f.children.push(l)),(h===o||!f&&o===null)&&n.push(l)}),n}function Gr(e,r,t){return i.useMemo(function(){return e?t?Br(e,_({id:"id",pId:"pId",rootPId:null},t!==!0?t:{})):e:hr(r)},[r,t,e])}const Jr=function(e){var r=i.useRef({valueLabels:new Map});return i.useMemo(function(){var t=r.current.valueLabels,a=new Map,o=e.map(function(c){var n,u=c.value,l=(n=c.label)!==null&&n!==void 0?n:t.get(u);return a.set(u,l),_(_({},c),{},{label:l})});return r.current.valueLabels=a,[o]},[e])};function or(e){var r=i.useRef();r.current=e;var t=i.useCallback(function(){return r.current.apply(r,arguments)},[]);return t}const Yr=function(e,r){return i.useMemo(function(){var t=Nr(e,{fieldNames:r,initWrapper:function(o){return _(_({},o),{},{valueEntities:new Map})},processEntity:function(o,c){var n=o.node[r.value];c.valueEntities.set(n,o)}});return t},[e,r])},qr=function(e,r,t,a){return i.useMemo(function(){var o=e.map(function(l){var h=l.value;return h}),c=r.map(function(l){var h=l.value;return h}),n=o.filter(function(l){return!a[l]});if(t){var u=Ge(o,!0,a);o=u.checkedKeys,c=u.halfCheckedKeys}return[Array.from(new Set([].concat(B(n),B(o)))),c]},[e,r,t,a])},zr=function(e,r,t){var a=t.treeNodeFilterProp,o=t.filterTreeNode,c=t.fieldNames,n=c.children;return i.useMemo(function(){if(!r||o===!1)return e;var u;if(typeof o=="function")u=o;else{var l=r.toUpperCase();u=function(L,S){var k=S[a];return String(k).toUpperCase().includes(l)}}function h(f){var L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return f.map(function(S){var k=S[n],I=L||u(r,Ye(S)),K=h(k||[],I);return I||K.length?_(_({},S),{},Lr({isLeaf:void 0},n,K)):null}).filter(function(S){return S})}return h(e)},[e,r,n,a,o])};var Qr=["id","prefixCls","value","defaultValue","onChange","onSelect","onDeselect","searchValue","inputValue","onSearch","autoClearSearchValue","filterTreeNode","treeNodeFilterProp","showCheckedStrategy","treeNodeLabelProp","multiple","treeCheckable","treeCheckStrictly","labelInValue","fieldNames","treeDataSimpleMode","treeData","children","loadData","treeLoadedKeys","onTreeLoad","treeDefaultExpandAll","treeExpandedKeys","treeDefaultExpandedKeys","onTreeExpand","treeExpandAction","virtual","listHeight","listItemHeight","onDropdownVisibleChange","dropdownMatchSelectWidth","treeLine","treeIcon","showTreeIcon","switcherIcon","treeMotion"];function Xr(e){return!e||Ir(e)!=="object"}var Zr=i.forwardRef(function(e,r){var t=e.id,a=e.prefixCls,o=a===void 0?"rc-tree-select":a,c=e.value,n=e.defaultValue,u=e.onChange,l=e.onSelect,h=e.onDeselect,f=e.searchValue,L=e.inputValue,S=e.onSearch,k=e.autoClearSearchValue,I=k===void 0?!0:k,K=e.filterTreeNode,G=e.treeNodeFilterProp,F=G===void 0?"value":G,J=e.showCheckedStrategy,p=J===void 0?qe:J,T=e.treeNodeLabelProp,N=e.multiple,le=e.treeCheckable,O=e.treeCheckStrictly,$e=e.labelInValue,pe=e.fieldNames,ge=e.treeDataSimpleMode,Re=e.treeData,Fe=e.children,ye=e.loadData,me=e.treeLoadedKeys,Ce=e.onTreeLoad,Se=e.treeDefaultExpandAll,ie=e.treeExpandedKeys,be=e.treeDefaultExpandedKeys,ke=e.onTreeExpand,xe=e.treeExpandAction,Y=e.virtual,oe=e.listHeight,Ee=oe===void 0?200:oe,ue=e.listItemHeight,we=ue===void 0?20:ue,ce=e.onDropdownVisibleChange,de=e.dropdownMatchSelectWidth,X=de===void 0?!0:de,De=e.treeLine,Le=e.treeIcon,se=e.showTreeIcon,fe=e.switcherIcon,ve=e.treeMotion,Ie=ur(e,Qr),We=Tr(t),q=le&&!O,W=le||O,Ke=O||$e,M=W||N,C=i.useMemo(function(){return Or(pe)},[JSON.stringify(pe)]),je=ar("",{value:f!==void 0?f:L,postState:function(d){return d||""}}),$=U(je,2),Z=$[0],x=$[1],E=function(d){x(d),S==null||S(d)},R=Gr(Re,Fe,ge),P=Yr(R,C),D=P.keyEntities,A=P.valueEntities,Te=i.useCallback(function(s){var d=[],v=[];return s.forEach(function(y){A.has(y)?v.push(y):d.push(y)}),{missingRawValues:d,existRawValues:v}},[A]),Ve=zr(R,Z,{fieldNames:C,treeNodeFilterProp:F,filterTreeNode:K}),ze=i.useCallback(function(s){if(s){if(T)return s[T];for(var d=C._title,v=0;v<d.length;v+=1){var y=s[d[v]];if(y!==void 0)return y}}},[C,T]),_e=i.useCallback(function(s){var d=Hr(s);return d.map(function(v){return Xr(v)?{value:v}:v})},[]),Ne=i.useCallback(function(s){var d=_e(s);return d.map(function(v){var y=v.label,V=v.value,b=v.halfChecked,g,m=A.get(V);if(m){var w;y=(w=y)!==null&&w!==void 0?w:ze(m.node),g=m.node.disabled}return{label:y,value:V,halfChecked:b,disabled:g}})},[A,ze,_e]),pr=ar(n,{value:c}),Qe=U(pr,2),Xe=Qe[0],gr=Qe[1],Ze=i.useMemo(function(){return _e(Xe)},[_e,Xe]),yr=i.useMemo(function(){var s=[],d=[];return Ze.forEach(function(v){v.halfChecked?d.push(v):s.push(v)}),[s,d]},[Ze]),er=U(yr,2),ee=er[0],rr=er[1],tr=i.useMemo(function(){return ee.map(function(s){return s.value})},[ee]),mr=qr(ee,rr,q,D),nr=U(mr,2),re=nr[0],Me=nr[1],Cr=i.useMemo(function(){var s=ir(re,p,D,C),d=s.map(function(b){var g,m,w;return(g=(m=D[b])===null||m===void 0||(w=m.node)===null||w===void 0?void 0:w[C.value])!==null&&g!==void 0?g:b}),v=d.map(function(b){var g=ee.find(function(m){return m.value===b});return{value:b,label:g==null?void 0:g.label}}),y=Ne(v),V=y[0];return!M&&V&&lr(V.value)&&lr(V.label)?[]:y.map(function(b){var g;return _(_({},b),{},{label:(g=b.label)!==null&&g!==void 0?g:b.value})})},[C,M,re,ee,Ne,p,D]),Sr=Jr(Cr),br=U(Sr,1),kr=br[0],Pe=or(function(s,d,v){var y=Ne(s);if(gr(y),I&&x(""),u){var V=s;if(q){var b=ir(s,p,D,C);V=b.map(function(H){var j=A.get(H);return j?j.node[C.value]:H})}var g=d||{triggerValue:void 0,selected:void 0},m=g.triggerValue,w=g.selected,te=V;if(O){var Be=rr.filter(function(H){return!V.includes(H.value)});te=[].concat(B(te),B(Be))}var he=Ne(te),z={preValue:ee,triggerValue:m},ne=!0;(O||v==="selection"&&!w)&&(ne=!1),Ur(z,m,s,R,ne,C),W?z.checked=w:z.selected=w;var Ae=Ke?he:he.map(function(H){return H.value});u(M?Ae:Ae[0],Ke?null:he.map(function(H){return H.label}),z)}}),Ue=i.useCallback(function(s,d){var v,y=d.selected,V=d.source,b=D[s],g=b==null?void 0:b.node,m=(v=g==null?void 0:g[C.value])!==null&&v!==void 0?v:s;if(!M)Pe([m],{selected:!0,triggerValue:m},"option");else{var w=y?[].concat(B(tr),[m]):re.filter(function(j){return j!==m});if(q){var te=Te(w),Be=te.missingRawValues,he=te.existRawValues,z=he.map(function(j){return A.get(j).key}),ne;if(y){var Ae=Ge(z,!0,D);ne=Ae.checkedKeys}else{var H=Ge(z,{checked:!1,halfCheckedKeys:Me},D);ne=H.checkedKeys}w=[].concat(B(Be),B(ne.map(function(j){return D[j].node[C.value]})))}Pe(w,{selected:y,triggerValue:m},V||"option")}y||!M?l==null||l(m,Ye(g)):h==null||h(m,Ye(g))},[Te,A,D,C,M,tr,Pe,q,l,h,re,Me]),xr=i.useCallback(function(s){if(ce){var d={};Object.defineProperty(d,"documentClickClose",{get:function(){return He(!1,"Second param of `onDropdownVisibleChange` has been removed."),!1}}),ce(s,d)}},[ce]),Er=or(function(s,d){var v=s.map(function(y){return y.value});if(d.type==="clear"){Pe(v,{},"selection");return}d.values.length&&Ue(d.values[0].value,{selected:!1,source:"selection"})}),wr=i.useMemo(function(){return{virtual:Y,dropdownMatchSelectWidth:X,listHeight:Ee,listItemHeight:we,treeData:Ve,fieldNames:C,onSelect:Ue,treeExpandAction:xe}},[Y,X,Ee,we,Ve,C,Ue,xe]),Dr=i.useMemo(function(){return{checkable:W,loadData:ye,treeLoadedKeys:me,onTreeLoad:Ce,checkedKeys:re,halfCheckedKeys:Me,treeDefaultExpandAll:Se,treeExpandedKeys:ie,treeDefaultExpandedKeys:be,onTreeExpand:ke,treeIcon:Le,treeMotion:ve,showTreeIcon:se,switcherIcon:fe,treeLine:De,treeNodeFilterProp:F,keyEntities:D}},[W,ye,me,Ce,re,Me,Se,ie,be,ke,Le,ve,se,fe,De,F,D]);return Q(dr.Provider,{value:wr,children:Q(cr.Provider,{value:Dr,children:Q(Vr,{ref:r,...Ie,id:We,prefixCls:o,mode:M?"multiple":void 0,displayValues:kr,onDisplayValuesChange:Er,searchValue:Z,onSearch:E,OptionList:sr,emptyOptions:!R.length,onDropdownVisibleChange:xr,dropdownMatchSelectWidth:X})})})}),Oe=Zr;Oe.TreeNode=fr;Oe.SHOW_ALL=Wr;Oe.SHOW_PARENT=vr;Oe.SHOW_CHILD=qe;export{Oe as G,Wr as S,fr as T,vr as a,qe as b};
