import{j as s,r as n}from"./react.ab566f72.js";import{I as w,S as B,r as i,A as M,c as te}from"./components_Business.a1227ce9.js";import{M as I,d as R,e as ae}from"./components_Dates.4cf96fd5.js";import{v as ne}from"./components_Count.86d84d70.js";import{u as se}from"./page_content_article.19e7b455.js";import{c as S}from"./layouts.285bed3b.js";import{u as oe}from"./components_Fullscreen.548d6423.js";import{U as re,D as ie}from"./components_Buttons.1286822e.js";import{B as ce}from"./components_Content.67fac38b.js";import{B as le}from"./components_Search.68b927e1.js";import{B as ue}from"./components_Modal.87933c15.js";import{B as me}from"./components_Form.f68ce3f4.js";import{B as pe}from"./components_Table.9d12c2b5.js";import{B as de}from"./components_Pagination.9418f1c2.js";import{m as $}from"./antd.d195a08c.js";const U=[{label:"状态",name:"status",component:"Select",componentProps:{options:I}},{label:"模块",name:"module",wrapperCol:170,component:"Select",componentProps:{options:R}},{label:"控制器",name:"controller",component:"Input"}],F=e=>[{title:"ID",dataIndex:"id",width:200},{title:"名称",dataIndex:"name",width:200},{title:"状态",dataIndex:"status",width:200,render:r=>s.jsx("span",{children:ne(r,I)})},{title:"模块",dataIndex:"module",width:200},{title:"控制器",dataIndex:"controller",width:200},{title:"创建时间",dataIndex:"created_at",width:200},{title:"更新时间",dataIndex:"updated_at",width:200},{title:"操作",dataIndex:"operate",width:200,fixed:"right",render:(r,C)=>e(r,C)}],O=e=>[{label:"名称",name:"name",rules:w,component:"Input"},{label:"状态",name:"status",rules:B,component:"Select",componentProps:{options:I}},{label:"模块",name:"module",rules:B,component:"Select",componentProps:{options:R}},{label:"控制器",name:"controller",rules:w,component:"Input"},{label:"创建菜单",name:"actions",hidden:!!e,component:"CheckboxGroup",componentProps:{options:ae}}],Ue=Object.freeze(Object.defineProperty({__proto__:null,createList:O,searchList:U,tableColumns:F},Symbol.toStringTag,{value:"Module"}));function fe(e){return i.get("/authority/menu/index",{params:e})}function ge(e){return i.get(`/authority/menu/${e}`)}function he(e){return i.post("/authority/menu",e)}function Se(e,r){return i.put(`/authority/menu/${e}`,r)}function xe(e){return i.delete(`/authority/menu/${e}`)}function Fe(e){return i.get("/authority/menu/tree",{params:e})}function Oe(e){return i.put("/authority/menu/authorize/save",e)}const x={page:1,pageSize:20},L={status:1};function Ce(){se("菜单管理");const e=n.useRef(null),r=n.useRef(null),[C,m]=n.useState(!1),[u,p]=n.useState(!1),[z,d]=n.useState(!1),[N,P]=n.useState(M),[b,T]=n.useState(""),[k,D]=n.useState(L),[_,j]=n.useState(x.page),[y,v]=n.useState(x.pageSize),[A,Q]=n.useState(0),[V,q]=n.useState([]),{permissions:f}=oe(),g="/authority/menu",c={page:S(`${g}/index`,f),create:S(`${g}/create`,f),update:S(`${g}/update`,f),delete:S(`${g}/delete`,f)},G=t=>{j(1),l({page:1,pageSize:y,...t})},l=n.useCallback(async t=>{try{p(!0);const{data:a}=await fe(t),{items:o,total:h}=a;Q(h),q(o)}finally{p(!1)}},[]);n.useEffect(()=>{c.page&&l({...x})},[l,c.page]);const H=()=>{m(!0),P(M),T(""),D(L)},J=async t=>{try{m(!0),P(te(t)),T(t),d(!0);const{data:a}=await ge(t);D(a)}finally{d(!1)}},K=()=>{var t;(t=r.current)==null||t.handleSubmit()},W=()=>{m(!1)},E=()=>{var o;const a={...((o=e.current)==null?void 0:o.getFieldsValue())||{},page:_,pageSize:y};l(a)},X=async t=>{try{d(!0);const a=()=>b?Se(b,t):he(t),{data:o}=await a();$.success((o==null?void 0:o.message)||"操作成功"),m(!1),E()}finally{d(!1)}},Y=async t=>{try{p(!0);const a=await xe(t);(a==null?void 0:a.code)===200&&($.success((a==null?void 0:a.message)||"删除成功"),E())}finally{p(!1)}},Z=n.useCallback((t,a)=>{var h;j(t),v(a);const o=(h=e.current)==null?void 0:h.getFieldsValue();l({...o,page:t,pageSize:a})},[l]),ee=(t,a)=>s.jsxs(s.Fragment,{children:[c.update===!0&&s.jsx(re,{className:"mr-5px",isLoading:u,onClick:()=>J(a.id)}),c.delete===!0&&s.jsx(ie,{className:"mr-5px",isLoading:u,handleDelete:()=>Y(a.id)})]});return s.jsx(ce,{isPermission:c.page,children:s.jsxs(s.Fragment,{children:[s.jsx(le,{formRef:e,list:U,data:x,isLoading:u,isCreate:c.create,onCreate:H,handleFinish:G}),s.jsx(pe,{loading:u,columns:F(ee),dataSource:V}),s.jsx(de,{disabled:u,current:_,pageSize:y,total:A,onChange:Z}),s.jsx(ue,{width:600,title:N,open:C,confirmLoading:z,onOk:K,onCancel:W,children:s.jsx(me,{formRef:r,list:O(b),data:k,labelCol:{span:4},wrapperCol:{span:19},handleFinish:X})})]})})}const ze=Object.freeze(Object.defineProperty({__proto__:null,default:Ce},Symbol.toStringTag,{value:"Module"}));export{Fe as g,ze as i,Ue as m,Oe as s};
