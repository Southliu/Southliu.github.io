import{e,h as n,b as t,d as o,g as c,c as r}from"./@babel_runtime.d775819b.js";import{r as i,e as a}from"./react.a7da97a2.js";import{r as s}from"./react-dom.cfbe57ec.js";import{c as l}from"./classnames.71976509.js";import{a as u}from"./rc-motion.477113fa.js";import{K as f}from"./rc-util.b2252098.js";var m=i.forwardRef((function(o,c){var r=o.prefixCls,a=o.style,s=o.className,u=o.duration,m=void 0===u?4.5:u,d=o.eventKey,v=o.content,y=o.closable,p=o.closeIcon,N=void 0===p?"x":p,k=o.props,C=o.onClick,E=o.onNoticeClose,x=o.times,g=i.useState(!1),h=e(g,2),b=h[0],R=h[1],j=function(){E(d)};i.useEffect((function(){if(!b&&m>0){var e=setTimeout((function(){j()}),1e3*m);return function(){clearTimeout(e)}}}),[m,b,x]);var A="".concat(r,"-notice");return i.createElement("div",n({},k,{ref:c,className:l(A,s,t({},"".concat(A,"-closable"),y)),style:a,onMouseEnter:function(){R(!0)},onMouseLeave:function(){R(!1)},onClick:C}),i.createElement("div",{className:"".concat(A,"-content")},v),y&&i.createElement("a",{tabIndex:0,className:"".concat(A,"-close"),onKeyDown:function(e){"Enter"!==e.key&&"Enter"!==e.code&&e.keyCode!==f.ENTER||j()},onClick:function(e){e.preventDefault(),e.stopPropagation(),j()}},N))})),d=a.createContext({}),v=function(e){var n=e.children,t=e.classNames;return a.createElement(d.Provider,{value:{classNames:t}},n)},y=function(e){var t=e.configList,c=e.placement,r=e.prefixCls,s=e.className,f=e.style,v=e.motion,y=e.onAllNoticeRemoved,p=e.onNoticeClose,N=i.useContext(d).classNames,k=t.map((function(e){return{config:e,key:e.key}})),C="function"==typeof v?v(c):v;return a.createElement(u,n({key:c,className:l(r,"".concat(r,"-").concat(c),null==N?void 0:N.list,s),style:f,keys:k,motionAppear:!0},C,{onAllRemoved:function(){y(c)}}),(function(e,t){var c=e.config,i=e.className,s=e.style,u=c,f=u.key,d=u.times,v=c,y=v.className,k=v.style;return a.createElement(m,n({},c,{ref:t,prefixCls:r,className:l(i,y,null==N?void 0:N.notice),style:o(o({},s),k),times:d,key:f,eventKey:f,onNoticeClose:p}))}))},p=i.forwardRef((function(n,t){var r=n.prefixCls,a=void 0===r?"rc-notification":r,l=n.container,u=n.motion,f=n.maxCount,m=n.className,d=n.style,v=n.onAllRemoved,p=n.renderNotifications,N=i.useState([]),k=e(N,2),C=k[0],E=k[1],x=function(e){var n,t=C.find((function(n){return n.key===e}));null==t||null===(n=t.onClose)||void 0===n||n.call(t),E((function(n){return n.filter((function(n){return n.key!==e}))}))};i.useImperativeHandle(t,(function(){return{open:function(e){E((function(n){var t,r=c(n),i=r.findIndex((function(n){return n.key===e.key})),a=o({},e);i>=0?(a.times=((null===(t=n[i])||void 0===t?void 0:t.times)||0)+1,r[i]=a):(a.times=0,r.push(a));return f>0&&r.length>f&&(r=r.slice(-f)),r}))},close:function(e){x(e)},destroy:function(){E([])}}}));var g=i.useState({}),h=e(g,2),b=h[0],R=h[1];i.useEffect((function(){var e={};C.forEach((function(n){var t=n.placement,o=void 0===t?"topRight":t;o&&(e[o]=e[o]||[],e[o].push(n))})),Object.keys(b).forEach((function(n){e[n]=e[n]||[]})),R(e)}),[C]);var j=function(e){R((function(n){var t=o({},n);return(t[e]||[]).length||delete t[e],t}))},A=i.useRef(!1);if(i.useEffect((function(){Object.keys(b).length>0?A.current=!0:A.current&&(null==v||v(),A.current=!1)}),[b]),!l)return null;var w=Object.keys(b);return s.createPortal(i.createElement(i.Fragment,null,w.map((function(e){var n=b[e],t=i.createElement(y,{key:e,configList:n,placement:e,prefixCls:a,className:null==m?void 0:m(e),style:null==d?void 0:d(e),motion:u,onNoticeClose:x,onAllNoticeRemoved:j});return p?p(t,{prefixCls:a,key:e}):t}))),l)})),N=["getContainer","motion","prefixCls","maxCount","className","style","onAllRemoved","renderNotifications"],k=function(){return document.body},C=0;function E(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=n.getContainer,o=void 0===t?k:t,a=n.motion,s=n.prefixCls,l=n.maxCount,u=n.className,f=n.style,m=n.onAllRemoved,d=n.renderNotifications,v=r(n,N),y=i.useState(),E=e(y,2),x=E[0],g=E[1],h=i.useRef(),b=i.createElement(p,{container:x,ref:h,prefixCls:s,motion:a,maxCount:l,className:u,style:f,onAllRemoved:m,renderNotifications:d}),R=i.useState([]),j=e(R,2),A=j[0],w=j[1],S=i.useMemo((function(){return{open:function(e){var n=function(){for(var e={},n=arguments.length,t=new Array(n),o=0;o<n;o++)t[o]=arguments[o];return t.forEach((function(n){n&&Object.keys(n).forEach((function(t){var o=n[t];void 0!==o&&(e[t]=o)}))})),e}(v,e);null!==n.key&&void 0!==n.key||(n.key="rc-notification-".concat(C),C+=1),w((function(e){return[].concat(c(e),[{type:"open",config:n}])}))},close:function(e){w((function(n){return[].concat(c(n),[{type:"close",key:e}])}))},destroy:function(){w((function(e){return[].concat(c(e),[{type:"destroy"}])}))}}}),[]);return i.useEffect((function(){g(o())})),i.useEffect((function(){h.current&&A.length&&(A.forEach((function(e){switch(e.type){case"open":h.current.open(e.config);break;case"close":h.current.close(e.key);break;case"destroy":h.current.destroy()}})),w((function(e){return e.filter((function(e){return!A.includes(e)}))})))}),[A]),[S,b]}export{m as N,v as a,E as u};
