var T=Object.defineProperty;var _=(r,t,e)=>t in r?T(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var i=(r,t,e)=>(_(r,typeof t!="symbol"?t+"":t,e),e);import{a as f}from"./components_Form.8f581885.js";import{j as l}from"./react.76efb1e3.js";import{m as d,A as C}from"./antd.469ebff6.js";import{a as E,U as S}from"./crypto-js.818b8447.js";import{a as b}from"./axios.c6a3804f.js";import{A as L,a as R}from"./components_Selects.5c62e155.js";const Q="后台管理系统",h="admin_token",V="-",g="__Vite_Admin_Secret__",X="theme_key",y="请输入",M="请选择",Z="responsive",W=[{required:!0,message:y}],tt=[{required:!0,message:M}],q="https://www.fastmock.site/mock/bdd0efa89c5ddba1b003043010702b77/v1",et=`${q}/authority/file/upload-file`,rt="新增",nt=(r,t)=>`编辑${t??""}${r?`(${r})`:""}`,st={pattern:/^(?=.*\d)(?=.*[a-zA-Z])[\da-zA-Z~!@#$%^&*+\.\_\-*]{6,30}$/,message:"密码为6-30位必须包含字母和数字!"};function U(r,t=g){const e=JSON.stringify(r);return E.encrypt(e,t).toString()}function j(r,t=g){const n=E.decrypt(r,t).toString(S);return n?JSON.parse(n):null}const w=60*60*24*2;function ot(r,t,e=w){const n=e!==null?new Date().getTime()+e*1e3:null,a=U({value:t,expire:n});localStorage.setItem(r,a)}function x(r){const t=localStorage.getItem(r);if(t){let e=null;try{e=j(t)}catch{d.error({content:"数据解密失败",key:"decryption"})}if(e){const{value:n,expire:o}=e;if(o===null||o>=Date.now())return n}return A(r),null}return null}function A(r){localStorage.removeItem(r)}let u=d;function at(){const r=C.useApp();return u=r.message,r.notification,r.modal,null}class O{constructor(t){i(this,"instance");i(this,"interceptorsObj");i(this,"abortControllerMap");var e,n,o,a;this.instance=b.create(t),this.abortControllerMap=new Map,this.interceptorsObj=t.interceptors,this.instance.interceptors.request.use(s=>{const c=new AbortController,p=s.url||"";return s.signal=c.signal,this.abortControllerMap.get(p)?this.cancelRequest(p):this.abortControllerMap.set(p,c),s},s=>s),this.instance.interceptors.request.use((e=this.interceptorsObj)==null?void 0:e.requestInterceptors,(n=this.interceptorsObj)==null?void 0:n.requestInterceptorsCatch),this.instance.interceptors.response.use((o=this.interceptorsObj)==null?void 0:o.responseInterceptors,(a=this.interceptorsObj)==null?void 0:a.responseInterceptorsCatch),this.instance.interceptors.response.use(s=>{const c=s.config.url||"";return this.abortControllerMap.delete(c),s.data},s=>s)}cancelAllRequest(){for(const[,t]of this.abortControllerMap)t.abort();this.abortControllerMap.clear()}cancelRequest(t){var n;const e=Array.isArray(t)?t:[t];for(const o of e)(n=this.abortControllerMap.get(o))==null||n.abort(),this.abortControllerMap.delete(o)}get(t,e={}){return this.instance.get(t,e)}post(t,e={},n){return this.instance.post(t,e,n)}put(t,e={},n){return this.instance.put(t,e,n)}delete(t,e={}){return this.instance.delete(t,e)}}const P="https://www.fastmock.site/mock/bdd0efa89c5ddba1b003043010702b77/v1",D=P,I=$(D);function $(r){return new O({baseURL:r,timeout:180*1e3,interceptors:{requestInterceptors(t){const e=x(h)||"";return t!=null&&t.headers&&e&&(t.headers.Authorization=`Bearer ${e}`),t},requestInterceptorsCatch(t){return u.error("请求超时！"),t},responseInterceptors(t){const{data:e}=t;return(e==null?void 0:e.code)===401?(u.error("权限不足，请重新登录！"),A(h),setTimeout(()=>{window.location.href="/"},1e3),m(e==null?void 0:e.message),t):((e==null?void 0:e.code)!==200&&m(e==null?void 0:e.message),t)},responseInterceptorsCatch(t){return b.isCancel(t)?(t.data=t.data||{},t):(m("服务器错误！"),t)}}})}const m=(r,t)=>{u.error({content:t||r||"服务器错误",key:"error"})};function k(r){return I.get("/authority/common/games",{params:r})}function v(r){return l.jsx(l.Fragment,{children:l.jsx(L,{...r,multiple:!0,api:k,fieldNames:{label:"name",value:"id"}})})}function F(r){return I.get("/platform/partner",{params:r})}function N(r){return l.jsx(R,{...r,api:F,mode:"multiple",fieldNames:{label:"name",value:"id"}})}function ct(){f("GameSelect",v),f("PartnerSelect",N)}export{rt as A,ct as C,V as E,et as F,W as I,Z as M,y as P,tt as S,X as T,M as a,h as b,I as c,Q as d,nt as e,st as f,x as g,at as h,A as r,ot as s};
