import{j as xe,i as Ve,d as D,b as Ye,c as H,_ as ze}from"./@babel_runtime@7.19.0-130d17ca.js";import{r as v}from"./react@18.2.0-9cdefec6.js";import{c as ae}from"./classnames@2.3.2-d75d9a59.js";import{A as Je,w as Qe,e as Re,B as re,i as Ze,K as L}from"./rc-util@5.24.4_biqbaboplfbrettd7655fr4n2y-ae37cd3a.js";import{b as Me,j as w}from"./@ant-design_icons@4.7.0_biqbaboplfbrettd7655fr4n2y-7910088d.js";function ie(){return typeof BigInt=="function"}function R(e){var t=e.trim(),n=t.startsWith("-");n&&(t=t.slice(1)),t=t.replace(/(\.\d*[^0])0*$/,"$1").replace(/\.0*$/,"").replace(/^0+/,""),t.startsWith(".")&&(t="0".concat(t));var s=t||"0",i=s.split("."),l=i[0]||"0",g=i[1]||"0";l==="0"&&g==="0"&&(n=!1);var c=n?"-":"";return{negative:n,negativeStr:c,trimStr:s,integerStr:l,decimalStr:g,fullStr:"".concat(c).concat(s)}}function ue(e){var t=String(e);return!Number.isNaN(Number(t))&&t.includes("e")}function U(e){var t=String(e);if(ue(e)){var n=Number(t.slice(t.indexOf("e-")+2)),s=t.match(/\.(\d+)/);return s!=null&&s[1]&&(n+=s[1].length),n}return t.includes(".")&&se(t)?t.length-t.indexOf(".")-1:0}function j(e){var t=String(e);if(ue(e)){if(e>Number.MAX_SAFE_INTEGER)return String(ie()?BigInt(e).toString():Number.MAX_SAFE_INTEGER);if(e<Number.MIN_SAFE_INTEGER)return String(ie()?BigInt(e).toString():Number.MIN_SAFE_INTEGER);t=e.toFixed(U(t))}return R(t).fullStr}function se(e){return typeof e=="number"?!Number.isNaN(e):e?/^\s*-?\d+(\.\d+)?\s*$/.test(e)||/^\s*-?\d+\.\s*$/.test(e)||/^\s*-?\.\d+\s*$/.test(e):!1}function Ce(e){var t=typeof e=="number"?j(e):R(e).fullStr,n=t.includes(".");return n?R(t.replace(/(\d)\.(\d)/g,"$1$2.")).fullStr:e+"0"}var et=function(){function e(t){if(Ve(this,e),this.origin="",this.number=void 0,this.empty=void 0,!t&&t!==0||!String(t).trim()){this.empty=!0;return}this.origin=String(t),this.number=Number(t)}return xe(e,[{key:"negate",value:function(){return new e(-this.toNumber())}},{key:"add",value:function(n){if(this.isInvalidate())return new e(n);var s=Number(n);if(Number.isNaN(s))return this;var i=this.number+s;if(i>Number.MAX_SAFE_INTEGER)return new e(Number.MAX_SAFE_INTEGER);if(i<Number.MIN_SAFE_INTEGER)return new e(Number.MIN_SAFE_INTEGER);var l=Math.max(U(this.number),U(s));return new e(i.toFixed(l))}},{key:"isEmpty",value:function(){return this.empty}},{key:"isNaN",value:function(){return Number.isNaN(this.number)}},{key:"isInvalidate",value:function(){return this.isEmpty()||this.isNaN()}},{key:"equals",value:function(n){return this.toNumber()===(n==null?void 0:n.toNumber())}},{key:"lessEquals",value:function(n){return this.add(n.negate().toString()).toNumber()<=0}},{key:"toNumber",value:function(){return this.number}},{key:"toString",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return n?this.isInvalidate()?"":j(this.number):this.origin}}]),e}(),tt=function(){function e(t){if(Ve(this,e),this.origin="",this.negative=void 0,this.integer=void 0,this.decimal=void 0,this.decimalLen=void 0,this.empty=void 0,this.nan=void 0,!t&&t!==0||!String(t).trim()){this.empty=!0;return}if(this.origin=String(t),t==="-"){this.nan=!0;return}var n=t;if(ue(n)&&(n=Number(n)),n=typeof n=="string"?n:j(n),se(n)){var s=R(n);this.negative=s.negative;var i=s.trimStr.split(".");this.integer=BigInt(i[0]);var l=i[1]||"0";this.decimal=BigInt(l),this.decimalLen=l.length}else this.nan=!0}return xe(e,[{key:"getMark",value:function(){return this.negative?"-":""}},{key:"getIntegerStr",value:function(){return this.integer.toString()}},{key:"getDecimalStr",value:function(){return this.decimal.toString().padStart(this.decimalLen,"0")}},{key:"alignDecimal",value:function(n){var s="".concat(this.getMark()).concat(this.getIntegerStr()).concat(this.getDecimalStr().padEnd(n,"0"));return BigInt(s)}},{key:"negate",value:function(){var n=new e(this.toString());return n.negative=!n.negative,n}},{key:"add",value:function(n){if(this.isInvalidate())return new e(n);var s=new e(n);if(s.isInvalidate())return this;var i=Math.max(this.getDecimalStr().length,s.getDecimalStr().length),l=this.alignDecimal(i),g=s.alignDecimal(i),c=(l+g).toString(),h=R(c),N=h.negativeStr,f=h.trimStr,m="".concat(N).concat(f.padStart(i+1,"0"));return new e("".concat(m.slice(0,-i),".").concat(m.slice(-i)))}},{key:"isEmpty",value:function(){return this.empty}},{key:"isNaN",value:function(){return this.nan}},{key:"isInvalidate",value:function(){return this.isEmpty()||this.isNaN()}},{key:"equals",value:function(n){return this.toString()===(n==null?void 0:n.toString())}},{key:"lessEquals",value:function(n){return this.add(n.negate().toString()).toNumber()<=0}},{key:"toNumber",value:function(){return this.isNaN()?NaN:Number(this.toString())}},{key:"toString",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return n?this.isInvalidate()?"":R("".concat(this.getMark()).concat(this.getIntegerStr(),".").concat(this.getDecimalStr())).fullStr:this.origin}}]),e}();function p(e){return ie()?new tt(e):new et(e)}function W(e,t,n){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(e==="")return"";var i=R(e),l=i.negativeStr,g=i.integerStr,c=i.decimalStr,h="".concat(t).concat(c),N="".concat(l).concat(g);if(n>=0){var f=Number(c[n]);if(f>=5&&!s){var m=p(e).add("".concat(l,"0.").concat("0".repeat(n)).concat(10-f));return W(m.toString(),t,n,s)}return n===0?N:"".concat(N).concat(t).concat(c.padEnd(n,"0").slice(0,n))}return h===".0"?N:"".concat(N).concat(h)}var nt=200,rt=600;function at(e){var t=e.prefixCls,n=e.upNode,s=e.downNode,i=e.upDisabled,l=e.downDisabled,g=e.onStep,c=v.useRef(),h=v.useRef();h.current=g;var N=function(I,K){I.preventDefault(),h.current(K);function A(){h.current(K),c.current=setTimeout(A,nt)}c.current=setTimeout(A,rt)},f=function(){clearTimeout(c.current)};if(v.useEffect(function(){return f},[]),Je())return null;var m="".concat(t,"-handler"),S=ae(m,"".concat(m,"-up"),D({},"".concat(m,"-up-disabled"),i)),y=ae(m,"".concat(m,"-down"),D({},"".concat(m,"-down-disabled"),l)),C={unselectable:"on",role:"button",onMouseUp:f,onMouseLeave:f};return Me("div",{className:"".concat(m,"-wrap"),children:[w("span",{...C,onMouseDown:function(I){N(I,!0)},"aria-label":"Increase Value","aria-disabled":i,className:S,children:n||w("span",{unselectable:"on",className:"".concat(t,"-handler-up-inner")})}),w("span",{...C,onMouseDown:function(I){N(I,!1)},"aria-label":"Decrease Value","aria-disabled":l,className:y,children:s||w("span",{unselectable:"on",className:"".concat(t,"-handler-down-inner")})})]})}function it(e,t){var n=v.useRef(null);function s(){try{var l=e.selectionStart,g=e.selectionEnd,c=e.value,h=c.substring(0,l),N=c.substring(g);n.current={start:l,end:g,value:c,beforeTxt:h,afterTxt:N}}catch{}}function i(){if(e&&n.current&&t)try{var l=e.value,g=n.current,c=g.beforeTxt,h=g.afterTxt,N=g.start,f=l.length;if(l.endsWith(h))f=l.length-n.current.afterTxt.length;else if(l.startsWith(c))f=c.length;else{var m=c[N-1],S=l.indexOf(m,N-1);S!==-1&&(f=S+1)}e.setSelectionRange(f,f)}catch(y){Qe(!1,"Something warning of cursor restore. Please fire issue about this: ".concat(y.message))}}return[s,i]}const ut=function(){var e=v.useRef(0),t=function(){Re.cancel(e.current)};return v.useEffect(function(){return t},[]),function(n){t(),e.current=Re(function(){n()})}};var st=["prefixCls","className","style","min","max","step","defaultValue","value","disabled","readOnly","upHandler","downHandler","keyboard","controls","stringMode","parser","formatter","precision","decimalSeparator","onChange","onInput","onPressEnter","onStep"],_e=function(t,n){return t||n.isEmpty()?n.toString():n.toNumber()},ke=function(t){var n=p(t);return n.isInvalidate()?null:n},ot=v.forwardRef(function(e,t){var n,s=e.prefixCls,i=s===void 0?"rc-input-number":s,l=e.className,g=e.style,c=e.min,h=e.max,N=e.step,f=N===void 0?1:N,m=e.defaultValue,S=e.value,y=e.disabled,C=e.readOnly,M=e.upHandler,I=e.downHandler,K=e.keyboard,A=e.controls,Ae=A===void 0?!0:A,oe=e.stringMode,O=e.parser,T=e.formatter,_=e.precision,k=e.decimalSeparator,X=e.onChange,Y=e.onInput,z=e.onPressEnter,J=e.onStep,Te=Ye(e,st),le="".concat(i,"-input"),G=v.useRef(null),Fe=v.useState(!1),ce=H(Fe,2),fe=ce[0],de=ce[1],E=v.useRef(!1),F=v.useRef(!1),$=v.useRef(!1),$e=v.useState(function(){return p(S!=null?S:m)}),ve=H($e,2),d=ve[0],me=ve[1];function qe(a){S===void 0&&me(a)}var Q=v.useCallback(function(a,r){if(!r)return _>=0?_:Math.max(U(a),U(f))},[_,f]),Z=v.useCallback(function(a){var r=String(a);if(O)return O(r);var o=r;return k&&(o=o.replace(k,".")),o.replace(/[^\w.-]+/g,"")},[O,k]),ge=v.useRef(""),he=v.useCallback(function(a,r){if(T)return T(a,{userTyping:r,input:String(ge.current)});var o=typeof a=="number"?j(a):a;if(!r){var u=Q(o,r);if(se(o)&&(k||u>=0)){var b=k||".";o=W(o,b,u)}}return o},[T,Q,k]),Be=v.useState(function(){var a=m!=null?m:S;return d.isInvalidate()&&["string","number"].includes(ze(a))?Number.isNaN(a)?"":a:he(d.toString(),!1)}),Ne=H(Be,2),q=Ne[0],Se=Ne[1];ge.current=q;function B(a,r){Se(he(a.isInvalidate()?a.toString(!1):a.toString(!r),r))}var x=v.useMemo(function(){return ke(h)},[h,_]),V=v.useMemo(function(){return ke(c)},[c,_]),pe=v.useMemo(function(){return!x||!d||d.isInvalidate()?!1:x.lessEquals(d)},[x,d]),be=v.useMemo(function(){return!V||!d||d.isInvalidate()?!1:d.lessEquals(V)},[V,d]),Pe=it(G.current,fe),ye=H(Pe,2),Ue=ye[0],Ke=ye[1],Ie=function(r){return x&&!r.lessEquals(x)?x:V&&!V.lessEquals(r)?V:null},ee=function(r){return!Ie(r)},te=function(r,o){var u=r,b=ee(u)||u.isEmpty();if(!u.isEmpty()&&!o&&(u=Ie(u)||u,b=!0),!C&&!y&&b){var P=u.toString(),ne=Q(P,o);return ne>=0&&(u=p(W(P,".",ne)),ee(u)||(u=p(W(P,".",ne,!0)))),u.equals(d)||(qe(u),X==null||X(u.isEmpty()?null:_e(oe,u)),S===void 0&&B(u,o)),u}return d},Oe=ut(),Ee=function a(r){if(Ue(),Se(r),!F.current){var o=Z(r),u=p(o);u.isNaN()||te(u,!0)}Y==null||Y(r),Oe(function(){var b=r;O||(b=r.replace(/ã€‚/g,".")),b!==r&&a(b)})},Ge=function(){F.current=!0},He=function(){F.current=!1,Ee(G.current.value)},Le=function(r){Ee(r.target.value)},De=function(r){var o;if(!(r&&pe||!r&&be)){E.current=!1;var u=p($.current?Ce(f):f);r||(u=u.negate());var b=(d||p(0)).add(u.toString()),P=te(b,!1);J==null||J(_e(oe,P),{offset:$.current?Ce(f):f,type:r?"up":"down"}),(o=G.current)===null||o===void 0||o.focus()}},we=function(r){var o=p(Z(q)),u=o;o.isNaN()?u=d:u=te(o,r),S!==void 0?B(d,!1):u.isNaN()||B(u,!1)},We=function(r){var o=r.which,u=r.shiftKey;E.current=!0,u?$.current=!0:$.current=!1,o===L.ENTER&&(F.current||(E.current=!1),we(!1),z==null||z(r)),K!==!1&&!F.current&&[L.UP,L.DOWN].includes(o)&&(De(L.UP===o),r.preventDefault())},je=function(){E.current=!1,$.current=!1},Xe=function(){we(!1),de(!1),E.current=!1};return re(function(){d.isInvalidate()||B(d,!1)},[_]),re(function(){var a=p(S);me(a);var r=p(Z(q));(!a.equals(r)||!E.current||T)&&B(a,E.current)},[S]),re(function(){T&&Ke()},[q]),Me("div",{className:ae(i,l,(n={},D(n,"".concat(i,"-focused"),fe),D(n,"".concat(i,"-disabled"),y),D(n,"".concat(i,"-readonly"),C),D(n,"".concat(i,"-not-a-number"),d.isNaN()),D(n,"".concat(i,"-out-of-range"),!d.isInvalidate()&&!ee(d)),n)),style:g,onFocus:function(){de(!0)},onBlur:Xe,onKeyDown:We,onKeyUp:je,onCompositionStart:Ge,onCompositionEnd:He,children:[Ae&&w(at,{prefixCls:i,upNode:M,downNode:I,upDisabled:pe,downDisabled:be,onStep:De}),w("div",{className:"".concat(le,"-wrap"),children:w("input",{autoComplete:"off",role:"spinbutton","aria-valuemin":c,"aria-valuemax":h,"aria-valuenow":d.isInvalidate()?null:d.toString(),step:f,...Te,ref:Ze(G,t),className:le,value:q,onChange:Le,disabled:y,readOnly:C})})]})});ot.displayName="InputNumber";export{ot as I};
