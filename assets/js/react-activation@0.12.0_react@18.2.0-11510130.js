import{p as kt,n as St}from"./@babel_runtime@7.19.0-130d17ca.js";import{r as Et,a as Ot,b as Ct,c as Pt,d as jt,e as _t,f as xt,g as At,h as It,i as Nt,j as Bt,k as $t,l as Rt,m as Ut,n as qt}from"./szfe-tools@0.0.0-beta.7-96b486ac.js";import{a as Dt}from"./react@18.2.0-9cdefec6.js";import{r as Tt}from"./create-react-context@0.3.0_react@18.2.0-65336ddb.js";import{r as Lt}from"./hoist-non-react-statics@3.3.2-45eb0518.js";import{r as Mt}from"./react-node-key@0.4.0_react@18.2.0-d6e29f2b.js";var Re={exports:{}},ye={exports:{}};(function(ge,Ue){(function(k,I){I(Ue,Et(),Ot(),Ct(),Pt(),Dt(),jt(),Tt(),_t(),xt(),At(),It(),Nt(),Bt(),$t(),Lt(),Rt(),Ut(),qt(),Mt())})(kt,function(k,I,y,m,D,d,w,T,L,$,K,M,j,x,F,R,z,G,N,V){I=I&&Object.prototype.hasOwnProperty.call(I,"default")?I.default:I,y=y&&Object.prototype.hasOwnProperty.call(y,"default")?y.default:y,m=m&&Object.prototype.hasOwnProperty.call(m,"default")?m.default:m,D=D&&Object.prototype.hasOwnProperty.call(D,"default")?D.default:D;var f="default"in d?d.default:d;function we(n,r){var e,t=Object.keys(n);return Object.getOwnPropertySymbols&&(e=Object.getOwnPropertySymbols(n),r&&(e=e.filter(function(c){return Object.getOwnPropertyDescriptor(n,c).enumerable})),t.push.apply(t,e)),t}function U(n){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?we(Object(e),!0).forEach(function(t){l(n,t,e[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):we(Object(e)).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))})}return n}function S(n,r){if(!(n instanceof r))throw new TypeError("Cannot call a class as a function")}function be(n,r){for(var e=0;e<r.length;e++){var t=r[e];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(n,t.key,t)}}function E(n,r,e){r&&be(n.prototype,r),e&&be(n,e),Object.defineProperty(n,"prototype",{writable:!1})}function l(n,r,e){return r in n?Object.defineProperty(n,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[r]=e,n}function q(){return(q=Object.assign?Object.assign.bind():function(n){for(var r=1;r<arguments.length;r++){var e,t=arguments[r];for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e])}return n}).apply(this,arguments)}function O(n,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(r&&r.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),r&&ke(n,r)}function oe(n){return(oe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)})(n)}function ke(n,r){return(ke=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(n,r)}function B(n,r){if(n==null)return{};var e,t=function(a,o){if(a==null)return{};for(var s,i={},h=Object.keys(a),v=0;v<h.length;v++)s=h[v],0<=o.indexOf(s)||(i[s]=a[s]);return i}(n,r);if(Object.getOwnPropertySymbols)for(var c=Object.getOwnPropertySymbols(n),u=0;u<c.length;u++)e=c[u],0<=r.indexOf(e)||Object.prototype.propertyIsEnumerable.call(n,e)&&(t[e]=n[e]);return t}function p(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function ae(n,r){if(r&&(typeof r=="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return p(n)}function C(n){var r=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var e,t=oe(n);return ae(this,r?(e=oe(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function Y(n,r){return Ee(n)||function(e,t){var c=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(c!=null){var u,a,o=[],s=!0,i=!1;try{for(c=c.call(e);!(s=(u=c.next()).done)&&(o.push(u.value),!t||o.length!==t);s=!0);}catch(h){i=!0,a=h}finally{try{s||c.return==null||c.return()}finally{if(i)throw a}}return o}}(n,r)||ce(n,r)||Ce()}function Se(n){return Ee(n)||Oe(n)||ce(n)||Ce()}function P(n){return function(r){if(Array.isArray(r))return ue(r)}(n)||Oe(n)||ce(n)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function Ee(n){if(Array.isArray(n))return n}function Oe(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function ce(n,r){var e;if(n)return typeof n=="string"?ue(n,r):(e=(e=Object.prototype.toString.call(n).slice(8,-1))==="Object"&&n.constructor?n.constructor.name:e)==="Map"||e==="Set"?Array.from(n):e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?ue(n,r):void 0}function ue(n,r){(r==null||r>n.length)&&(r=n.length);for(var e=0,t=new Array(r);e<r;e++)t[e]=n[e];return t}function Ce(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}w=w&&Object.prototype.hasOwnProperty.call(w,"default")?w.default:w,T=T&&Object.prototype.hasOwnProperty.call(T,"default")?T.default:T,L=L&&Object.prototype.hasOwnProperty.call(L,"default")?L.default:L,$=$&&Object.prototype.hasOwnProperty.call($,"default")?$.default:$,K=K&&Object.prototype.hasOwnProperty.call(K,"default")?K.default:K,M=M&&Object.prototype.hasOwnProperty.call(M,"default")?M.default:M,j=j&&Object.prototype.hasOwnProperty.call(j,"default")?j.default:j,x=x&&Object.prototype.hasOwnProperty.call(x,"default")?x.default:x,F=F&&Object.prototype.hasOwnProperty.call(F,"default")?F.default:F,R=R&&Object.prototype.hasOwnProperty.call(R,"default")?R.default:R,z=z&&Object.prototype.hasOwnProperty.call(z,"default")?z.default:z,G=G&&Object.prototype.hasOwnProperty.call(G,"default")?G.default:G,N=N&&Object.prototype.hasOwnProperty.call(N,"default")?N.default:N,V=V&&Object.prototype.hasOwnProperty.call(V,"default")?V.default:V;function ie(){var n,r,e;return w(d.useContext)?d.useContext(Z)||(r=(n=Y(d.useState(J.currentContextValue),2))[0],e=n[1],d.useEffect(function(){var t=D(e);return H.on("update",t),function(){return H.off("update",t)}},[]),r):{}}function qe(e){var r=e.children,e=B(e,Ve);return f.createElement(De,q({},e,{_nk:"".concat(ne,"11")}),f.createElement(J,q({},e,{_nk:"".concat(ne,"21")}),r))}function Pe(n){var r=n.children;return f.createElement(Te,{_nk:"".concat(ne,"31")},function(e){return e?m(r,void 0,e):f.createElement(ze,{_nk:"".concat(ne,"41")},r)})}var Z=T(),De=Z.Provider,Te=Z.Consumer,te=T(),Le=te.Provider,Me=te.Consumer,H=new L,J=function(){O(r,d.Component);var n=C(r);function r(e){var t;return S(this,r),t=n.call(this,e),r.currentContextValue=e.value,t}return E(r,[{key:"shouldComponentUpdate",value:function(e){return e.value!==this.props.value&&(r.currentContextValue=e.value,H.emit("update",e.value)),e.children!==this.props.children||e.value!==this.props.value}},{key:"render",value:function(){return this.props.children}}]),r}(),ze=(l(J,"eventBus",H),l(J,"currentContextValue",void 0),function(){O(r,d.PureComponent);var n=C(r);function r(e){var t;return S(this,r),l(p(t=n.call(this,e)),"state",{context:J.currentContextValue}),l(p(t),"updateListener",D(function(c){t.setState({context:c})})),H.on("update",t.updateListener),t}return E(r,[{key:"componentWillUnmount",value:function(){H.off("update",this.updateListener)}},{key:"render",value:function(){var e=this.props.children,t=this.state.context;return m(e,void 0,t)}}]),r}()),Ve=["children"],ne="qj9A",We=function(){O(r,d.Component);var n=C(r);function r(){var e;S(this,r);for(var t=arguments.length,c=new Array(t),u=0;u<t;u++)c[u]=arguments[u];return l(p(e=n.call.apply(n,[this].concat(c))),"promiseCache",{}),e}return E(r,[{key:"render",value:function(){var t=this.props,e=t.freeze,t=t.children,c=this.promiseCache;if(e&&!c.promise)throw c.promise=new Promise(function(u){c.resolve=u}),c.promise;if(e)throw c.promise;return c.promise&&(c.resolve(),c.promise=void 0),f.createElement(d.Fragment,null,t)}}]),r}();function je(){try{for(var n=arguments.length,r=new Array(n),e=0;e<n;e++)r[e]=arguments[e];r.forEach(function(c){var c=Se(c),u=c[0];c.slice(1).forEach(function(a){var o;w(y(u,a))&&!y(u,[a,"_overridden"])&&(o=u[a].bind(u),u[a]=function(s){K(s)||Fe(s);for(var i=arguments.length,h=new Array(1<i?i-1:0),v=1;v<i;v++)h[v-1]=arguments[v];return o.apply(void 0,[s].concat(h))},u[a]._overridden=!0)})})}catch(t){console.warn("activation override failed:",t)}}function _e(n){return n=n.children,m(n)}var xe=[],se=new Map,Ke=new L,le=j(function(n){!M(n)||[Z,te].includes(n)||(xe.push(n),setTimeout(function(){return Ke.emit("update")}))}),Fe=j(function(n){n=y(n,"_context")||y(n,"context"),y(n,"$$typeof")===y(Z,"$$typeof")&&le(n)}),Ge=(je([f,"createElement"]),function(){O(r,d.PureComponent);var n=C(r);function r(u){S(this,r),l(p(t=n.call(this,u)),"unmount",null);var t,c,u=u.value;return u.length===0?(t.state={ctxValue:null},ae(t)):((u=Y(u,1)[0]).ctx,c=u.value,u=u.onUpdate,t.state={ctxValue:c},t.unmount=u(function(a){t.setState({ctxValue:a})}),t)}return E(r,[{key:"componentWillUnmount",value:function(){m(this.unmount)}},{key:"render",value:function(){var e,t,u=this.props,c=u.value,u=u.children;return c.length===0?u:(e=this.state.ctxValue,t=(c=Se(c))[0].ctx,c=c.slice(1),t=t.Provider,t=x(e)?u:f.createElement(t,{value:e,_nk:"".concat("lqEk","11")},u),0<c.length?f.createElement(r,{value:c,_nk:"".concat("lqEk","21")},t):t)}}]),r}()),He=function(){O(r,d.Component);var n=C(r);function r(a){S(this,r),l(p(t=n.call(this,a)),"updateListener",null),l(p(t),"ctxInfo",null);var t,c=a.value,u=a.ctx,a=a.id;return x(c)?ae(t):(t.updateListener=y(se.get(u),a,new Map),m(t.updateListener,"forEach",function(o){return o(c)}),t.ctxInfo={ctx:u,value:c,onUpdate:function(o){return t.updateListener.set(o,o),function(){return t.updateListener.delete(o)}}},t)}return E(r,[{key:"componentWillUnmount",value:function(){var c=this.props,e=c.value,t=c.ctx,c=c.id;x(e)||se.set(t,U(U({},y(se.get(t),void 0,{})),{},l({},c,this.updateListener)))}},{key:"shouldComponentUpdate",value:function(e){var t=e.value;return this.props.value!==t&&m(this.updateListener,"forEach",function(c){return c(t)}),!0}},{key:"render",value:function(){var e=this,t=this.props,c=t.value,u=t.renderWrapper,a=t.renderContent;return t.id,u(function(o){return a(x(c)?o:[].concat(P(o),[e.ctxInfo]))})}}]),r}(),pe={},Xe=function(){O(r,d.PureComponent);var n=C(r);function r(c){S(this,r),l(p(t=n.call(this,c)),"renderWrapper",function(u){var a=t.props.id;return pe[a].reduce(function(o,s){var i=s.Consumer;return function(h){return f.createElement(i,{_nk:"".concat("SsUr","11")},function(v){return f.createElement(He,{value:v,ctx:s,renderWrapper:o,renderContent:h,id:a,_nk:"".concat("SsUr","21")})})}},function(o){return o([])})(u)});var t,c=c.id;return pe[c]||(pe[c]=P(xe)),t}return E(r,[{key:"render",value:function(){var e=this.props.children;return this.renderWrapper(e)}}]),r}(),fe="46lG",j=w(d.lazy)&&!x(d.Suspense),Ye=j?d.lazy(function(){return new Promise(function(){return null})}):function(){return null},Ze=function(){O(r,d.Component);var n=C(r);function r(){return S(this,r),n.apply(this,arguments)}return E(r,[{key:"componentDidMount",value:function(){m(this.props,"onStart")}},{key:"componentWillUnmount",value:function(){m(this.props,"onEnd")}},{key:"render",value:function(){return null}}]),r}(),Je=j?function(){O(r,d.Component);var n=C(r);function r(){var e;S(this,r);for(var t=arguments.length,c=new Array(t),u=0;u<t;u++)c[u]=arguments[u];return l(p(e=n.call.apply(n,[this].concat(c))),"state",{suspense:!1}),l(p(e),"onSuspenseStart",function(){e.setState({suspense:!0})}),l(p(e),"onSuspenseEnd",function(){e.setState({suspense:!1})}),l(p(e),"sus$$",{onSuspenseStart:e.onSuspenseStart,onSuspenseEnd:e.onSuspenseEnd}),e}return E(r,[{key:"render",value:function(){var e=this.props.children;return f.createElement(d.Fragment,null,m(e,void 0,this.sus$$),this.state.suspense&&f.createElement(Ye,{_nk:"".concat(fe,"31")}))}}]),r}():_e,Qe=j?function(e){var r=e.children,e=e.sus$$;return f.createElement(d.Suspense,{fallback:f.createElement(Ze,{onStart:e.onSuspenseStart,onEnd:e.onSuspenseEnd,_nk:"".concat(fe,"21")}),_nk:"".concat(fe,"11")},r)}:_e,Ae=function(){O(r,d.Component);var n=C(r);function r(){return S(this,r),n.apply(this,arguments)}return E(r,[{key:"componentDidCatch",value:function(e){var t=this.props.error$$;m(t,void 0,e,function(){m(t,void 0,null)})}},{key:"render",value:function(){return this.props.children}}]),r}(),et=(l(Ae,"getDerivedStateFromError",function(){return null}),function(){O(r,d.Component);var n=C(r);function r(){var e;S(this,r);for(var t=arguments.length,c=new Array(t),u=0;u<t;u++)c[u]=arguments[u];return l(p(e=n.call.apply(n,[this].concat(c))),"state",{error:null}),l(p(e),"throwError",function(a,o){return e.setState({error:a},o)}),e}return E(r,[{key:"render",value:function(){if(this.state.error)throw this.state.error;return m(this.props.children,void 0,this.throwError)}}]),r}()),X="lajT";function tt(u){var r=u.id,e=u.children,u=u.bridgeProps,t=u.sus$$,c=u.ctx$$,u=u.error$$;return f.createElement(Ae,{error$$:u,_nk:"".concat(X,"11")},f.createElement(Qe,{sus$$:t,_nk:"".concat(X,"21")},f.createElement(Ge,{id:r,value:c,_nk:"".concat(X,"31")},e)))}function nt(n){var r=n.id,e=n.children;return f.createElement(et,{_nk:"".concat(X,"41")},function(t){return f.createElement(Je,{_nk:"".concat(X,"51")},function(c){return f.createElement(Xe,{id:r,_nk:"".concat(X,"61")},function(u){return m(e,void 0,{bridgeProps:{sus$$:c,ctx$$:u,error$$:t}})})})})}function Ie(n){var r=function(){O(t,d.Component);var e=C(t);function t(){var c;S(this,t);for(var u=arguments.length,a=new Array(u),o=0;o<u;o++)a[o]=arguments[o];return l(p(c=e.call.apply(e,[this].concat(a))),"drop",null),c}return E(t,[{key:"componentWillUnmount",value:function(){m(this.drop)}},{key:"render",value:function(){var c=this,u=this.props,a=u.forwardedRef,o=B(u,rt);return f.createElement(Me,{_nk:"".concat(de,"11")},function(){var s=(0<arguments.length&&arguments[0]!==void 0?arguments[0]:{}).attach;return f.createElement(n,q({ref:function(i){[A,b].every(function(h){return!w(y(i,h))})||(c.drop=m(s,void 0,i),x(a)||(F(a)&&"current"in a?a.current=i:m(a,void 0,i)))}},o,{_nk:"".concat(de,"21")}))})}}]),t}();return w(n.prototype.componentDidMount)&&(n.prototype._componentDidMount=n.prototype.componentDidMount,n.prototype.componentDidMount=function(){var e=this;$(function(){return n.prototype._componentDidMount.call(e)})}),w(d.forwardRef)?R(d.forwardRef(function(e,t){return f.createElement(r,q({},e,{forwardedRef:t,_nk:"".concat(de,"31")}))}),n):R(r,n)}function Ne(n,r){var e,t;[d.useRef,d.useContext,d.useEffect].some(function(c){return!w(c)})||(t=d.useContext(te))&&(e=d.useRef({}).current,t=t.attach,e[n]=r,e.drop=t(e),d.useEffect(function(){return function(){return m(e.drop)}},[]))}var rt=["forwardedRef"],de="XKTv",A="componentDidActivate",b="componentWillUnactivate",j=Ne.bind(null,A),ot=Ne.bind(null,b),at=["id"],re="bNyU",ct=d.Suspense?function(t){var r=t.freeze,e=t.children,t=t.placeholder;return f.createElement(d.Suspense,{fallback:t===void 0?null:t,_nk:"".concat("Leb+","11")},f.createElement(We,{freeze:r,_nk:"".concat("Leb+","21")},e))}:function(n){return n.children},ut=function(){O(r,d.PureComponent);var n=C(r);function r(e){var t;S(this,r);for(var c=arguments.length,u=new Array(1<c?c-1:0),a=1;a<c;a++)u[a-1]=arguments[a];return l(p(t=n.call.apply(n,[this,e].concat(u))),"eventBus",new L),l(p(t),"listeners",new Map),l(p(t),"wrapper",null),l(p(t),"cache",void 0),l(p(t),"unmounted",!1),l(p(t),"safeSetState",function(o,s){t.unmounted||t.setState(o,s)}),l(p(t),"freezeTimeout",null),l(p(t),"attach",function(o){var s,i=t.listeners;return o?(o.isKeepAlive&&$(function(){var v=t.props,h=v.id,v=v.store.get(h);v.aliveNodesId=new Set([].concat(P(v.aliveNodesId),[o.id]))}),i.set(o,(l(s={},A,function(){return m(o,A)}),l(s,b,function(){return m(o,b)}),s)),function(){i.delete(o)}):function(){return null}}),l(p(t),"contextValue",{id:t.props.id,attach:t.attach}),l(p(t),"drop",function(){var o=(0<arguments.length&&arguments[0]!==void 0?arguments[0]:{}).delay,s=o===void 0?1200:o;return new Promise(function(i){function h(){clearTimeout(v),t.eventBus.off(b,h),t.cache.willDrop=!0,_.nodes.delete(bt),_.helpers=U({},_.helpers),_.smartForceUpdate(function(){return i(!0)})}var v,g=t.props,_=g.scope,bt=g.id;y(t.cache,"cached")||y(t.cache,"willDrop")?h():(t.eventBus.on(b,h),v=setTimeout(function(){t.eventBus.off(b,h),i(!1)},s))})}),l(p(t),"refresh",function(){return new Promise(function(o){y(t.cache,"cached")&&o(!1),t.safeSetState({key:Math.random()},function(){return o(!0)})})}),t.state={children:e.children,bridgeProps:e.bridgeProps,key:Math.random(),freeze:!1},t}return E(r,[{key:"componentDidMount",value:function(){var e,t=this,u=this.props,c=u.store,u=u.id,a=this.listeners,o=this.wrapper;if(!c.has(u)){try{e=P(o.children)}catch{e=[o.children]}this.cache=(l(a={listeners:a,aliveNodesId:[],inited:!1,cached:!1,wrapper:o,nodes:e},A,function(){return t[A]()}),l(a,b,function(){return t[b]()}),a),c.set(u,this.cache)}}},{key:"componentWillUnmount",value:function(){var c=this.props,e=c.store,t=c.keepers,c=c.id;try{var u=e.get(c);u.nodes.forEach(function(a){u.wrapper.appendChild(a)})}catch{}e.delete(c),t.delete(c),this.unmounted=!0}},{key:A,value:function(){clearTimeout(this.freezeTimeout),this.safeSetState({freeze:!1}),this.eventBus.emit(A),this.listeners.forEach(function(e){return m(e,[A])})}},{key:b,value:function(){var e=this;this.eventBus.emit(b),P(this.listeners).reverse().forEach(function(t){return t=Y(t,2)[1],m(t,[b])}),clearTimeout(this.freezeTimeout),this.freezeTimeout=setTimeout(function(){e.safeSetState({freeze:!0})},1e3)}},{key:"render",value:function(){var e=this,o=this.props,t=o.id,o=(B(o,at),this.state),c=o.children,u=o.bridgeProps,a=o.key,o=o.freeze;return f.createElement(ct,{freeze:o,_nk:"".concat(re,"11")},f.createElement("div",{ref:function(s){e.wrapper=s},_nk:"".concat(re,"21")},f.createElement("div",{key:"keeper-container",className:"ka-content"},f.createElement(tt,{id:t,bridgeProps:u,_nk:"".concat(re,"31")},f.createElement(Le,{value:this.contextValue,_nk:"".concat(re,"41")},f.Children.map(c,function(s,i){return f.cloneElement(s,{key:"".concat(s.key||"",":").concat(a,":").concat(i)})}))))))}}]),r}(),it=["children"],he="UVSV",Q="drop",me="refresh",st=function(){O(r,d.Component);var n=C(r);function r(){var e;S(this,r);for(var t=arguments.length,c=new Array(t),u=0;u<t;u++)c[u]=arguments[u];return l(p(e=n.call.apply(n,[this].concat(c))),"store",new Map),l(p(e),"nodes",new Map),l(p(e),"keepers",new Map),l(p(e),"debouncedForceUpdate",D(function(a){return e.forceUpdate(a)})),l(p(e),"updateCallbackList",[]),l(p(e),"smartForceUpdate",function(a){e.updateCallbackList.push(a),e.debouncedForceUpdate(function(){e.updateCallbackList.forEach(function(o){return m(o)}),e.updateCallbackList=[]})}),l(p(e),"update",function(a,o){return new Promise(function(s){var i=e.keepers.get(a),h=!i,v=Date.now(),g=e.nodes.get(a)||null;e.nodes.set(a,U(U({id:a,createTime:v,updateTime:v},g),o)),h?(e.helpers=U({},e.helpers),e.forceUpdate(s)):(v=o.children,g=o.bridgeProps,i.setState({children:v,bridgeProps:g},s))})}),l(p(e),"keep",function(a,o){return new Promise(function(s){e.update(a,U({id:a},o)).then(function(){s(e.store.get(a))})})}),l(p(e),"getCachingNodesByName",function(a){return e.getCachingNodes().filter(function(o){return a instanceof RegExp?a.test(o.name):o.name===a})}),l(p(e),"getScopeIds",function(a){return I(a.map(function o(s){var i=y(e.getCache(s),"aliveNodesId",[]);return 0<i.size?[s,P(i).map(o)]:[s].concat(P(i))}))}),l(p(e),"dropById",function(a){for(var o=arguments.length,s=new Array(1<o?o-1:0),i=1;i<o;i++)s[i-1]=arguments[i];return e.handleNodes.apply(e,[[a],Q].concat(s))}),l(p(e),"dropScopeByIds",function(a){for(var o=arguments.length,s=new Array(1<o?o-1:0),i=1;i<o;i++)s[i-1]=arguments[i];return e.handleNodes.apply(e,[e.getScopeIds(a),Q].concat(s))}),l(p(e),"drop",function(a){for(var o=arguments.length,s=new Array(1<o?o-1:0),i=1;i<o;i++)s[i-1]=arguments[i];return e.handleNodes.apply(e,[e.getCachingNodesByName(a).map(function(h){return h.id}),Q].concat(s))}),l(p(e),"dropScope",function(a){for(var o=arguments.length,s=new Array(1<o?o-1:0),i=1;i<o;i++)s[i-1]=arguments[i];return e.dropScopeByIds.apply(e,[e.getCachingNodesByName(a).map(function(h){return h.id})].concat(s))}),l(p(e),"refreshById",function(a){for(var o=arguments.length,s=new Array(1<o?o-1:0),i=1;i<o;i++)s[i-1]=arguments[i];return e.handleNodes.apply(e,[[a],me].concat(s))}),l(p(e),"refreshScopeByIds",function(a){for(var o=arguments.length,s=new Array(1<o?o-1:0),i=1;i<o;i++)s[i-1]=arguments[i];return e.handleNodes.apply(e,[e.getScopeIds(a),me].concat(s))}),l(p(e),"refresh",function(a){for(var o=arguments.length,s=new Array(1<o?o-1:0),i=1;i<o;i++)s[i-1]=arguments[i];return e.handleNodes.apply(e,[e.getCachingNodesByName(a).map(function(h){return h.id}),me].concat(s))}),l(p(e),"refreshScope",function(a){for(var o=arguments.length,s=new Array(1<o?o-1:0),i=1;i<o;i++)s[i-1]=arguments[i];return e.refreshScopeByIds.apply(e,[e.getCachingNodesByName(a).map(function(h){return h.id})].concat(s))}),l(p(e),"handleNodes",function(a){for(var o=1<arguments.length&&arguments[1]!==void 0?arguments[1]:Q,s=arguments.length,i=new Array(2<s?s-2:0),h=2;h<s;h++)i[h-2]=arguments[h];return new Promise(function(v){var g=[];a.forEach(function(_){e.store.get(_)&&(_=e.keepers.get(_),g.push(_))}),g.length===0?v(!1):Promise.all(g.map(function(_){return m.apply(void 0,[_,o].concat(i))})).then(function(_){return v(_.every(Boolean))})})}),l(p(e),"clear",function(){for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return e.handleNodes.apply(e,[e.getCachingNodes().map(function(i){return i.id}),Q].concat(o))}),l(p(e),"getCache",function(a){return e.store.get(a)}),l(p(e),"getNode",function(a){return e.nodes.get(a)}),l(p(e),"getCachingNodes",function(){return P(e.nodes.values())}),l(p(e),"helpers",{keep:e.keep,update:e.update,drop:e.drop,dropScope:e.dropScope,dropById:e.dropById,dropScopeByIds:e.dropScopeByIds,refresh:e.refresh,refreshScope:e.refreshScope,refreshById:e.refreshById,refreshScopeByIds:e.refreshScopeByIds,getScopeIds:e.getScopeIds,clear:e.clear,getCache:e.getCache,getNode:e.getNode,getCachingNodes:e.getCachingNodes}),e}return E(r,[{key:"render",value:function(){var e=this,t=this.props.children,t=t===void 0?null:t;return f.createElement(qe,{value:this.helpers,_nk:"".concat(he,"11")},t,f.createElement("div",{style:{display:"none"},_nk:"".concat(he,"21")},P(this.nodes.values()).map(function(c){var u=c.children,a=B(c,it);return f.createElement(ut,q({key:a.id},a,{scope:e,store:e.store,keepers:e.keepers,ref:function(o){e.keepers.set(a.id,o)},_nk:"iAr".concat(he,"31")}),u)})))}}]),r}(),lt=["id"],pt=["id"],ft=["forwardedRef"],dt=["forwardedRef"],W="X7Aa";function ve(n){return{drop:n.drop,dropScope:n.dropScope,refresh:n.refresh,refreshScope:n.refreshScope,clear:n.clear,getCachingNodes:n.getCachingNodes}}function ht(){var n=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return!!M(n)&&(n.scrollWidth>n.clientWidth||n.scrollHeight>n.clientHeight)}function mt(n){return w(y(N,"document.querySelectorAll"))?[].concat(P(z(m(n,"querySelectorAll","*"),[])),[n]).filter(ht):[]}var vt=["_helpers","id","children"],yt=["_helpers","id","name"],gt=y(N,"document.body"),wt=y(N,"document.scrollingElement",y(N,"document.documentElement",{})),ee=function(){O(r,d.Component);var n=C(r);function r(e){var t;return S(this,r),l(p(t=n.call(this,e)),"id",null),l(p(t),"isKeepAlive",!0),l(p(t),"cached",!1),l(p(t),"inject",function(){var c=!(0<arguments.length&&arguments[0]!==void 0)||arguments[0],o=t.props,u=o.id,a=o.saveScrollPosition,o=o._helpers.getCache(u);try{o.nodes.forEach(function(s){t.placeholder.appendChild(s)}),c&&a&&m(o.revertScrollPos)}catch{}}),l(p(t),"eject",function(){var c,u=!(0<arguments.length&&arguments[0]!==void 0)||arguments[0],s=t.props,a=s.id,o=s._helpers.getCache(a),s=I(I([t.props.saveScrollPosition]).map(function(i){return i===!0?o.nodes:i==="screen"?[wt,gt]:P(z(m(N,"document.querySelectorAll",i),[]))})).filter(Boolean);try{u&&0<s.length&&(o.revertScrollPos=(c=P(new Set(P(I(s.map(mt))))).map(function(i){return[i,{x:i.scrollLeft,y:i.scrollTop}]}),function(){c.forEach(function(g){var g=Y(g,2),h=g[0],g=g[1],v=g.x,g=g.y;h.scrollLeft=v,h.scrollTop=g})})),o.nodes.forEach(function(i){u?t.placeholder.removeChild(i):o.wrapper.appendChild(i)})}catch{}}),l(p(t),"init",function(){var o=t.props,c=o._helpers,u=o.id,a=o.children,o=B(o,vt);c.keep(u,U({children:a,getInstance:function(){return p(t)}},o)).then(function(s){s&&(t.inject(),s.inited?m(p(t),A):s.inited=!0,t.cached=!1)})}),l(p(t),"update",function(){var o=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},c=o._helpers,u=o.id,a=o.name,o=B(o,yt);c&&!t.cached&&c.update(u,U({name:a,getInstance:function(){return p(t)}},o))}),t.id=e.id,t.init(),[A,b].forEach(function(c){t[c]=function(){var a=t.props,o=a.id,a=a._helpers,u=a.getCache(o),a=a.getNode(o),o=(a&&c===A&&(a.updateTime=Date.now()),c===b);!u||u.willDrop?t.cached&&!o&&t.init():(m(u,c),u.cached=o,t.cached=o)}}),t}return E(r,[{key:"shouldComponentUpdate",value:function(e){return this.update(e),!1}},{key:"componentWillUnmount",value:function(){var a=this.props,e=a.id,t=a._helpers,a=a.when,a=a===void 0||a,c=t.getCache(e);a=m(a);var a=Y(G(a)?a:[a],2),u=a[0],a=a[1];c&&(this.eject(),delete c.getInstance,u||(a?([c].concat(P(t.getScopeIds([e]).map(function(o){return t.getCache(o)}))).filter(Boolean).forEach(function(o){o.willDrop=!0}),$(function(){return t.dropScopeByIds([e])})):(c.willDrop=!0,$(function(){return t.dropById(e)}))),m(this,b))}},{key:"render",value:function(){var e=this;return f.createElement("div",{key:"keep-alive-placeholder",className:"ka-wrapper",ref:function(t){e.placeholder=t}})}}]),r}();l(ee,"defaultProps",{saveScrollPosition:!0});var Be,ee=w(y(N,"document.getElementById"))?(Be=Ie(ee),w(d.useContext)?function(e){var r=e.id,e=B(e,lt);return $e({idPrefix:r,helpers:ie(),props:e})}:function(n){var r=n.id,e=B(n,pt);return f.createElement(Pe,{_nk:"".concat(W,"41")},function(t){return $e({idPrefix:r,helpers:t,props:e})})}):function(n){return n=n.children,f.createElement("div",{key:"keep-alive-placeholder",className:"ka-wrapper"},f.createElement("div",{key:"keeper-container",className:"ka-content"},n))};function $e(n){var r=n.idPrefix,e=n.helpers,t=n.props;return(n=x(e))&&console.error("You should not use <KeepAlive /> outside a <AliveScope>"),n?y(t,"children",null):f.createElement(V,{prefix:r,key:t._nk,manualKey:t.cacheKey,_nk:"".concat(W,"11")},function(c){var u=t.cacheKey||c;return f.createElement(nt,{key:u,id:u,_nk:"".concat(W,"21")},function(a){return f.createElement(Be,q({key:u},t,a,{id:u,_helpers:e,_nk:"".concat(W,"31")}))})})}k.AliveScope=st,k.KeepAlive=ee,k.NodeKey=V,k.autoFixContext=je,k.createContext=function(n,r){return n=T(n,r),le(n),n},k.default=ee,k.fixContext=le,k.useActivate=j,k.useAliveController=function(){var n;return w(d.useContext)&&(n=ie())?ve(n):{}},k.useUnactivate=ot,k.withActivation=Ie,k.withAliveScope=function(n){function r(a){var c=a.helpers,u=a.props,a=a.forwardedRef;return f.createElement(n,q({},u,c,{ref:a,_nk:"".concat(W,"51")}))}var e=w(d.useContext)?function(u){var c=u.forwardedRef,u=B(u,ft);return r({helpers:ve(ie()||{}),props:u,forwardedRef:c})}:function(t){var c=t.forwardedRef,u=B(t,dt);return f.createElement(Pe,{_nk:"".concat(W,"42")},function(){return r({helpers:ve(0<arguments.length&&arguments[0]!==void 0?arguments[0]:{}),props:u,forwardedRef:c})})};return w(d.forwardRef)?R(d.forwardRef(function(t,c){return f.createElement(e,q({},t,{forwardedRef:c,_nk:"".concat(W,"61")}))}),n):R(e,n)},Object.defineProperty(k,"__esModule",{value:!0})})})(ye,ye.exports);(function(ge){ge.exports=ye.exports})(Re);const Ht=St(Re.exports);export{Ht as K,Re as r};
