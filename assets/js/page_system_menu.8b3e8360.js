import{j as o,a as $,F as L}from"./components_Bottom.fbcc2d20.js";import{r as s}from"./react.017637b6.js";import{v as ee,I as M,S as R,r as i,A as U,d as te}from"./components_Business.a44588e3.js";import{M as b,d as N,e as ae}from"./components_Dates.9fe2c989.js";import{u as se}from"./page_content_article.e633848b.js";import{a as ne}from"./react-redux.dedf6ab1.js";import{c as x}from"./layouts.14b26785.js";import{U as oe,D as re}from"./components_Buttons.4495eab3.js";import{B as ie}from"./components_Content.0104bec5.js";import{B as ce}from"./components_Search.2d10372e.js";import{B as le}from"./components_Modal.8cc8adeb.js";import{B as ue}from"./components_Form.06c69031.js";import{B as pe}from"./components_Table.8b638b34.js";import{B as me}from"./components_Pagination.7bd638e4.js";import{m as _}from"./antd.ad9c6742.js";const de=[{label:"状态",name:"status",component:"Select",componentProps:{options:b}},{label:"模块",name:"module",wrapperCol:170,component:"Select",componentProps:{options:N}},{label:"控制器",name:"controller",component:"Input"}],fe=t=>[{title:"ID",dataIndex:"id",width:200},{title:"名称",dataIndex:"name",width:200},{title:"状态",dataIndex:"status",width:200,render:r=>o("span",{children:ee(r,b)})},{title:"模块",dataIndex:"module",width:200},{title:"控制器",dataIndex:"controller",width:200},{title:"创建时间",dataIndex:"created_at",width:200},{title:"更新时间",dataIndex:"updated_at",width:200},{title:"操作",dataIndex:"operate",width:200,fixed:"right",render:(r,C)=>t(r,C)}],he=t=>[{label:"名称",name:"name",rules:M,component:"Input"},{label:"状态",name:"status",rules:R,component:"Select",componentProps:{options:b}},{label:"模块",name:"module",rules:R,component:"Select",componentProps:{options:N}},{label:"控制器",name:"controller",rules:M,component:"Input"},{label:"创建菜单",name:"actions",hidden:!!t,component:"CheckboxGroup",componentProps:{options:ae}}];function ge(t){return i.get("/authority/menu/index",{params:t})}function xe(t){return i.get(`/authority/menu/${t}`)}function Se(t){return i.post("/authority/menu",t)}function Ce(t,r){return i.put(`/authority/menu/${t}`,r)}function Ie(t){return i.delete(`/authority/menu/${t}`)}function Ne(t){return i.get("/authority/menu/tree",{params:t})}function ke(t){return i.put("/authority/menu/authorize/save",t)}const S={page:1,pageSize:20},F={status:1};function ze(){se("菜单管理");const t=s.exports.useRef(null),r=s.exports.useRef(null),[C,p]=s.exports.useState(!1),[u,m]=s.exports.useState(!1),[k,d]=s.exports.useState(!1),[z,P]=s.exports.useState(U),[I,D]=s.exports.useState(""),[O,T]=s.exports.useState(F),[w,B]=s.exports.useState(S.page),[y,A]=s.exports.useState(S.pageSize),[j,v]=s.exports.useState(0),[Q,V]=s.exports.useState([]),f=ne(e=>e.user.permissions),h="/authority/menu",c={page:x(`${h}/index`,f),create:x(`${h}/create`,f),update:x(`${h}/update`,f),delete:x(`${h}/delete`,f)},q=e=>{B(1),l({page:1,pageSize:y,...e})},l=s.exports.useCallback(async e=>{try{m(!0);const{data:{data:a}}=await ge(e),{items:n,total:g}=a;v(g),V(n)}finally{m(!1)}},[]);s.exports.useEffect(()=>{c.page&&l({...S})},[l,c.page]);const G=()=>{p(!0),P(U),D(""),T(F)},H=async e=>{try{p(!0),P(te(e)),D(e),d(!0);const{data:{data:a}}=await xe(e);T(a)}finally{d(!1)}},J=()=>{var e;(e=r.current)==null||e.handleSubmit()},K=()=>{p(!1)},E=()=>{var n;const a={...((n=t.current)==null?void 0:n.getFieldsValue())||{},page:w,pageSize:y};l(a)},W=async e=>{try{d(!0);const a=()=>I?Ce(I,e):Se(e),{data:n}=await a();_.success((n==null?void 0:n.message)||"操作成功"),p(!1),E()}finally{d(!1)}},X=async e=>{try{m(!0);const{data:a}=await Ie(e);(a==null?void 0:a.code)===200&&(_.success((a==null?void 0:a.message)||"删除成功"),E())}finally{m(!1)}},Y=s.exports.useCallback((e,a)=>{var g;B(e),A(a);const n=(g=t.current)==null?void 0:g.getFieldsValue();l({...n,page:e,pageSize:a})},[l]),Z=(e,a)=>$(L,{children:[c.update===!0&&o(oe,{className:"mr-5px",isLoading:u,onClick:()=>H(a.id)}),c.delete===!0&&o(re,{className:"mr-5px",isLoading:u,handleDelete:()=>X(a.id)})]});return o(ie,{isPermission:c.page,children:$(L,{children:[o(ce,{formRef:t,list:de,data:S,isLoading:u,isCreate:c.create,onCreate:G,handleFinish:q}),o(pe,{loading:u,columns:fe(Z),dataSource:Q}),o(me,{disabled:u,current:w,pageSize:y,total:j,onChange:Y}),o(le,{width:600,title:z,open:C,confirmLoading:k,onOk:J,onCancel:K,children:o(ue,{formRef:r,list:he(I),data:O,labelCol:{span:4},wrapperCol:{span:19},handleFinish:W})})]})})}export{ze as P,Ne as g,ke as s};
