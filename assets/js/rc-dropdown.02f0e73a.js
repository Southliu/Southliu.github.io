import{c as e,e as t,h as o,b as n}from"./@babel_runtime.d775819b.js";import{T as r}from"./@rc-component_trigger.52678524.js";import{c as i}from"./classnames.71976509.js";import{l as a,K as s,m as l,s as c}from"./rc-util.b2252098.js";import{r as f,e as u}from"./react.a7da97a2.js";var p=s.ESC,v=s.TAB;var m=f.forwardRef((function(e,t){var o=e.overlay,n=e.arrow,r=e.prefixCls,i=f.useMemo((function(){return"function"==typeof o?o():o}),[o]),a=l(t,null==i?void 0:i.ref);return u.createElement(u.Fragment,null,n&&u.createElement("div",{className:"".concat(r,"-arrow")}),u.cloneElement(i,{ref:c(i)?a:void 0}))})),d={adjustX:1,adjustY:1},g=[0,0],b={topLeft:{points:["bl","tl"],overflow:d,offset:[0,-4],targetOffset:g},top:{points:["bc","tc"],overflow:d,offset:[0,-4],targetOffset:g},topRight:{points:["br","tr"],overflow:d,offset:[0,-4],targetOffset:g},bottomLeft:{points:["tl","bl"],overflow:d,offset:[0,4],targetOffset:g},bottom:{points:["tc","bc"],overflow:d,offset:[0,4],targetOffset:g},bottomRight:{points:["tr","br"],overflow:d,offset:[0,4],targetOffset:g}},w=["arrow","prefixCls","transitionName","animation","align","placement","placements","getPopupContainer","showAction","hideAction","overlayClassName","overlayStyle","visible","trigger","autoFocus","overlay","children","onVisibleChange"];function h(s,d){var g,h=s.arrow,y=void 0!==h&&h,C=s.prefixCls,R=void 0===C?"rc-dropdown":C,E=s.transitionName,N=s.animation,O=s.align,A=s.placement,x=void 0===A?"bottomLeft":A,P=s.placements,j=void 0===P?b:P,k=s.getPopupContainer,V=s.showAction,F=s.hideAction,L=s.overlayClassName,S=s.overlayStyle,T=s.visible,M=s.trigger,W=void 0===M?["hover"]:M,D=s.autoFocus,_=s.overlay,B=s.children,H=s.onVisibleChange,I=e(s,w),K=u.useState(),X=t(K,2),Y=X[0],q=X[1],z="visible"in s?T:Y,G=u.useRef(null),J=u.useRef(null),Q=u.useRef(null);u.useImperativeHandle(d,(function(){return G.current}));var U=function(e){q(e),null==H||H(e)};!function(e){var t=e.visible,o=e.triggerRef,n=e.onVisibleChange,r=e.autoFocus,i=e.overlayRef,s=f.useRef(!1),l=function(){var e,r;t&&(null===(e=o.current)||void 0===e||null===(r=e.focus)||void 0===r||r.call(e),null==n||n(!1))},c=function(){var e;return!(null===(e=i.current)||void 0===e||!e.focus||(i.current.focus(),s.current=!0,0))},u=function(e){switch(e.keyCode){case p:l();break;case v:var t=!1;s.current||(t=c()),t?e.preventDefault():l()}};f.useEffect((function(){return t?(window.addEventListener("keydown",u),r&&a(c,3),function(){window.removeEventListener("keydown",u),s.current=!1}):function(){s.current=!1}}),[t])}({visible:z,triggerRef:Q,onVisibleChange:U,autoFocus:D,overlayRef:J});var Z,$,ee,te=function(){return u.createElement(m,{ref:J,overlay:_,prefixCls:R,arrow:y})},oe=u.cloneElement(B,{className:i(null===(g=B.props)||void 0===g?void 0:g.className,z&&(Z=s.openClassName,void 0!==Z?Z:"".concat(R,"-open"))),ref:c(B)?l(Q,B.ref):void 0}),ne=F;return ne||-1===W.indexOf("contextMenu")||(ne=["click"]),u.createElement(r,o({builtinPlacements:j},I,{prefixCls:R,ref:G,popupClassName:i(L,n({},"".concat(R,"-show-arrow"),y)),popupStyle:S,action:W,showAction:V,hideAction:ne,popupPlacement:x,popupAlign:O,popupTransitionName:E,popupAnimation:N,popupVisible:z,stretch:($=s.minOverlayWidthMatchTrigger,ee=s.alignPoint,("minOverlayWidthMatchTrigger"in s?$:!ee)?"minWidth":""),popup:"function"==typeof _?te:te(),onPopupVisibleChange:U,onPopupClick:function(e){var t=s.onOverlayClick;q(!1),t&&t(e)},getPopupContainer:k}),oe)}const y=u.forwardRef(h);export{y as D};
