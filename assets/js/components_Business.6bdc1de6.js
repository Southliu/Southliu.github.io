import{a as d}from"./components_Form.fae73a3b.js";import{j as m,F as P}from"./components_Bottom.e3b43adb.js";import{a as g}from"./axios.b5f206ad.js";import{a as p,U as A}from"./crypto-js.7e248644.js";import{m as T}from"./antd.b0c1c521.js";import{A as I,a as L}from"./components_Selects.9036a198.js";const K="后台管理系统",l="admin_token",Q="-",E="__Vite_Admin_Secret__",V="theme_key",b="请输入",k="请选择",X="responsive",Z=[{required:!0,message:b}],W=[{required:!0,message:k}],y="https://www.fastmock.site/mock/bdd0efa89c5ddba1b003043010702b77/v1",tt=`${y}/authority/file/upload-file`,et="新增",nt=(t,e)=>`编辑${e??""}${t?`(${t})`:""}`,ot={pattern:/^(?=.*\d)(?=.*[a-zA-Z])[\da-zA-Z~!@#$%^&*+\.\_\-*]{6,30}$/,message:"密码为6-30位必须包含字母和数字!"};function v(t,e=E){const n=JSON.stringify(t);return p.encrypt(n,e).toString()}function U(t,e=E){const o=p.decrypt(t,e).toString(A);return o?JSON.parse(o):null}const D=60*60*24*2;function C(t,e,n=D){const o=n!==null?new Date().getTime()+n*1e3:null,r=v({value:e,expire:o});localStorage.setItem(t,r)}function $(t){const e=localStorage.getItem(t);if(e){let n=null;try{n=U(e)}catch{T.error({content:"数据解密失败",key:"decryption"})}if(n){const{value:o,expire:a}=n;if(a===null||a>=Date.now())return o}return S(t),null}return null}function S(t){localStorage.removeItem(t)}function F(){return[()=>$(l)||"",o=>{C(l,o)},()=>{S(l)}]}const N="https://www.fastmock.site/mock/bdd0efa89c5ddba1b003043010702b77/v1",i=[],R=g.CancelToken,w=R.source(),u=g.create({baseURL:N,timeout:180*1e3}),c=(t,e)=>{console.error("错误信息:",t),T.error({content:e||t||"服务器错误",key:"error"})};u.interceptors.request.use(t=>{const[e]=F(),n=e()||"";(t==null?void 0:t.headers)&&n&&(t.headers.Authorization=`Bearer ${n}`);const o=JSON.stringify(t.url)+JSON.stringify(t.data)+"&"+t.method;return i.includes(o)?w.cancel():i.push(o),t},t=>(c(t,"服务器错误"),Promise.reject(t)));u.interceptors.response.use(t=>{const e=t.data,n=JSON.stringify(t.config.url)+JSON.stringify(t.config.data)+"&"+t.config.method,o=i.findIndex(a=>a===n);return i.splice(o,1),(e==null?void 0:e.code)===0?(c(e==null?void 0:e.message,"权限不足，请重新登录"),Promise.reject(t)):(e==null?void 0:e.code)===601||(e==null?void 0:e.code)!==200?(c(e==null?void 0:e.message),Promise.reject(t)):Promise.resolve(t)},t=>(i.length=0,c(t,"服务器错误"),Promise.reject(t)));function rt(t){return`${t}`.replace(/\B(?=(\d{3})+(?!\d))/g,",")}function at(t,e){return Math.floor(Math.random()*(t-e)+e)}function st(t,e){for(let n=0;n<(e==null?void 0:e.length);n++)if(e[n].value===t)return e[n].label;return""}function ct(t,e){var a;if(!t||!e)return"";(t==null?void 0:t[0])==="?"&&(t=t.substring(1,t.length));const n=t.split("&"),o=[];for(let r=0;r<n.length;r++){const s=(a=n[r])==null?void 0:a.split("=");(s==null?void 0:s.length)===2&&o.push([s[0],s[1]])}for(let r=0;r<o.length;r++)if(o[r][0]===e)return o[r][1];return""}function h(t,e){if(t.length===0)return[];const n=[];for(let o=0;o<t.length;o++){const a=t[o],r=e(a),s=a.children?h(a.children,e):void 0;n.push({...r,children:s})}return n}function O(t){return new Promise((e,n)=>{u.get("/authority/common/games",{params:t}).then(o=>{var r;const a=h((r=o==null?void 0:o.data)==null?void 0:r.data,s=>{const{id:f,name:_}=s;return{value:f,label:`${f}:${_}`}});e(a)}).catch(()=>n([]))})}function j(t){return m(P,{children:m(I,{...t,multiple:!0,api:O})})}function x(t){return new Promise((e,n)=>{u.get("/platform/partner",{params:t}).then(o=>{var r;const a=[];(r=o==null?void 0:o.data)==null||r.data.forEach(s=>{a.push({label:s.name,value:s.id})}),e(a)}).catch(()=>n([]))})}function q(t){return m(L,{...t,api:x,mode:"multiple"})}function it(){d("GameSelect",j),d("PartnerSelect",q)}export{et as A,it as C,Q as E,tt as F,Z as I,X as M,b as P,W as S,V as T,rt as a,k as b,K as c,nt as d,at as e,ot as f,ct as g,u as r,F as u,st as v};
