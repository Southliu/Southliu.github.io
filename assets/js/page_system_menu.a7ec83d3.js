import{j as e,r as t}from"./react.a7da97a2.js";import{I as a,S as s,b as n,A as o,d as r}from"./components_Business.8589948e.js";import{M as i,d as l,e as u}from"./components_Dates.a56ec33f.js";import{v as m}from"./components_Count.a83ac5a4.js";import{u as c}from"./page_content_article.556d6fde.js";import{c as p}from"./layouts.f13ff950.js";import{u as d}from"./components_Fullscreen.39c368b5.js";import{U as f,D as g}from"./components_Buttons.9ccf0743.js";import{B as y}from"./components_Content.5d262335.js";import{B as h}from"./components_Search.2a04a2cc.js";import{B as b}from"./components_Modal.c4aa4ca5.js";import{B as j}from"./components_Form.07424d9b.js";import{B as S}from"./components_Table.fb0db54a.js";import{B as x}from"./components_Pagination.2e6acdd5.js";import{u as _}from"./react-i18next.1d91db1a.js";import{m as w}from"./antd.aa967287.js";const C=e=>[{label:e("system.state"),name:"status",component:"Select",componentProps:{options:i}},{label:e("system.module"),name:"module",wrapperCol:170,component:"Select",componentProps:{options:l}},{label:e("system.controller"),name:"controller",component:"Input"}],I=(t,a)=>[{title:"ID",dataIndex:"id",width:200},{title:t("public.name"),dataIndex:"name",width:200},{title:t("system.state"),dataIndex:"status",width:200,render:t=>e.jsx("span",{children:m(t,i)})},{title:t("system.module"),dataIndex:"module",width:200},{title:t("system.controller"),dataIndex:"controller",width:200},{title:t("public.creationTime"),dataIndex:"created_at",width:200},{title:t("public.updateTime"),dataIndex:"updated_at",width:200},{title:t("public.operate"),dataIndex:"operate",width:200,fixed:"right",render:(e,t)=>a(e,t)}],v=(e,t)=>[{label:e("public.name"),name:"name",rules:a(e),component:"Input"},{label:e("system.state"),name:"status",rules:s(e),component:"Select",componentProps:{options:i}},{label:e("system.module"),name:"module",rules:s(e),component:"Select",componentProps:{options:l}},{label:e("system.controller"),name:"controller",rules:a(e),component:"Input"},{label:e("system.createMenu"),name:"actions",hidden:!!t,component:"CheckboxGroup",componentProps:{options:u}}],z=Object.freeze(Object.defineProperty({__proto__:null,createList:v,searchList:C,tableColumns:I},Symbol.toStringTag,{value:"Module"}));function F(e){return n.get("/authority/menu/tree",{params:e})}function P(e){return n.put("/authority/menu/authorize/save",e)}const B={page:1,pageSize:20},$={status:1};const L=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const{t:a}=_();c(a,a("system.menuTitle"));const s=t.useRef(null),i=t.useRef(null),[l,u]=t.useState(!1),[m,z]=t.useState(!1),[F,P]=t.useState(!1),[L,M]=t.useState(o(a)),[N,O]=t.useState(""),[T,k]=t.useState($),[D,R]=t.useState(B.page),[V,A]=t.useState(B.pageSize),[E,G]=t.useState(0),[Q,U]=t.useState([]),[Z,q]=w.useMessage(),{permissions:H}=d(),J="/authority/menu",K={page:p(`${J}/index`,H),create:p(`${J}/create`,H),update:p(`${J}/update`,H),delete:p(`${J}/delete`,H)},W=t.useCallback((async e=>{try{z(!0);const t=await function(e){return n.get("/authority/menu/index",{params:e})}(e),{code:a,data:s}=t;if(200!==Number(a))return;const{items:o,total:r}=s;G(r),U(o)}finally{z(!1)}}),[]);t.useEffect((()=>{K.page&&W({...B}),K.page&&W({...B})}),[W,K.page]);const X=async e=>{try{u(!0),M(r(a,e)),O(e),P(!0);const{code:t,data:s}=await function(e){return n.get(`/authority/menu/${e}`)}(e);if(200!==Number(t))return;k(s)}finally{P(!1)}},Y=()=>{var e;const t={...(null==(e=s.current)?void 0:e.getFieldsValue())||{},page:D,pageSize:V};W(t)},ee=async e=>{try{z(!0);const{code:t,message:s}=await function(e){return n.delete(`/authority/menu/${e}`)}(e);200===Number(t)&&(Z.success(s||a("public.successfullyDeleted")),Y())}finally{z(!1)}},te=t.useCallback(((e,t)=>{var a;R(e),A(t);const n=null==(a=s.current)?void 0:a.getFieldsValue();W({...n,page:e,pageSize:t})}),[W]);return e.jsx(y,{isPermission:K.page,children:e.jsxs(e.Fragment,{children:[q,e.jsx(h,{formRef:s,list:C(a),data:B,isLoading:m,isCreate:K.create,onCreate:()=>{u(!0),M(o(a)),O(""),k($)},handleFinish:e=>{R(1),W({page:1,pageSize:V,...e})}}),e.jsx(S,{loading:m,columns:I(a,((t,a)=>e.jsxs(e.Fragment,{children:[!0===K.update&&e.jsx(f,{className:"mr-5px",isLoading:m,onClick:()=>X(a.id)}),!0===K.delete&&e.jsx(g,{className:"mr-5px",isLoading:m,handleDelete:()=>ee(a.id)})]}))),dataSource:Q}),e.jsx(x,{disabled:m,current:D,pageSize:V,total:E,onChange:te}),e.jsx(b,{width:600,title:L,open:l,confirmLoading:F,onOk:()=>{var e;null==(e=i.current)||e.handleSubmit()},onCancel:()=>{u(!1)},children:e.jsx(j,{formRef:i,list:v(a,N),data:T,labelCol:{span:4},wrapperCol:{span:19},handleFinish:async e=>{try{P(!0);const t=()=>{return N?(t=N,a=e,n.put(`/authority/menu/${t}`,a)):function(e){return n.post("/authority/menu",e)}(e);var t,a},{code:s,message:o}=await t();if(200!==Number(s))return;Z.success(o||a("public.successfulOperation")),u(!1),Y()}finally{P(!1)}}})})]})})}},Symbol.toStringTag,{value:"Module"}));export{F as g,L as i,z as m,P as s};
