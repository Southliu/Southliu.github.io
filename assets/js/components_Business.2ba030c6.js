import{a as d}from"./components_Form.7cb301a2.js";import{j as c}from"./react.ab566f72.js";import{a as f}from"./axios.c63e6c88.js";import{a as T,U as g}from"./crypto-js.35e8c25c.js";import{m as l}from"./antd.48274a52.js";import{A as S,a as _}from"./components_Selects.625a0d22.js";const M="后台管理系统",i="admin_token",G="-",p="__Vite_Admin_Secret__",z="theme_key",I="请输入",k="请选择",Y="responsive",B=[{required:!0,message:I}],H=[{required:!0,message:k}],A="https://www.fastmock.site/mock/bdd0efa89c5ddba1b003043010702b77/v1",K=`${A}/authority/file/upload-file`,Q="新增",V=(e,t)=>`编辑${t??""}${e?`(${e})`:""}`,X={pattern:/^(?=.*\d)(?=.*[a-zA-Z])[\da-zA-Z~!@#$%^&*+\.\_\-*]{6,30}$/,message:"密码为6-30位必须包含字母和数字!"};function y(e,t=p){const n=JSON.stringify(e);return T.encrypt(n,t).toString()}function L(e,t=p){const o=T.decrypt(e,t).toString(g);return o?JSON.parse(o):null}const P=60*60*24*2;function h(e,t,n=P){const o=n!==null?new Date().getTime()+n*1e3:null,E=y({value:t,expire:o});localStorage.setItem(e,E)}function b(e){const t=localStorage.getItem(e);if(t){let n=null;try{n=L(t)}catch{l.error({content:"数据解密失败",key:"decryption"})}if(n){const{value:o,expire:r}=n;if(r===null||r>=Date.now())return o}return m(e),null}return null}function m(e){localStorage.removeItem(e)}function x(){return[()=>b(i)||"",o=>{h(i,o)},()=>{m(i)}]}const U="https://www.fastmock.site/mock/bdd0efa89c5ddba1b003043010702b77/v1",a=[],j=f.CancelToken,C=j.source(),u=f.create({baseURL:U,timeout:180*1e3}),s=(e,t)=>{console.error("错误信息:",e),l.error({content:t||e||"服务器错误",key:"error"})};u.interceptors.request.use(e=>{const[t]=x(),n=t()||"";e!=null&&e.headers&&n&&(e.headers.Authorization=`Bearer ${n}`);const o=JSON.stringify(e.url)+JSON.stringify(e.data)+"&"+e.method;return a.includes(o)?C.cancel():a.push(o),e},e=>(s(e,"服务器错误"),Promise.reject(e)));u.interceptors.response.use(e=>{const t=e.data,n=JSON.stringify(e.config.url)+JSON.stringify(e.config.data)+"&"+e.config.method,o=a.findIndex(r=>r===n);return a.splice(o,1),(t==null?void 0:t.code)===0?(s(t==null?void 0:t.message,"权限不足，请重新登录"),Promise.reject(t)):(t==null?void 0:t.code)===401?(l.error("权限不足，请重新登录！"),m(i),setTimeout(()=>{window.location.href="/"},1e3),s(t==null?void 0:t.message),Promise.reject(t)):(t==null?void 0:t.code)!==200?(s(t==null?void 0:t.message),Promise.reject(t)):Promise.resolve(t)},e=>(a.length=0,s(e,"服务器错误"),Promise.reject(e)));function N(e){return u.get("/authority/common/games",{params:e})}function R(e){return c.jsx(c.Fragment,{children:c.jsx(S,{...e,multiple:!0,api:N,fieldNames:{label:"name",value:"id"}})})}function v(e){return u.get("/platform/partner",{params:e})}function w(e){return c.jsx(_,{...e,api:v,mode:"multiple",fieldNames:{label:"name",value:"id"}})}function Z(){d("GameSelect",R),d("PartnerSelect",w)}export{Q as A,Z as C,G as E,K as F,B as I,Y as M,I as P,H as S,z as T,k as a,M as b,V as c,X as d,u as r,x as u};
