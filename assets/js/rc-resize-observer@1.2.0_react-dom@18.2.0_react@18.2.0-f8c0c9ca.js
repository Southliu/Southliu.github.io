import{r as i}from"./react@18.2.0-9cdefec6.js";import{s as S,f as j,A as k,t as A}from"./rc-util@5.24.4_react-dom@18.2.0_react@18.2.0-c033d194.js";import{f as D,g as L,h as $,i as F,a as H}from"./@babel_runtime@7.19.0-16d3a89d.js";import{i as K}from"./resize-observer-polyfill@1.5.1-1e2b0dc8.js";import{j as M}from"./@ant-design_icons@4.7.0_react-dom@18.2.0_react@18.2.0-0d73ff6d.js";var c=new Map;function T(e){e.forEach(function(n){var r,t=n.target;(r=c.get(t))===null||r===void 0||r.forEach(function(o){return o(t)})})}var I=new K(T);function V(e,n){c.has(e)||(c.set(e,new Set),I.observe(e)),c.get(e).add(n)}function X(e,n){c.has(e)&&(c.get(e).delete(n),c.get(e).size||(I.unobserve(e),c.delete(e)))}var Y=function(e){D(r,e);var n=L(r);function r(){return $(this,r),n.apply(this,arguments)}return F(r,[{key:"render",value:function(){return this.props.children}}]),r}(i.Component),m=i.createContext(null);function q(e){var n=e.children,r=e.onBatchResize,t=i.useRef(0),o=i.useRef([]),a=i.useContext(m),l=i.useCallback(function(f,u,v){t.current+=1;var d=t.current;o.current.push({size:f,element:u,data:v}),Promise.resolve().then(function(){d===t.current&&(r==null||r(o.current),o.current=[])}),a==null||a(f,u,v)},[r,a]);return M(m.Provider,{value:l,children:n})}function G(e){var n=e.children,r=e.disabled,t=i.useRef(null),o=i.useRef(null),a=i.useContext(m),l=typeof n=="function",f=l?n(t):n,u=i.useRef({width:-1,height:-1,offsetWidth:-1,offsetHeight:-1}),v=!l&&i.isValidElement(f)&&S(f),d=v?f.ref:null,P=i.useMemo(function(){return j(d,t)},[d,t]),C=i.useRef(e);C.current=e;var b=i.useCallback(function(s){var z=C.current,E=z.onResize,B=z.data,x=s.getBoundingClientRect(),g=x.width,p=x.height,h=s.offsetWidth,R=s.offsetHeight,_=Math.floor(g),w=Math.floor(p);if(u.current.width!==_||u.current.height!==w||u.current.offsetWidth!==h||u.current.offsetHeight!==R){var y={width:_,height:w,offsetWidth:h,offsetHeight:R};u.current=y;var N=h===Math.round(g)?g:h,O=R===Math.round(p)?p:R,W=H(H({},y),{},{offsetWidth:N,offsetHeight:O});a==null||a(W,s,B),E&&Promise.resolve().then(function(){E(W,s)})}},[]);return i.useEffect(function(){var s=k(t.current)||k(o.current);return s&&!r&&V(s,b),function(){return X(s,b)}},[t.current,r]),M(Y,{ref:o,children:v?i.cloneElement(f,{ref:P}):f})}var J="rc-observer-key";function Q(e){var n=e.children,r=typeof n=="function"?[n]:A(n);return r.map(function(t,o){var a=(t==null?void 0:t.key)||"".concat(J,"-").concat(o);return i.createElement(G,{...e,key:a},t)})}Q.Collection=q;export{Q as R};
