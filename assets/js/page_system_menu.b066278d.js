import{j as s,r as n}from"./react.76efb1e3.js";import{I as B,S as M,c as l,A as $,e as se}from"./components_Business.a1f9c3ad.js";import{M as I,d as R,e as oe}from"./components_Dates.361b09a8.js";import{v as re}from"./components_Count.0fccd205.js";import{u as ie}from"./page_content_article.60d55226.js";import{c as x}from"./layouts.43869c63.js";import{u as ce}from"./components_Fullscreen.5db0d3c8.js";import{U as le,D as ue}from"./components_Buttons.45a932db.js";import{B as me}from"./components_Content.c71bf899.js";import{B as de}from"./components_Search.4b6e031b.js";import{B as pe}from"./components_Modal.5ee02306.js";import{B as fe}from"./components_Form.8f581885.js";import{B as ge}from"./components_Table.7421b869.js";import{B as he}from"./components_Pagination.29811a9b.js";import{m as Se}from"./antd.469ebff6.js";const N=[{label:"状态",name:"status",component:"Select",componentProps:{options:I}},{label:"模块",name:"module",wrapperCol:170,component:"Select",componentProps:{options:R}},{label:"控制器",name:"controller",component:"Input"}],U=e=>[{title:"ID",dataIndex:"id",width:200},{title:"名称",dataIndex:"name",width:200},{title:"状态",dataIndex:"status",width:200,render:r=>s.jsx("span",{children:re(r,I)})},{title:"模块",dataIndex:"module",width:200},{title:"控制器",dataIndex:"controller",width:200},{title:"创建时间",dataIndex:"created_at",width:200},{title:"更新时间",dataIndex:"updated_at",width:200},{title:"操作",dataIndex:"operate",width:200,fixed:"right",render:(r,b)=>e(r,b)}],F=e=>[{label:"名称",name:"name",rules:B,component:"Input"},{label:"状态",name:"status",rules:M,component:"Select",componentProps:{options:I}},{label:"模块",name:"module",rules:M,component:"Select",componentProps:{options:R}},{label:"控制器",name:"controller",rules:B,component:"Input"},{label:"创建菜单",name:"actions",hidden:!!e,component:"CheckboxGroup",componentProps:{options:oe}}],ze=Object.freeze(Object.defineProperty({__proto__:null,createList:F,searchList:N,tableColumns:U},Symbol.toStringTag,{value:"Module"}));function xe(e){return l.get("/authority/menu/index",{params:e})}function be(e){return l.get(`/authority/menu/${e}`)}function Ce(e){return l.post("/authority/menu",e)}function ye(e,r){return l.put(`/authority/menu/${e}`,r)}function Ie(e){return l.delete(`/authority/menu/${e}`)}function ke(e){return l.get("/authority/menu/tree",{params:e})}function ve(e){return l.put("/authority/menu/authorize/save",e)}const d={page:1,pageSize:20},L={status:1};function Pe(){ie("菜单管理");const e=n.useRef(null),r=n.useRef(null),[b,p]=n.useState(!1),[m,f]=n.useState(!1),[O,g]=n.useState(!1),[z,P]=n.useState($),[C,T]=n.useState(""),[k,D]=n.useState(L),[_,j]=n.useState(d.page),[y,v]=n.useState(d.pageSize),[A,Q]=n.useState(0),[V,q]=n.useState([]),[E,G]=Se.useMessage(),{permissions:h}=ce(),S="/authority/menu",i={page:x(`${S}/index`,h),create:x(`${S}/create`,h),update:x(`${S}/update`,h),delete:x(`${S}/delete`,h)},H=t=>{j(1),c({page:1,pageSize:y,...t})},c=n.useCallback(async t=>{try{f(!0);const a=await xe(t),{code:o,data:u}=a;if(Number(o)!==200)return;const{items:ae,total:ne}=u;Q(ne),q(ae)}finally{f(!1)}},[]);n.useEffect(()=>{i.page&&c({...d}),i.page&&c({...d})},[c,i.page]);const J=()=>{p(!0),P($),T(""),D(L)},K=async t=>{try{p(!0),P(se(t)),T(t),g(!0);const{code:a,data:o}=await be(t);if(Number(a)!==200)return;D(o)}finally{g(!1)}},W=()=>{var t;(t=r.current)==null||t.handleSubmit()},X=()=>{p(!1)},w=()=>{var o;const a={...((o=e.current)==null?void 0:o.getFieldsValue())||{},page:_,pageSize:y};c(a)},Y=async t=>{try{g(!0);const a=()=>C?ye(C,t):Ce(t),{code:o,message:u}=await a();if(Number(o)!==200)return;E.success(u||"操作成功"),p(!1),w()}finally{g(!1)}},Z=async t=>{try{f(!0);const{code:a,message:o}=await Ie(t);Number(a)===200&&(E.success(o||"删除成功"),w())}finally{f(!1)}},ee=n.useCallback((t,a)=>{var u;j(t),v(a);const o=(u=e.current)==null?void 0:u.getFieldsValue();c({...o,page:t,pageSize:a})},[c]),te=(t,a)=>s.jsxs(s.Fragment,{children:[i.update===!0&&s.jsx(le,{className:"mr-5px",isLoading:m,onClick:()=>K(a.id)}),i.delete===!0&&s.jsx(ue,{className:"mr-5px",isLoading:m,handleDelete:()=>Z(a.id)})]});return s.jsx(me,{isPermission:i.page,children:s.jsxs(s.Fragment,{children:[G,s.jsx(de,{formRef:e,list:N,data:d,isLoading:m,isCreate:i.create,onCreate:J,handleFinish:H}),s.jsx(ge,{loading:m,columns:U(te),dataSource:V}),s.jsx(he,{disabled:m,current:_,pageSize:y,total:A,onChange:ee}),s.jsx(pe,{width:600,title:z,open:b,confirmLoading:O,onOk:W,onCancel:X,children:s.jsx(fe,{formRef:r,list:F(C),data:k,labelCol:{span:4},wrapperCol:{span:19},handleFinish:Y})})]})})}const Ae=Object.freeze(Object.defineProperty({__proto__:null,default:Pe},Symbol.toStringTag,{value:"Module"}));export{ke as g,Ae as i,ze as m,ve as s};
