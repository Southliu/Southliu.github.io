import{r as e,j as s}from"./react.a7da97a2.js";import{g as n,a as t,s as a,r as o,b as r,P as i}from"./components_Business.13a3a6ce.js";import{a as l,u as c}from"./react-redux.5cd65198.js";import{c as u}from"./@reduxjs_toolkit.fb91ade4.js";import{g as m,s as d,a as p,f as h,h as f,d as x,b as j,c as v,t as g,e as b,i as y,j as N,k as C,G as k,l as w,m as A,n as O,o as X,p as E,q as I,r as M,u as B,v as P}from"./components_GlobalSearch.b83cc5c8.js";import{u as T,F as S,a as W}from"./components_Fullscreen.805c0516.js";import{u as z}from"./ahooks.93e76957.js";import{I as K}from"./@iconify_react.bcaf6c88.js";import{u as R,a as H,b as D}from"./react-router.31c22429.js";import{u as V}from"./react-i18next.1d91db1a.js";import"./hoist-non-react-statics.b23c5de2.js";import"./react-is.90ab392a.js";import{n as U,F as L,m as q,I as F,o as J,A as Q,h as _,T as G,p as Y,j as Z}from"./antd.850acb68.js";import{r as $,K as ee}from"./react-activation.cb49eacd.js";import{D as se}from"./components_DataScreen.fea772d1.js";import{G as ne}from"./components_Github.94c2d482.js";import{I as te}from"./components_I18n.2d360d2f.js";import{T as ae}from"./components_Theme.74d4d90f.js";import{B as oe}from"./components_Modal.ba600df6.js";import{P as re}from"./components_PasswordStrength.6ba396bd.js";import{K as ie,N as le,O as ce,T as ue,B as me,V as de,W as pe,X as he,Y as fe}from"./@ant-design_icons.7fe075eb.js";import xe from"./page_403.tsx_index.94ca2dc8.js";function je(){return[()=>n(t)||"",e=>{a(t,e)},()=>{o(t)}]}function ve(e){return r.get("/authority/user/refresh-permissions",{params:e})}const ge=e=>{const s=[];for(let n=0;n<e.length;n++){const{id:t,operation:a}=e[n];s.push(`/${t}`);for(let e=0;e<a.length;e++)s.push(`/${t}/${a[e]}`)}return s},be=(e,s)=>!(!s||0===s.length)&&s.includes(e),ye=u({name:"user",initialState:{permissions:[],userInfo:{id:0,username:"",email:"",phone:""}},reducers:{setUserInfo:(e,s)=>{e.userInfo=s.payload},setPermissions:(e,s)=>{e.permissions=s.payload},clearInfo:e=>{e.userInfo={id:0,username:"",email:"",phone:""}}}}),{setUserInfo:Ne,setPermissions:Ce,clearInfo:ke}=ye.actions,we=ye.reducer,Ae={header:"_header_7p2mx_1",headerCloseMenu:"_headerCloseMenu_7p2mx_14",headerDriver:"_headerDriver_7p2mx_17",menu:"_menu_7p2mx_20",menuClose:"_menuClose_7p2mx_28",con:"_con_7p2mx_31",conCloseMenu:"_conCloseMenu_7p2mx_41",conMaximize:"_conMaximize_7p2mx_45",headerNone:"_headerNone_7p2mx_50",none:"_none_7p2mx_54",menuNone:"_menuNone_7p2mx_57",conPhone:"_conPhone_7p2mx_61",headerPhone:"_headerPhone_7p2mx_64",leftDivide:"_leftDivide_7p2mx_67"},Oe="/assets/svg/logo.17e50649.svg";function Xe(){const n=R(),{t:t,i18n:a}=V(),{pathname:o}=H(),r=l(),[i,c]=e.useState([]),u=a.language,{isMaximize:k,isCollapsed:w,isPhone:A,openKeys:O,selectedKeys:X,permissions:E}=T();e.useEffect((()=>{const e=m(o);A||w||(r(d(e)),r(p(o)))}),[o]);const I=e.useCallback((e=>{var n,t,a;for(let o=0;o<e.length;o++)(null==(n=e[o])?void 0:n.icon)&&(e[o].icon=s.jsx(K,{icon:e[o].icon})),(null==(a=null==(t=e[o])?void 0:t.children)?void 0:a.length)&&I(e[o].children)}),[]);e.useEffect((()=>{if(E.length>0){const e=h(x,E);I(e),c(e||[])}}),[I,E,u]);const M=e=>{n(e);const s=b({menus:i,permissions:E,key:e});s&&(r(y(s.key)),r(N(s.nav)),r(C(s)))},B=(e,s)=>{let n=!0;for(let t=0;t<e.length;t++)if(e[t]!==s[t]){n=!1;break}return n},P=()=>{r(g(!0))};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:`\n          transition-all\n          overflow-auto\n          z-2\n          ${Ae.menu}\n          ${w?Ae.menuClose:""}\n          ${k||A&&w?Ae.menuNone:""}\n          ${A?"!z-1002":""}\n        `,children:[s.jsxs("div",{className:`\n            text-white\n            flex\n            content-center\n            px-5\n            py-2\n            cursor-pointer\n            ${w?"justify-center":""}\n          `,onClick:()=>{const e=v(i,E);M(e),A&&P()},children:[s.jsx("img",{src:Oe,width:30,height:30,className:"object-contain",alt:"logo"}),s.jsx("span",{className:`\n            text-white\n            ml-3\n            text-xl\n            font-bold\n            truncate\n            ${w?"hidden":""}\n          `,children:t("public.currentName")})]}),s.jsx(U,{className:"z-1000",selectedKeys:[X],openKeys:O,mode:"inline",theme:"dark",inlineCollapsed:w,items:f(i),onClick:e=>{M(e.key),A&&P()},onOpenChange:e=>{const s=[];let n="";if(e.length>0){n=e[e.length-1];const t=j(n);s.push(n);for(let n=e.length-2;n>=0;n--){const a=j(e[n]);B(a,t)&&s.unshift(e[n])}}r(d(s))}})]}),A&&!w&&s.jsx("div",{className:`\n            ${Ae.cover}\n            fixed\n            w-full\n            h-full\n            bg-gray-500\n            bg-opacity-10\n            z-1001\n          `,onClick:P})]})}const Ee="data:image/png;base64,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";function Ie(e){return r.post("/login",e)}function Me(n){const{passwordRef:t}=n,{t:a}=V(),[o]=L.useForm(),[l,c]=q.useMessage(),[u,m]=e.useState(!1),[d,p]=e.useState(!1);e.useImperativeHandle(t,(()=>({open:()=>{m(!0)}})));return s.jsxs(s.Fragment,{children:[c,s.jsx(oe,{title:a("public.changePassword"),open:u,confirmLoading:d,onOk:()=>{o.submit()},onCancel:()=>m(!1),children:s.jsxs(L,{name:"UpdatePassword",form:o,labelCol:{span:5},wrapperCol:{span:16},onFinish:async e=>{if(e.password!==e.confirmPassword)return l.warning({content:a("login.confirmPasswordMessage"),key:"confirmPassword"});try{p(!0);const{code:n,message:t}=await(s=e,r.post("/update-password",s));200===Number(n)&&(m(!1),l.success(t))}finally{p(!1)}var s},autoComplete:"off",children:[s.jsx(L.Item,{label:a("login.username"),name:"username",rules:[{required:!0,message:a("public.pleaseEnter",{name:a("login.username")})}],children:s.jsx(F,{placeholder:a("public.inputPleaseEnter")})}),s.jsx(L.Item,{label:a("login.password"),name:"password",rules:[{required:!0,message:a("public.pleaseEnter",{name:a("login.password")})},i(a)],children:s.jsx(re,{})}),s.jsx(L.Item,{label:a("login.confirmPassword"),name:"confirmPassword",rules:[{required:!0,message:a("public.pleaseEnter",{name:a("login.confirmPassword")})},i(a)],children:s.jsx(re,{})})]})})]})}function Be(e){const{className:n,list:t}=e,{i18n:a}=V(),{isPhone:o}=T();return s.jsx(s.Fragment,{children:!o&&s.jsx("div",{className:`${n} flex items-center`,children:s.jsx(J,{items:(e=>{const s=[];if(!(null==e?void 0:e.length))return[];const n=a.language;for(let t=0;t<(null==e?void 0:e.length);t++){const a=null==e?void 0:e[t],o="en"===n?a.labelEn:a.labelZh;s.push({title:o||""})}return s})(t)})})})}function Pe(){const[,,n]=je(),{t:t}=V(),{clear:a}=$.useAliveController(),{modal:o}=Q.useApp(),{isCollapsed:r,isMaximize:i,username:c,nav:u}=T(),m=e.useRef(null),d=l(),p=R(),h=[{key:"password",label:s.jsx("span",{children:t("public.changePassword")}),icon:s.jsx(ie,{className:"mr-1"})},{key:"logout",label:s.jsx("span",{children:t("public.signOut")}),icon:s.jsx(le,{className:"mr-1"})}],f=e=>{var s;switch(e.key){case"password":null==(s=m.current)||s.open();break;case"logout":x()}},x=()=>{o.confirm({title:t("public.kindTips"),icon:s.jsx(me,{}),content:t("public.signOutMessage"),onOk(){d(ke()),d(w()),d(y("")),n(),a(),p("/login")}})},j=()=>s.jsxs("div",{className:"flex items-center",children:[s.jsx(ne,{}),s.jsx(se,{}),s.jsx(k,{}),s.jsx(S,{}),s.jsx(te,{}),s.jsx(ae,{}),s.jsx(_,{className:"min-w-50px",menu:{items:h,onClick:f},children:s.jsxs("div",{className:"ant-dropdown-link flex items-center cursor-pointer",onClick:e=>e.preventDefault(),children:[s.jsx("img",{src:Ee,width:27,height:27,alt:"Avatar",className:"rounded-1/2 overflow-hidden object-cover bg-light-500"}),s.jsx("span",{className:"ml-2 text-15px min-w-50px truncate",children:c||"south-admin"})]})})]}),v=()=>s.jsxs("div",{className:"text-lg cursor-pointer",onClick:()=>d(g(!r)),children:[r&&s.jsx(ce,{}),!r&&s.jsx(ue,{})]});return s.jsxs(s.Fragment,{children:[s.jsxs("header",{className:`\n          border-bottom\n          flex\n          items-center\n          justify-between\n          px-6\n          py-6px\n          box-border\n          transition-all\n          ${Ae.headerDriver}\n          ${i?Ae.none:""}\n        `,children:[s.jsxs("div",{className:"flex item-center",children:[s.jsx(v,{}),s.jsx(Be,{className:"ml-15px",list:u})]}),s.jsx(j,{})]}),s.jsx(Me,{passwordRef:m})]})}function Te(e){const{t:n}=V(),{activeKey:t,onOpenChange:a,handleRefresh:o}=e,{pathname:r}=H(),{tabs:i,permissions:c}=T(),u=R(),m=l();return[(e=t)=>{const a=i.findIndex((s=>s.key===e));return[{key:"refresh",label:n("public.reload"),disabled:e!==r,icon:s.jsx(de,{className:"mr-5px transform rotate-270"})},{key:"close_current",label:n("public.closeTab"),disabled:i.length<=1,icon:s.jsx(pe,{className:"mr-5px"})},{key:"close_other",label:n("public.closeOther"),disabled:i.length<=1,icon:s.jsx(he,{className:"mr-5px transform rotate-90"})},{key:"close_left",label:n("public.closeLeft"),disabled:0===a,icon:s.jsx(fe,{className:"mr-5px transform rotate-270"})},{key:"close_right",label:n("public.closeRight"),disabled:a===i.length-1,icon:s.jsx(fe,{className:"mr-5px transform rotate-90"})}]},(e,s=t)=>{switch(null==a||a(!1),e){case"refresh":o(s);break;case"close_current":m(E(s));break;case"close_other":m(X(s));break;case"close_left":if(m(O(s)),r!==s){const e=b({menus:x,permissions:c,key:s});(null==e?void 0:e.key)&&(u(s),m(N(e.nav)))}break;case"close_right":if(m(A(s)),r!==s){const e=b({menus:x,permissions:c,key:s});(null==e?void 0:e.key)&&(u(s),m(N(e.nav)))}}}]}function Se(e){const{t:n}=V(),{isRefresh:t,onClick:a}=e;return s.jsx(G,{title:n("public.reload"),placement:"bottom",children:s.jsx(K,{className:`\n          change\n          flex\n          items-center\n          justify-center\n          text-lg\n          cursor-pointer\n          ${t?"animate-spin pointer-events-none":""}\n        `,onClick:()=>a(),icon:"ant-design:reload-outlined"})})}function We(){const e=l(),{isMaximize:n}=T();return s.jsx(K,{className:"\n        flex\n        items-center\n        justify-center\n        text-lg\n        cursor-pointer\n      ",icon:n?"ant-design:compress-outlined":"ant-design:expand-outlined",onClick:()=>{e(I(!n))}})}function ze(n){const{activeKey:t,handleRefresh:a}=n,[o,r]=e.useState(!1),i=e=>{r(e)},l={activeKey:t,onOpenChange:i,handleRefresh:a},[c,u]=Te(l);return s.jsx(_,{trigger:["click"],menu:{items:c(),onClick:e=>u(e.key)},onOpenChange:i,children:s.jsx(K,{className:`\n          flex\n          items-center\n          justify-center\n          text-lg\n          cursor-pointer\n          transition-all\n          transform\n          ${o?"rotate-180":"rotate-0"}\n        `,icon:"ant-design:down-outlined"})})}function Ke(){const{t:n,i18n:t}=V(),a=R(),{pathname:o,search:r}=H(),i=o+r,u=l(),{refresh:m}=$.useAliveController(),[d,p]=q.useMessage(),[h,f]=e.useState(null),[j,v]=e.useState(null),g=c((e=>e.tabs.isLock)),k=c((e=>e.tabs.activeKey)),w=t.language,{tabs:A,permissions:O,isMaximize:X}=T(),I=e.useCallback(((e=i)=>{if(O.length>0){if("/"===e)return;const s=b({menus:x,permissions:O,key:e});(null==s?void 0:s.key)?(u(y(s.key)),u(N(s.nav)),u(C(s))):u(y(e))}}),[O]);e.useEffect((()=>{I()}),[I]),e.useEffect((()=>{u(M(w))}),[w,A]),e.useEffect((()=>()=>{h&&(clearTimeout(h),f(null)),j&&(clearTimeout(j),v(null))}),[]),e.useEffect((()=>{if(k!==i){const e=g?k:i;I(e),g&&(a(e),u(B(!1)))}}),[k,i]);const P=e.useCallback(((e=k)=>{"string"==typeof e&&(h||(u(W(!0)),m(e),f(setTimeout((()=>{d.success({content:n("public.refreshSuccessfully"),key:"refresh"}),u(W(!1)),f(null)}),100)),v(setTimeout((()=>{v(null)}),1e3))))}),[k,h]),S=[{element:e.useMemo((()=>s.jsx(Se,{isRefresh:!!j,onClick:P})),[j,P])},{element:e.useMemo((()=>s.jsx(ze,{activeKey:k,handleRefresh:P})),[k,P])},{element:e.useMemo((()=>s.jsx(We,{})),[])}],z={activeKey:k,handleRefresh:P},[K,D]=Te(z);return s.jsxs("div",{className:`\n      flex\n      items-center\n      justify-between\n      mx-2\n      transition-all\n      ${X?Ae.conMaximize:""}\n    `,children:[p,A.length>0?s.jsx(Y,{hideAdd:!0,className:"w-full h-30px py-0",onChange:e=>{a(e)},activeKey:k,type:"editable-card",onEdit:(e,s)=>{"remove"===s&&(e=>{u(E(e))})(e)},items:A,renderTabBar:(e,n)=>s.jsx(n,{...e,children:e=>s.jsx(_,{menu:{items:K(e.key),onClick:s=>D(s.key,e.key)},trigger:["contextMenu"],children:s.jsx("div",{className:"mr-3px",children:e})},e.key)})}):s.jsx("span",{}),s.jsx("div",{className:"flex",children:null==S?void 0:S.map(((e,n)=>s.jsx("div",{className:`\n                ${Ae.leftDivide}\n                change\n                divide-solid\n                w-36px\n                h-36px\n                hover:opacity-70\n                flex\n                place-content-center\n                items-center\n              `,children:e.element},n)))})]})}function Re(){const n=l(),t=R(),[a]=je(),{pathname:o,search:r}=H(),i=o+r,c=a(),u=D(),[m,d]=e.useState(!0),{permissions:p,userId:h,isMaximize:f,isCollapsed:x,isPhone:j,isRefresh:v}=T(),b=e.useCallback((async()=>{try{d(!0);const{code:e,data:s}=await ve({refresh_cache:!1});if(200!==Number(e))return;const{user:t,permissions:a}=s,o=ge(a);n(Ne(t)),n(Ce(o))}catch(e){Ce([])}finally{d(!1)}}),[]);e.useEffect((()=>{c||t("/login"),c&&!h&&b()}),[b,t,c,h]);const y=z((()=>{const e=window.innerWidth<=768;e&&n(g(!0)),n(P(e))}),{wait:500});return e.useEffect((()=>(window.addEventListener("resize",y.run()),()=>{window.removeEventListener("resize",y.run())})),[]),s.jsxs("div",{id:"layout",children:[s.jsx(Xe,{}),s.jsxs("div",{className:Ae.layout_right,children:[s.jsxs("div",{id:"header",className:`\n            border-bottom\n            transition-all\n            ${Ae.header}\n            ${x?Ae.headerCloseMenu:""}\n            ${f?Ae.headerNone:""}\n            ${j?"!left-0 z-999":""}\n          `,children:[s.jsx(Pe,{}),s.jsx(Ke,{})]}),s.jsxs("div",{id:"layoutContent",className:`\n            overflow-auto\n            transition-all\n            ${Ae.con}\n            ${f?Ae.conMaximize:""}\n            ${x?Ae.conCloseMenu:""}\n            ${j?"!left-0 !w-full":""}\n          `,children:[m&&0===p.length&&s.jsx(Z,{active:!0,className:"p-30px",paragraph:{rows:10}}),!m&&0===p.length&&s.jsx(xe,{}),v&&s.jsx("div",{className:"\n              absolute\n              left-50%\n              top-50%\n              -rotate-x-50%\n              -rotate-y-50%\n            ",children:s.jsx(K,{className:"text-40px animate-spin",icon:"ri:loader-2-fill"})}),p.length>0&&!v&&s.jsx(ee,{id:i,name:i,children:u})]})]})]})}export{Oe as L,Ce as a,Re as b,be as c,we as d,ve as g,Ie as l,ge as p,Ne as s,je as u};
