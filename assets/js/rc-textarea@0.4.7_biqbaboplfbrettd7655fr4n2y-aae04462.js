import{g as te,c as z,d as ae,e as H,h as j,f as re,i as ne,j as ie,a as oe,_ as se}from"./@babel_runtime@7.20.6-cff7d31a.js";import{r as d}from"./react@18.2.0-02d2f290.js";import{R as le}from"./rc-resize-observer@1.2.0_biqbaboplfbrettd7655fr4n2y-5604fb46.js";import{h as ue,b as N,f as $}from"./rc-util@5.25.2_biqbaboplfbrettd7655fr4n2y-e289da57.js";import{c as de}from"./classnames@2.3.2-96a48171.js";var fe=`
  min-height:0 !important;
  max-height:none !important;
  height:0 !important;
  visibility:hidden !important;
  overflow:hidden !important;
  position:absolute !important;
  z-index:-1000 !important;
  top:0 !important;
  right:0 !important;
  pointer-events: none !important;
`,ce=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","font-variant","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing","word-break"],w={},u;function ve(t){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=t.getAttribute("id")||t.getAttribute("data-reactid")||t.getAttribute("name");if(g&&w[n])return w[n];var a=window.getComputedStyle(t),e=a.getPropertyValue("box-sizing")||a.getPropertyValue("-moz-box-sizing")||a.getPropertyValue("-webkit-box-sizing"),s=parseFloat(a.getPropertyValue("padding-bottom"))+parseFloat(a.getPropertyValue("padding-top")),r=parseFloat(a.getPropertyValue("border-bottom-width"))+parseFloat(a.getPropertyValue("border-top-width")),i=ce.map(function(o){return"".concat(o,":").concat(a.getPropertyValue(o))}).join(";"),v={sizingStyle:i,paddingSize:s,borderSize:r,boxSizing:e};return g&&n&&(w[n]=v),v}function ge(t){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;u||(u=document.createElement("textarea"),u.setAttribute("tab-index","-1"),u.setAttribute("aria-hidden","true"),document.body.appendChild(u)),t.getAttribute("wrap")?u.setAttribute("wrap",t.getAttribute("wrap")):u.removeAttribute("wrap");var e=ve(t,g),s=e.paddingSize,r=e.borderSize,i=e.boxSizing,v=e.sizingStyle;u.setAttribute("style","".concat(v,";").concat(fe)),u.value=t.value||t.placeholder||"";var o=void 0,f=void 0,p,c=u.scrollHeight;if(i==="border-box"?c+=r:i==="content-box"&&(c-=s),n!==null||a!==null){u.value=" ";var x=u.scrollHeight-s;n!==null&&(o=x*n,i==="border-box"&&(o=o+s+r),c=Math.max(o,c)),a!==null&&(f=x*a,i==="border-box"&&(f=f+s+r),p=c>f?"":"hidden",c=Math.min(f,c))}var S={height:c,overflowY:p,resize:"none"};return o&&(S.minHeight=o),f&&(S.maxHeight=f),S}var me=["prefixCls","onPressEnter","defaultValue","value","autoSize","onResize","className","style","disabled","onChange","onInternalAutoSize"],_=0,C=1,E=2,he=d.exports.forwardRef(function(t,g){var n=t.prefixCls,a=n===void 0?"rc-textarea":n;t.onPressEnter;var e=t.defaultValue,s=t.value,r=t.autoSize,i=t.onResize,v=t.className,o=t.style,f=t.disabled,p=t.onChange;t.onInternalAutoSize;var c=te(t,me),x=ue(e,{value:s,postState:function(l){return l??""}}),S=z(x,2),K=S[0],Y=S[1],L=function(l){Y(l.target.value),p==null||p(l)},m=d.exports.useRef();d.exports.useImperativeHandle(g,function(){return{textArea:m.current}});var Z=d.exports.useMemo(function(){return r&&ae(r)==="object"?[r.minRows,r.maxRows]:[]},[r]),T=z(Z,2),V=T[0],P=T[1],y=!!r,G=function(){try{if(document.activeElement===m.current){var l=m.current,J=l.selectionStart,Q=l.selectionEnd,ee=l.scrollTop;m.current.setSelectionRange(J,Q),m.current.scrollTop=ee}}catch{}},X=d.exports.useState(E),I=z(X,2),b=I[0],R=I[1],B=d.exports.useState(),M=z(B,2),O=M[0],U=M[1],D=function(){R(_)};N(function(){y&&D()},[s,V,P,y]),N(function(){if(b===_)R(C);else if(b===C){var h=ge(m.current,!1,V,P);R(E),U(h)}else G()},[b]);var k=d.exports.useRef(),F=function(){$.cancel(k.current)},W=function(l){b===E&&(i==null||i(l),r&&(F(),k.current=$(function(){D()})))};d.exports.useEffect(function(){return F},[]);var q=y?O:null,A=H(H({},o),q);return(b===_||b===C)&&(A.overflowY="hidden",A.overflowX="hidden"),d.exports.createElement(le,{onResize:W,disabled:!(r||i)},d.exports.createElement("textarea",j({},c,{ref:m,style:A,className:de(a,v,re({},"".concat(a,"-disabled"),f)),disabled:f,value:K,onChange:L})))}),Re=function(t){ne(n,t);var g=ie(n);function n(a){var e;oe(this,n),e=g.call(this,a),e.resizableTextArea=void 0,e.focus=function(){e.resizableTextArea.textArea.focus()},e.saveTextArea=function(r){e.resizableTextArea=r},e.handleChange=function(r){var i=e.props.onChange;e.setValue(r.target.value),i&&i(r)},e.handleKeyDown=function(r){var i=e.props,v=i.onPressEnter,o=i.onKeyDown;r.keyCode===13&&v&&v(r),o&&o(r)};var s=typeof a.value>"u"||a.value===null?a.defaultValue:a.value;return e.state={value:s},e}return se(n,[{key:"setValue",value:function(e,s){"value"in this.props||this.setState({value:e},s)}},{key:"blur",value:function(){this.resizableTextArea.textArea.blur()}},{key:"render",value:function(){return d.exports.createElement(he,j({},this.props,{value:this.state.value,onKeyDown:this.handleKeyDown,onChange:this.handleChange,ref:this.saveTextArea}))}}],[{key:"getDerivedStateFromProps",value:function(e){return"value"in e?{value:e.value}:null}}]),n}(d.exports.Component);export{Re as T};
