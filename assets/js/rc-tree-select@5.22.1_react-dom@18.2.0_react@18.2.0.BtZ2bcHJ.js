import{x as e,b as t,o as n,K as r,B as a}from"./rc-util@5.43.0_react-dom@18.2.0_react@18.2.0.lgqfUkNr.js";import{g as o,i as l,k as i,d as u,h as c,j as d,f as s}from"./@babel_runtime@7.25.4.Bu2As08a.js";import{u as f,b as v,B as p}from"./rc-select@14.15.1_react-dom@18.2.0_react@18.2.0.BgntlP8c.js";import{r as h}from"./react@18.2.0.CwGjMYfB.js";import{a as m,c as y,T as g}from"./rc-tree@5.8.8_react-dom@18.2.0_react@18.2.0.532m7e14.js";import"./classnames@2.5.1.CxW7iW8f.js";import"./rc-overflow@1.3.2_react-dom@18.2.0_react@18.2.0.BaM6CLPj.js";import"./react-dom@18.2.0_react@18.2.0.BN8LbORn.js";import"./rc-resize-observer@1.4.0_react-dom@18.2.0_react@18.2.0.Cnr_3ciu.js";import"./rc-motion@2.9.2_react-dom@18.2.0_react@18.2.0.UbceZs2i.js";function b(e){return!e||e.disabled||e.disableCheckbox||!1===e.checkable}function k(e){return null==e}var C=function(){return null},S=["children","value"];function E(t){return e(t).map((function(e){if(!h.isValidElement(e)||!e.type)return null;var t=e,n=t.key,r=t.props,a=r.children,l=r.value,u=i(r,S),c=o({key:n,value:l},u),d=E(a);return d.length&&(c.children=d),c})).filter((function(e){return e}))}function w(e){if(!e)return e;var n=o({},e);return"props"in n||Object.defineProperty(n,"props",{get:function(){return t(!1,"New `rc-tree-select` not support return node instance as argument anymore. Please consider to remove `props` access."),n}}),n}function x(e){var t=h.useRef();t.current=e;var n=h.useCallback((function(){return t.current.apply(t,arguments)}),[]);return n}function D(e,t,n){return h.useMemo((function(){return e?n?function(e,t){var n=t.id,r=t.pId,a=t.rootPId,l={},i=[];return e.map((function(e){var t=o({},e),r=t[n];return l[r]=t,t.key=t.key||r,t})).forEach((function(e){var t=e[r],n=l[t];n&&(n.children=n.children||[],n.children.push(e)),(t===a||!n&&null===a)&&i.push(e)})),i}(e,o({id:"id",pId:"pId",rootPId:null},!0!==n?n:{})):e:E(t)}),[t,n,e])}var N=h.createContext(null),I=h.createContext(null),T={width:0,height:0,display:"flex",overflow:"hidden",opacity:0,border:0,padding:0,margin:0},K=function(e,t){var a=f(),o=a.prefixCls,i=a.multiple,u=a.searchValue,s=a.toggleOpen,v=a.open,p=a.notFoundContent,m=h.useContext(I),y=m.virtual,k=m.listHeight,C=m.listItemHeight,S=m.listItemScrollOffset,E=m.treeData,w=m.fieldNames,x=m.onSelect,D=m.dropdownMatchSelectWidth,K=m.treeExpandAction,M=m.treeTitleRender,L=m.onPopupScroll,V=h.useContext(N),P=V.checkable,O=V.checkedKeys,_=V.halfCheckedKeys,H=V.treeExpandedKeys,A=V.treeDefaultExpandAll,R=V.treeDefaultExpandedKeys,j=V.onTreeExpand,W=V.treeIcon,F=V.showTreeIcon,U=V.switcherIcon,B=V.treeLine,G=V.treeNodeFilterProp,z=V.loadData,J=V.treeLoadedKeys,Y=V.treeMotion,q=V.onTreeLoad,Q=V.keyEntities,X=h.useRef(),Z=n((function(){return E}),[v,E],(function(e,t){return t[0]&&e[1]!==t[1]})),$=h.useState(null),ee=c($,2),te=ee[0],ne=ee[1],re=Q[te],ae=h.useMemo((function(){return P?{checked:O,halfChecked:_}:null}),[P,O,_]);h.useEffect((function(){var e;v&&!i&&O.length&&(null===(e=X.current)||void 0===e||e.scrollTo({key:O[0]}),ne(O[0]))}),[v]);var oe=String(u).toLowerCase(),le=h.useState(R),ie=c(le,2),ue=ie[0],ce=ie[1],de=h.useState(null),se=c(de,2),fe=se[0],ve=se[1],pe=h.useMemo((function(){return H?l(H):u?fe:ue}),[ue,fe,H,u]);h.useEffect((function(){u&&ve(function(e,t){var n=[];return function e(r){r.forEach((function(r){var a=r[t.children];a&&(n.push(r[t.value]),e(a))}))}(e),n}(E,w))}),[u]);var he=function(e){e.preventDefault()},me=function(e,t){var n=t.node;P&&b(n)||(x(n.key,{selected:!O.includes(n.key)}),i||s(!1))};if(h.useImperativeHandle(t,(function(){var e;return{scrollTo:null===(e=X.current)||void 0===e?void 0:e.scrollTo,onKeyDown:function(e){var t;switch(e.which){case r.UP:case r.DOWN:case r.LEFT:case r.RIGHT:null===(t=X.current)||void 0===t||t.onKeyDown(e);break;case r.ENTER:if(re){var n=(null==re?void 0:re.node)||{},a=n.selectable,o=n.value;!1!==a&&me(0,{node:{key:te},selected:!O.includes(o)})}break;case r.ESC:s(!1)}},onKeyUp:function(){}}})),0===Z.length)return h.createElement("div",{role:"listbox",className:"".concat(o,"-empty"),onMouseDown:he},p);var ye={fieldNames:w};return J&&(ye.loadedKeys=J),pe&&(ye.expandedKeys=pe),h.createElement("div",{onMouseDown:he},re&&v&&h.createElement("span",{style:T,"aria-live":"assertive"},re.node.value),h.createElement(g,d({ref:X,focusable:!1,prefixCls:"".concat(o,"-tree"),treeData:Z,height:k,itemHeight:C,itemScrollOffset:S,virtual:!1!==y&&!1!==D,multiple:i,icon:W,showIcon:F,switcherIcon:U,showLine:B,loadData:u?null:z,motion:Y,activeKey:te,checkable:P,checkStrictly:!0,checkedKeys:ae,selectedKeys:P?[]:O,defaultExpandAll:A,titleRender:M},ye,{onActiveChange:ne,onSelect:me,onCheck:me,onExpand:function(e){ce(e),ve(e),j&&j(e)},onLoad:q,filterTreeNode:function(e){return!!oe&&String(e[G]).toLowerCase().includes(oe)},expandAction:K,onScroll:L})))},M=h.forwardRef(K),L="SHOW_ALL",V="SHOW_PARENT",P="SHOW_CHILD";function O(e,t,n,r){var a=new Set(e);return t===P?e.filter((function(e){var t=n[e];return!(t&&t.children&&t.children.some((function(e){var t=e.node;return a.has(t[r.value])}))&&t.children.every((function(e){var t=e.node;return b(t)||a.has(t[r.value])})))})):t===V?e.filter((function(e){var t=n[e],r=t?t.parent:null;return!(r&&!b(r.node)&&a.has(r.key))})):e}var _=["id","prefixCls","value","defaultValue","onChange","onSelect","onDeselect","searchValue","inputValue","onSearch","autoClearSearchValue","filterTreeNode","treeNodeFilterProp","showCheckedStrategy","treeNodeLabelProp","multiple","treeCheckable","treeCheckStrictly","labelInValue","fieldNames","treeDataSimpleMode","treeData","children","loadData","treeLoadedKeys","onTreeLoad","treeDefaultExpandAll","treeExpandedKeys","treeDefaultExpandedKeys","onTreeExpand","treeExpandAction","virtual","listHeight","listItemHeight","listItemScrollOffset","onDropdownVisibleChange","dropdownMatchSelectWidth","treeLine","treeIcon","showTreeIcon","switcherIcon","treeMotion","treeTitleRender","onPopupScroll"];var H=h.forwardRef((function(e,n){var r,f,g=e.id,b=e.prefixCls,S=void 0===b?"rc-tree-select":b,E=e.value,T=e.defaultValue,K=e.onChange,V=e.onSelect,H=e.onDeselect,A=e.searchValue,R=e.inputValue,j=e.onSearch,W=e.autoClearSearchValue,F=void 0===W||W,U=e.filterTreeNode,B=e.treeNodeFilterProp,G=void 0===B?"value":B,z=e.showCheckedStrategy,J=e.treeNodeLabelProp,Y=e.multiple,q=e.treeCheckable,Q=e.treeCheckStrictly,X=e.labelInValue,Z=e.fieldNames,$=e.treeDataSimpleMode,ee=e.treeData,te=e.children,ne=e.loadData,re=e.treeLoadedKeys,ae=e.onTreeLoad,oe=e.treeDefaultExpandAll,le=e.treeExpandedKeys,ie=e.treeDefaultExpandedKeys,ue=e.onTreeExpand,ce=e.treeExpandAction,de=e.virtual,se=e.listHeight,fe=void 0===se?200:se,ve=e.listItemHeight,pe=void 0===ve?20:ve,he=e.listItemScrollOffset,me=void 0===he?0:he,ye=e.onDropdownVisibleChange,ge=e.dropdownMatchSelectWidth,be=void 0===ge||ge,ke=e.treeLine,Ce=e.treeIcon,Se=e.showTreeIcon,Ee=e.switcherIcon,we=e.treeMotion,xe=e.treeTitleRender,De=e.onPopupScroll,Ne=i(e,_),Ie=v(g),Te=q&&!Q,Ke=q||Q,Me=Q||X,Le=Ke||Y,Ve=a(T,{value:E}),Pe=c(Ve,2),Oe=Pe[0],_e=Pe[1],He=h.useMemo((function(){return q?z||P:L}),[z,q]),Ae=h.useMemo((function(){return function(e){var t=e||{},n=t.label,r=t.value||"value";return{_title:n?[n]:["title","label"],value:r,key:r,children:t.children||"children"}}(Z)}),[JSON.stringify(Z)]),Re=a("",{value:void 0!==A?A:R,postState:function(e){return e||""}}),je=c(Re,2),We=je[0],Fe=je[1],Ue=D(ee,te,$),Be=function(e,t){return h.useMemo((function(){return y(e,{fieldNames:t,initWrapper:function(e){return o(o({},e),{},{valueEntities:new Map})},processEntity:function(e,n){var r=e.node[t.value];n.valueEntities.set(r,e)}})}),[e,t])}(Ue,Ae),Ge=Be.keyEntities,ze=Be.valueEntities,Je=h.useCallback((function(e){var t=[],n=[];return e.forEach((function(e){ze.has(e)?n.push(e):t.push(e)})),{missingRawValues:t,existRawValues:n}}),[ze]),Ye=function(e,t,n){var r=n.treeNodeFilterProp,a=n.filterTreeNode,l=n.fieldNames.children;return h.useMemo((function(){if(!t||!1===a)return e;var n;if("function"==typeof a)n=a;else{var i=t.toUpperCase();n=function(e,t){var n=t[r];return String(n).toUpperCase().includes(i)}}return function e(r){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return r.reduce((function(r,i){var c=i[l],d=a||n(t,w(i)),s=e(c||[],d);return(d||s.length)&&r.push(o(o({},i),{},u({isLeaf:void 0},l,s))),r}),[])}(e)}),[e,t,l,r,a])}(Ue,We,{fieldNames:Ae,treeNodeFilterProp:G,filterTreeNode:U}),qe=h.useCallback((function(e){if(e){if(J)return e[J];for(var t=Ae._title,n=0;n<t.length;n+=1){var r=e[t[n]];if(void 0!==r)return r}}}),[Ae,J]),Qe=h.useCallback((function(e){var t=function(e){return Array.isArray(e)?e:void 0!==e?[e]:[]}(e);return t.map((function(e){return function(e){return!e||"object"!==s(e)}(e)?{value:e}:e}))}),[]),Xe=h.useCallback((function(e){return Qe(e).map((function(e){var t,n,r=e.label,a=e.value,o=e.halfChecked,l=ze.get(a);if(l)r=xe?xe(l.node):null!==(n=r)&&void 0!==n?n:qe(l.node),t=l.node.disabled;else if(void 0===r){r=Qe(Oe).find((function(e){return e.value===a})).label}return{label:r,value:a,halfChecked:o,disabled:t}}))}),[ze,qe,Qe,Oe]),Ze=h.useMemo((function(){return Qe(Oe)}),[Qe,Oe]),$e=h.useMemo((function(){var e=[],t=[];return Ze.forEach((function(n){n.halfChecked?t.push(n):e.push(n)})),[e,t]}),[Ze]),et=c($e,2),tt=et[0],nt=et[1],rt=h.useMemo((function(){return tt.map((function(e){return e.value}))}),[tt]),at=function(e,t,n,r){return h.useMemo((function(){var a=e.map((function(e){return e.value})),o=t.map((function(e){return e.value})),i=a.filter((function(e){return!r[e]}));if(n){var u=m(a,!0,r);a=u.checkedKeys,o=u.halfCheckedKeys}return[Array.from(new Set([].concat(l(i),l(a)))),o]}),[e,t,n,r])}(tt,nt,Te,Ge),ot=c(at,2),lt=ot[0],it=ot[1],ut=h.useMemo((function(){var e=O(lt,He,Ge,Ae).map((function(e){var t,n;return null!==(t=null===(n=Ge[e])||void 0===n||null===(n=n.node)||void 0===n?void 0:n[Ae.value])&&void 0!==t?t:e})).map((function(e){var t,n=tt.find((function(t){return t.value===e}));return X&&void 0!==n.label?t=n.label:!X&&xe&&(t=xe(n)),{value:e,label:t}})),t=Xe(e),n=t[0];return!Le&&n&&k(n.value)&&k(n.label)?[]:t.map((function(e){var t;return o(o({},e),{},{label:null!==(t=e.label)&&void 0!==t?t:e.value})}))}),[Ae,Le,lt,tt,Xe,He,Ge]),ct=(r=ut,f=h.useRef({valueLabels:new Map}),h.useMemo((function(){var e=f.current.valueLabels,t=new Map,n=r.map((function(n){var r,a=n.value,l=null!==(r=n.label)&&void 0!==r?r:e.get(a);return t.set(a,l),o(o({},n),{},{label:l})}));return f.current.valueLabels=t,[n]}),[r])),dt=c(ct,1)[0],st=x((function(e,n,r){var a=Xe(e);if(_e(a),F&&Fe(""),K){var o=e;if(Te){var i=O(e,He,Ge,Ae);o=i.map((function(e){var t=ze.get(e);return t?t.node[Ae.value]:e}))}var u=n||{triggerValue:void 0,selected:void 0},c=u.triggerValue,d=u.selected,s=o;if(Q){var f=nt.filter((function(e){return!o.includes(e.value)}));s=[].concat(l(s),l(f))}var v=Xe(s),p={preValue:tt,triggerValue:c},m=!0;(Q||"selection"===r&&!d)&&(m=!1),function(e,n,r,a,o,l){var i=null,u=null;function c(){u||(u=[],function e(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"0",o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return t.map((function(t,c){var d="".concat(a,"-").concat(c),s=t[l.value],f=r.includes(s),v=e(t[l.children]||[],d,f),p=h.createElement(C,t,v.map((function(e){return e.node})));if(n===s&&(i=p),f){var m={pos:d,node:p,children:v};return o||u.push(m),m}return null})).filter((function(e){return e}))}(a),u.sort((function(e,t){var n=e.node.props.value,a=t.node.props.value;return r.indexOf(n)-r.indexOf(a)})))}Object.defineProperty(e,"triggerNode",{get:function(){return t(!1,"`triggerNode` is deprecated. Please consider decoupling data with node."),c(),i}}),Object.defineProperty(e,"allCheckedNodes",{get:function(){return t(!1,"`allCheckedNodes` is deprecated. Please consider decoupling data with node."),c(),o?u:u.map((function(e){return e.node}))}})}(p,c,e,Ue,m,Ae),Ke?p.checked=d:p.selected=d;var y=Me?v:v.map((function(e){return e.value}));K(Le?y:y[0],Me?null:v.map((function(e){return e.label})),p)}})),ft=h.useCallback((function(e,t){var n,r=t.selected,a=t.source,o=Ge[e],i=null==o?void 0:o.node,u=null!==(n=null==i?void 0:i[Ae.value])&&void 0!==n?n:e;if(Le){var c=r?[].concat(l(rt),[u]):lt.filter((function(e){return e!==u}));if(Te){var d,s=Je(c),f=s.missingRawValues,v=s.existRawValues.map((function(e){return ze.get(e).key}));if(r)d=m(v,!0,Ge).checkedKeys;else d=m(v,{checked:!1,halfCheckedKeys:it},Ge).checkedKeys;c=[].concat(l(f),l(d.map((function(e){return Ge[e].node[Ae.value]}))))}st(c,{selected:r,triggerValue:u},a||"option")}else st([u],{selected:!0,triggerValue:u},"option");r||!Le?null==V||V(u,w(i)):null==H||H(u,w(i))}),[Je,ze,Ge,Ae,Le,rt,st,Te,V,H,lt,it]),vt=h.useCallback((function(e){if(ye){var n={};Object.defineProperty(n,"documentClickClose",{get:function(){return t(!1,"Second param of `onDropdownVisibleChange` has been removed."),!1}}),ye(e,n)}}),[ye]),pt=x((function(e,t){var n=e.map((function(e){return e.value}));"clear"!==t.type?t.values.length&&ft(t.values[0].value,{selected:!1,source:"selection"}):st(n,{},"selection")})),ht=h.useMemo((function(){return{virtual:de,dropdownMatchSelectWidth:be,listHeight:fe,listItemHeight:pe,listItemScrollOffset:me,treeData:Ye,fieldNames:Ae,onSelect:ft,treeExpandAction:ce,treeTitleRender:xe,onPopupScroll:De}}),[de,be,fe,pe,me,Ye,Ae,ft,ce,xe,De]),mt=h.useMemo((function(){return{checkable:Ke,loadData:ne,treeLoadedKeys:re,onTreeLoad:ae,checkedKeys:lt,halfCheckedKeys:it,treeDefaultExpandAll:oe,treeExpandedKeys:le,treeDefaultExpandedKeys:ie,onTreeExpand:ue,treeIcon:Ce,treeMotion:we,showTreeIcon:Se,switcherIcon:Ee,treeLine:ke,treeNodeFilterProp:G,keyEntities:Ge}}),[Ke,ne,re,ae,lt,it,oe,le,ie,ue,Ce,we,Se,Ee,ke,G,Ge]);return h.createElement(I.Provider,{value:ht},h.createElement(N.Provider,{value:mt},h.createElement(p,d({ref:n},Ne,{id:Ie,prefixCls:S,mode:Le?"multiple":void 0,displayValues:dt,onDisplayValuesChange:pt,searchValue:We,onSearch:function(e){Fe(e),null==j||j(e)},OptionList:M,emptyOptions:!Ue.length,onDropdownVisibleChange:vt,dropdownMatchSelectWidth:be}))))}));H.TreeNode=C,H.SHOW_ALL=L,H.SHOW_PARENT=V,H.SHOW_CHILD=P;export{H as G,L as S,C as T,V as a,P as b};
