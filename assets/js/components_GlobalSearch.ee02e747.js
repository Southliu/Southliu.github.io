import{j as d,a as p,F as R}from"./components_Bottom.7f50d752.js";import{r as g}from"./react.8249fdc7.js";import{a7 as y,a8 as T}from"./inheritsLoose.4207bb94.js";import{u as Q}from"./ahooks.87600d6c.js";import{u as D,a as E}from"./react-redux.c8a1c50f.js";import{u as I}from"./react-router.8f9dc105.js";import{M as W,I as X,T as Y}from"./antd.b3f2ce6f.js";const Z=[{label:"系统管理",key:"system",icon:d(y,{icon:"ion:settings-outline"}),children:[{label:"用户管理",key:"/system/user",rule:"/authority/user"},{label:"菜单管理",key:"/system/menu",rule:"/authority/menu"}]}],V=[{label:"组件",key:"demo",icon:d(y,{icon:"fluent:box-20-regular"}),children:[{label:"剪切板",key:"/demo/copy",rule:"/demo/copy"},{label:"水印",key:"/demo/watermark",rule:"/demo/watermark"},{label:"虚拟滚动",key:"/demo/virtualScroll",rule:"/demo/virtualScroll"},{label:"富文本",key:"/demo/editor",rule:"/demo/editor"},{label:"层级1",key:"/demo/level1",children:[{label:"层级2",key:"/demo/level1/level2",children:[{label:"层级3",key:"/demo/level1/level2/level3",rule:"/demo/watermark"}]}]}]}],ee=[{label:"内容管理",key:"content",icon:d(y,{icon:"majesticons:article-search-line"}),children:[{label:"文章管理",key:"/content/article",rule:"/content/article"}]}],L=[{label:"仪表盘",key:"dashboard",icon:d(y,{icon:"la:tachometer-alt"}),children:[{label:"数据总览",key:"/dashboard",rule:"/dashboard"}]},...V,...Z,...ee];function j(e){const n=N(e),t=[];if(n.length>0&&t.push(n[0]),n.length>2){let c="/"+n[0];for(let l=1;l<n.length-1;l++)c+="/"+n[l],t.push(c)}return t}function ne(e,n){const t=[],c=N(e);let l=0;const s=c.length;for(let a=0;a<n.length;a++){const{path:o}=n[a];if((o==null?void 0:o[l])===c[l]&&(t.push(n[a].label),l<s-1&&l++),l===s)return t}return t}function N(e){if(!e||typeof e!="string")return[];const n=(e==null?void 0:e.split("/"))||[];return(n==null?void 0:n[0])===""&&n.shift(),n}function B(e){var a,o;const{menus:n,permissions:t,value:c}=e;let{currentPath:l,result:s}=e;if(!(n!=null&&n.length)||!c)return[];l||(l=[]),s||(s=[]);for(let r=0;r<n.length;r++)if(b(n[r])){l.push({label:n[r].label,path:N(n[r].key)});const u={menus:n[r].children,permissions:t,value:c,currentPath:l,result:s},i=B(u);i.length?s.concat(i):l.pop()}else if((o=(a=n[r])==null?void 0:a.label)!=null&&o.includes(c)&&A(n[r],t)){l.push({label:n[r].label,path:N(n[r].key)});const u=ne(n[r].key,l),{label:i,key:k}=n[r];s.push({label:i,key:k,nav:u})}return s}function M(e){var a;const{menus:n,permissions:t,key:c}=e;let{fatherNav:l,result:s}=e;if(!(n!=null&&n.length))return s;l||(l=[]),s!=null&&s.key||(s={key:"",label:"",nav:[]});for(let o=0;o<n.length;o++){if(!c||s.key)return s;if(b(n[o])){l.push(n[o].label);const r={menus:n[o].children,permissions:t,key:c,fatherNav:l,result:s},u=M(r);u!=null&&u.key?s=u:l.pop()}else if(((a=n[o])==null?void 0:a.key)===c&&A(n[o],t)){l.push(n[o].label);const{label:r,key:u}=n[o];u&&(s={label:r,key:u,nav:l})}}return s}function te(e,n){const t=[];for(let c=0;c<e.length;c++){if(b(e[c])){const l=te(e[c].children,n);e[c].children=l!=null&&l.length?l:void 0}(A(e[c],n)||b(e[c]))&&t.push(e[c])}return t}function le(e,n,t=""){if(t)return t;for(let c=0;c<e.length;c++){if(b(e[c])&&!t){const l=le(e[c].children,n,t);if(l)return t=l,t}A(e[c],n)&&!b(e[c])&&(t=e[c].key)}return t}function A(e,n){return n==null?void 0:n.includes((e==null?void 0:e.rule)||"")}function b(e){var n;return Boolean((n=e.children)==null?void 0:n.length)}const O=T({name:"tabs",initialState:{isLock:!1,isMaximize:!1,activeKey:"",nav:[],tabs:[]},reducers:{toggleLock:(e,n)=>{e.isLock=!!n.payload},toggleMaximize:(e,n)=>{e.isMaximize=!!n.payload},setActiveKey:(e,n)=>{e.activeKey=n.payload},setNav:(e,n)=>{e.nav=n.payload},addTabs:(e,n)=>{const{tabs:t}=e,{payload:c}=n;t.find(s=>s.key===c.key)||t.push(c),t!=null&&t.length&&(t[0].closable=(t==null?void 0:t.length)>1)},closeTabs:(e,n)=>{var s;const{tabs:t}=e,{payload:c}=n,l=t.findIndex(a=>a.key===c);if(l>=0&&t.splice(l,1),c===e.activeKey){let a="";l===0?a=((s=t==null?void 0:t[l])==null?void 0:s.key)||"":a=t[l-1].key,e.activeKey=a,e.isLock=!0}t!=null&&t.length&&(t[0].closable=(t==null?void 0:t.length)>1)},closeTabGoNext:(e,n)=>{const{tabs:t}=e,{payload:c}=n,{key:l,nextPath:s}=c,a=t.findIndex(o=>o.key===l);a>=0&&t.splice(a,1),l===e.activeKey&&(e.activeKey=s,e.isLock=!0),t!=null&&t.length&&(t[0].closable=(t==null?void 0:t.length)>1)},closeLeft:(e,n)=>{const{tabs:t}=e,{payload:c}=n,l=t.findIndex(s=>s.key===c);l>=0&&t.splice(0,l),e.activeKey=t[0].key,t!=null&&t.length&&(t[0].closable=(t==null?void 0:t.length)>1)},closeRight:(e,n)=>{const{tabs:t}=e,{payload:c}=n,l=t.findIndex(s=>s.key===c);l>=0&&t.splice(l+1,t.length-l-1),e.activeKey=t[t.length-1].key,t!=null&&t.length&&(t[0].closable=(t==null?void 0:t.length)>1)},closeOther:(e,n)=>{const{tabs:t}=e,{payload:c}=n,l=t.find(s=>s.key===c);l&&(e.tabs=[l],e.activeKey=l.key,e.isLock=!0),t[0].closable=!1},closeAllTab:e=>{e.tabs=[]}}}),{toggleLock:me,toggleMaximize:ge,setActiveKey:F,setNav:ke,addTabs:$,closeTabs:xe,closeTabGoNext:ve,closeLeft:be,closeRight:we,closeOther:Ke,closeAllTab:Ne}=O.actions,Ae=O.reducer,z=T({name:"menu",initialState:{isPhone:!1,isCollapsed:!1,selectedKeys:"dashboard",openKeys:["Dashboard"]},reducers:{toggleCollapsed:(e,n)=>{e.isCollapsed=!!n.payload},togglePhone:(e,n)=>{e.isPhone=!!n.payload},setSelectedKeys:(e,n)=>{e.selectedKeys=n.payload},setOpenKeys:(e,n)=>{e.openKeys=n.payload}}}),{toggleCollapsed:Se,togglePhone:Pe,setSelectedKeys:Le,setOpenKeys:G}=z.actions,Me=z.reducer;function ce(e){return[t=>{var c,l,s,a,o;switch(t.key){case"ArrowUp":(c=e.ArrowUp)==null||c.call(e);break;case"ArrowDown":(l=e.ArrowDown)==null||l.call(e);break;case"ArrowLeft":(s=e.ArrowLeft)==null||s.call(e);break;case"ArrowRight":(a=e.ArrowRight)==null||a.call(e);break;case"Enter":(o=e.Enter)==null||o.call(e);break}}]}function se(e){const{list:n,active:t,onCancel:c,changActive:l}=e,s=I(),a=D(),o=E(i=>i.user.permissions),r=i=>{s(i);const x=M({menus:L,permissions:o,key:i});a($(x)),a(F(i));const v=j(i);a(G(v)),c()},u=i=>{l(i)};return p(R,{children:[!(n!=null&&n.length)&&p("div",{className:"flex flex-col items-center pt-5 text-warm-gray-400",children:[d(y,{className:"text-40px",icon:"mdi:archive-cancel-outline"}),d("span",{className:"mt-1",children:"暂无搜索结构"})]}),(n==null?void 0:n.length)>0&&d("div",{className:"mt-5",children:n==null?void 0:n.map(i=>{var k;return p("div",{className:`
                h-56px
                mt-8px
                px-14px
                rounded-4px
                cursor-pointer
                flex
                items-center
                justify-between
                shadow-md
                border
                border-light-500
                ${t===i.key?"bg-blue-500 text-white":""}
              `,onClick:()=>r(i.key),onMouseEnter:()=>u(i.key),children:[p("div",{className:"flex items-center",children:[d(y,{className:"text-lg mr-1",icon:"gg:menu-boxed"}),i.nav&&((k=i.nav)==null?void 0:k.length)>0&&i.nav.map((x,v)=>p(g.Fragment,{children:[v>0&&d("span",{className:"mx-5px",children:">"}),d("span",{children:x})]},x)),!i.nav&&d("span",{children:i.label})]}),d(y,{className:"icon text-20px p-2px mr-5px",icon:"ant-design:enter-outlined"})]},i.key)})})]})}const ae="_icon_1eshe_1",K={icon:ae};function oe(){return p("div",{className:"flex items-center text-dark-50",children:[p("span",{className:"mr-14px flex items-center",children:[d(y,{className:`${K.icon} text-20px p-2px mr-5px`,icon:"ant-design:enter-outlined"}),d("span",{children:"确认"})]}),p("span",{className:"mr-14px flex items-center",children:[d(y,{className:`${K.icon} text-20px p-2px mr-5px`,icon:"mdi-arrow-up-thin"}),d(y,{className:`${K.icon} text-20px p-2px mr-5px`,icon:"mdi-arrow-down-thin"}),d("span",{children:"切换"})]}),p("span",{className:"flex items-center",children:[d(y,{className:`${K.icon} text-20px p-2px mr-5px`,icon:"mdi:keyboard-esc"}),d("span",{children:"关闭"})]})]})}function re(e){const n=I(),t=g.useRef(null),{modalRef:c}=e,[l,s]=g.useState(""),[a,o]=g.useState(""),[r,u]=g.useState([]),[i,k]=g.useState(!1),x=D(),v=E(h=>h.user.permissions);g.useImperativeHandle(c,()=>({toggle:()=>{k(!i)}})),g.useLayoutEffect(()=>(i&&setTimeout(()=>{var h;(h=t.current)==null||h.focus({cursor:"end"})},0),()=>{s(""),o(""),u([])}),[i]);const U=h=>{o(h)},S=()=>{k(!1)},C=()=>{if(a){n(a);const m=M({menus:L,permissions:v,key:a});x($(m)),x(F(a));const f=j(a);x(G(f)),S()}},_=Q(h=>{var w;const f=B({menus:L,permissions:v,value:h});f!=null&&f.length?(o(((w=f==null?void 0:f[0])==null?void 0:w.key)||""),u(f)):(o(""),u([]))},{wait:200}),q=h=>{const{value:m}=h.target;s(m),_.run(m)},H=()=>{if(!r.length)return null;const h=r.findIndex(f=>f.key===a);if(h===0)return null;const m=r[h-1].key;o(m)},J=()=>{if(!r.length)return null;const h=r.length-1,m=r.findIndex(w=>w.key===a);if(m===h)return null;const f=r[m+1].key;o(f)},[P]=ce({ArrowUp:H,ArrowDown:J,Enter:C});return g.useEffect(()=>{if(r.length)return window.addEventListener("keydown",P),()=>{window.removeEventListener("keydown",P)}},[r,a,P]),p(W,{className:"rounded-100px",open:i,closable:!1,onCancel:S,footer:d(oe,{}),children:[d(X,{ref:t,value:l,placeholder:"请输入关键词搜索",allowClear:!0,prefix:d(y,{className:"text-lg text-warm-gray-400",icon:"ant-design:search-outlined"}),onChange:q,onPressEnter:C}),d(se,{list:r,active:a,onCancel:S,changActive:U})]})}function Ce(){const e=g.useRef(null);return p(R,{children:[d(Y,{title:"搜索",children:d(y,{className:"flex items-center justify-center text-lg mr-3 cursor-pointer",icon:"uil-search",onClick:()=>{var t;(t=e.current)==null||t.toggle()}})}),d(re,{modalRef:e})]})}export{Ce as G,Le as a,N as b,le as c,L as d,M as e,te as f,j as g,F as h,ke as i,$ as j,Ne as k,we as l,be as m,Ke as n,xe as o,ge as p,me as q,Pe as r,G as s,Se as t,ve as u,Me as v,Ae as w};
