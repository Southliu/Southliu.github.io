import{r as t}from"./react@18.2.0.CwGjMYfB.js";import{u as e}from"./use-sync-external-store@1.2.0_react@18.2.0.DLQO1w-V.js";const n=t=>{let e;const n=new Set,r=(t,r)=>{const o="function"==typeof t?t(e):t;if(!Object.is(o,e)){const t=e;e=(null!=r?r:"object"!=typeof o)?o:Object.assign({},e,o),n.forEach((n=>n(e,t)))}},o=()=>e,s={setState:r,getState:o,subscribe:t=>(n.add(t),()=>n.delete(t)),destroy:()=>{n.clear()}};return e=t(r,o,s),s},{useSyncExternalStoreWithSelector:r}=e;const o=e=>{const o="function"==typeof e?(t=>t?n(t):n)(e):e,s=(e,n)=>function(e,n=e.getState,o){const s=r(e.subscribe,e.getState,e.getServerState||e.getState,n,o);return t.useDebugValue(s),s}(o,e,n);return Object.assign(s,o),s},s=t=>o,i={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_BASE_URL:"https://mock.mengxuegu.com/mock/63f830b1c5a76a117cab185e/v1",VITE_ENV:"production",VITE_SECRET_KEY:"__Vite_Admin_Secret__"},a=new Map,c=t=>{const e=a.get(t);return e?Object.fromEntries(Object.entries(e.stores).map((([t,e])=>[t,e.getState()]))):{}},l=(t,e={})=>(n,r,o)=>{const{enabled:s,anonymousActionType:l,store:d,...S}=e;let g;try{g=(null!=s?s:"production"!==(i&&"production"))&&window.__REDUX_DEVTOOLS_EXTENSION__}catch(h){}if(!g)return t(n,r,o);const{connection:p,...f}=((t,e,n)=>{if(void 0===t)return{type:"untracked",connection:e.connect(n)};const r=a.get(n.name);if(r)return{type:"tracked",store:t,...r};const o={connection:e.connect(n),stores:{}};return a.set(n.name,o),{type:"tracked",store:t,...o}})(d,g,S);let m=!0;o.setState=(t,e,s)=>{const i=n(t,e);if(!m)return i;const a=void 0===s?{type:l||"anonymous"}:"string"==typeof s?{type:s}:s;return void 0===d?(null==p||p.send(a,r()),i):(null==p||p.send({...a,type:`${d}/${a.type}`},{...c(S.name),[d]:o.getState()}),i)};const v=(...t)=>{const e=m;m=!1,n(...t),m=e},y=t(o.setState,r,o);if("untracked"===f.type?null==p||p.init(y):(f.stores[f.store]=o,null==p||p.init(Object.fromEntries(Object.entries(f.stores).map((([t,e])=>[t,t===f.store?y:e.getState()]))))),o.dispatchFromDevtools&&"function"==typeof o.dispatch){let t=!1;const e=o.dispatch;o.dispatch=(...n)=>{"production"===(i&&"production")||"__setState"!==n[0].type||t||(t=!0),e(...n)}}return p.subscribe((t=>{var e;switch(t.type){case"ACTION":if("string"!=typeof t.payload)return;return u(t.payload,(t=>{if("__setState"!==t.type)o.dispatchFromDevtools&&"function"==typeof o.dispatch&&o.dispatch(t);else{if(void 0===d)return void v(t.state);Object.keys(t.state).length;const e=t.state[d];if(null==e)return;JSON.stringify(o.getState())!==JSON.stringify(e)&&v(e)}}));case"DISPATCH":switch(t.payload.type){case"RESET":return v(y),void 0===d?null==p?void 0:p.init(o.getState()):null==p?void 0:p.init(c(S.name));case"COMMIT":return void 0===d?void(null==p||p.init(o.getState())):null==p?void 0:p.init(c(S.name));case"ROLLBACK":return u(t.state,(t=>{if(void 0===d)return v(t),void(null==p||p.init(o.getState()));v(t[d]),null==p||p.init(c(S.name))}));case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return u(t.state,(t=>{void 0!==d?JSON.stringify(o.getState())!==JSON.stringify(t[d])&&v(t[d]):v(t)}));case"IMPORT_STATE":{const{nextLiftedState:n}=t.payload,r=null==(e=n.computedStates.slice(-1)[0])?void 0:e.state;if(!r)return;return v(void 0===d?r:r[d]),void(null==p||p.send(null,n))}case"PAUSE_RECORDING":return m=!m}return}})),y},u=(t,e)=>{let n;try{n=JSON.parse(t)}catch(r){}void 0!==n&&e(n)};function d(t){let e;try{e=t()}catch(n){return}return{getItem:t=>{var n;const r=t=>null===t?null:JSON.parse(t),o=null!=(n=e.getItem(t))?n:null;return o instanceof Promise?o.then(r):r(o)},setItem:(t,n)=>e.setItem(t,JSON.stringify(n)),removeItem:t=>e.removeItem(t)}}const S=t=>e=>{try{const n=t(e);return n instanceof Promise?n:{then:t=>S(t)(n),catch(t){return this}}}catch(n){return{then(t){return this},catch:t=>S(t)(n)}}},g=(t,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((t,e)=>(n,r,o)=>{let s={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:t=>t,version:0,merge:(t,e)=>({...e,...t}),...e},i=!1;const a=new Set,c=new Set;let l;try{l=s.getStorage()}catch(v){}if(!l)return t(((...t)=>{n(...t)}),r,o);const u=S(s.serialize),d=()=>{const t=s.partialize({...r()});let e;const n=u({state:t,version:s.version}).then((t=>l.setItem(s.name,t))).catch((t=>{e=t}));if(e)throw e;return n},g=o.setState;o.setState=(t,e)=>{g(t,e),d()};const p=t(((...t)=>{n(...t),d()}),r,o);let f;const m=()=>{var t;if(!l)return;i=!1,a.forEach((t=>t(r())));const e=(null==(t=s.onRehydrateStorage)?void 0:t.call(s,r()))||void 0;return S(l.getItem.bind(l))(s.name).then((t=>{if(t)return s.deserialize(t)})).then((t=>{if(t){if("number"!=typeof t.version||t.version===s.version)return t.state;if(s.migrate)return s.migrate(t.state,t.version)}})).then((t=>{var e;return f=s.merge(t,null!=(e=r())?e:p),n(f,!0),d()})).then((()=>{null==e||e(f,void 0),i=!0,c.forEach((t=>t(f)))})).catch((t=>{null==e||e(void 0,t)}))};return o.persist={setOptions:t=>{s={...s,...t},t.getStorage&&(l=t.getStorage())},clearStorage:()=>{null==l||l.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>m(),hasHydrated:()=>i,onHydrate:t=>(a.add(t),()=>{a.delete(t)}),onFinishHydration:t=>(c.add(t),()=>{c.delete(t)})},m(),f||p})(t,e):((t,e)=>(n,r,o)=>{let s={storage:d((()=>localStorage)),partialize:t=>t,version:0,merge:(t,e)=>({...e,...t}),...e},i=!1;const a=new Set,c=new Set;let l=s.storage;if(!l)return t(((...t)=>{n(...t)}),r,o);const u=()=>{const t=s.partialize({...r()});return l.setItem(s.name,{state:t,version:s.version})},g=o.setState;o.setState=(t,e)=>{g(t,e),u()};const p=t(((...t)=>{n(...t),u()}),r,o);let f;const m=()=>{var t;if(!l)return;i=!1,a.forEach((t=>t(r())));const e=(null==(t=s.onRehydrateStorage)?void 0:t.call(s,r()))||void 0;return S(l.getItem.bind(l))(s.name).then((t=>{if(t){if("number"!=typeof t.version||t.version===s.version)return t.state;if(s.migrate)return s.migrate(t.state,t.version)}})).then((t=>{var e;return f=s.merge(t,null!=(e=r())?e:p),n(f,!0),u()})).then((()=>{null==e||e(f,void 0),i=!0,c.forEach((t=>t(f)))})).catch((t=>{null==e||e(void 0,t)}))};return o.persist={setOptions:t=>{s={...s,...t},t.storage&&(l=t.storage)},clearStorage:()=>{null==l||l.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>m(),hasHydrated:()=>i,onHydrate:t=>(a.add(t),()=>{a.delete(t)}),onFinishHydration:t=>(c.add(t),()=>{c.delete(t)})},m(),f||p})(t,e);export{d as a,s as c,l as d,g as p};
