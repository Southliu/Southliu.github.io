import{l as O,m as S,n as D,p as L,h as k,f as $}from"./inheritsLoose.4207bb94.js";import{r as t}from"./react.8249fdc7.js";import{s as A,m as j,G as H,t as F}from"./rc-util.30994db3.js";import{i as G}from"./resize-observer-polyfill.0f9f8adb.js";var c=new Map;function K(e){e.forEach(function(i){var r,n=i.target;(r=c.get(n))===null||r===void 0||r.forEach(function(o){return o(n)})})}var M=new G(K);function T(e,i){c.has(e)||(c.set(e,new Set),M.observe(e)),c.get(e).add(i)}function V(e,i){c.has(e)&&(c.get(e).delete(i),c.get(e).size||(M.unobserve(e),c.delete(e)))}var X=function(e){O(r,e);var i=S(r);function r(){return D(this,r),i.apply(this,arguments)}return L(r,[{key:"render",value:function(){return this.props.children}}]),r}(t.Component),m=t.createContext(null);function Y(e){var i=e.children,r=e.onBatchResize,n=t.useRef(0),o=t.useRef([]),a=t.useContext(m),v=t.useCallback(function(f,u,l){n.current+=1;var d=n.current;o.current.push({size:f,element:u,data:l}),Promise.resolve().then(function(){d===n.current&&(r==null||r(o.current),o.current=[])}),a==null||a(f,u,l)},[r,a]);return t.createElement(m.Provider,{value:v},i)}function q(e){var i=e.children,r=e.disabled,n=t.useRef(null),o=t.useRef(null),a=t.useContext(m),v=typeof i=="function",f=v?i(n):i,u=t.useRef({width:-1,height:-1,offsetWidth:-1,offsetHeight:-1}),l=!v&&t.isValidElement(f)&&A(f),d=l?f.ref:null,I=t.useMemo(function(){return j(d,n)},[d,n]),C=t.useRef(e);C.current=e;var b=t.useCallback(function(s){var z=C.current,E=z.onResize,P=z.data,_=s.getBoundingClientRect(),p=_.width,g=_.height,h=s.offsetWidth,R=s.offsetHeight,x=Math.floor(p),w=Math.floor(g);if(u.current.width!==x||u.current.height!==w||u.current.offsetWidth!==h||u.current.offsetHeight!==R){var y={width:x,height:w,offsetWidth:h,offsetHeight:R};u.current=y;var B=h===Math.round(p)?p:h,N=R===Math.round(g)?g:R,W=k(k({},y),{},{offsetWidth:B,offsetHeight:N});a==null||a(W,s,P),E&&Promise.resolve().then(function(){E(W,s)})}},[]);return t.useEffect(function(){var s=H(n.current)||H(o.current);return s&&!r&&T(s,b),function(){return V(s,b)}},[n.current,r]),t.createElement(X,{ref:o},l?t.cloneElement(f,{ref:I}):f)}var J="rc-observer-key";function Q(e){var i=e.children,r=typeof i=="function"?[i]:F(i);return r.map(function(n,o){var a=(n==null?void 0:n.key)||"".concat(J,"-").concat(o);return t.createElement(q,$({},e,{key:a}),n)})}Q.Collection=Y;export{Q as R};
