import{i as y,f as ee,ap as we,aq as Ie,al as We,j as B,ar as N,as as Ee,at as Ae,au as X,k as je}from"./inheritsLoose.4207bb94.js";import{r as t}from"./react.8249fdc7.js";import{c as ae}from"./classnames.2e4736b8.js";import{D as Ye,b as ze,f as Re,E as Z,m as Ge,K as F}from"./rc-util.30994db3.js";var Je=200,Qe=600;function Xe(e){var l=e.prefixCls,o=e.upNode,C=e.downNode,v=e.upDisabled,m=e.downDisabled,g=e.onStep,c=t.useRef(),p=t.useRef();p.current=g;var S=function(R,k){R.preventDefault(),p.current(k);function _(){p.current(k),c.current=setTimeout(_,Je)}c.current=setTimeout(_,Qe)},s=function(){clearTimeout(c.current)};if(t.useEffect(function(){return s},[]),Ye())return null;var f="".concat(l,"-handler"),d=ae(f,"".concat(f,"-up"),y({},"".concat(f,"-up-disabled"),v)),E=ae(f,"".concat(f,"-down"),y({},"".concat(f,"-down-disabled"),m)),D={unselectable:"on",role:"button",onMouseUp:s,onMouseLeave:s};return t.createElement("div",{className:"".concat(f,"-wrap")},t.createElement("span",ee({},D,{onMouseDown:function(R){S(R,!0)},"aria-label":"Increase Value","aria-disabled":v,className:d}),o||t.createElement("span",{unselectable:"on",className:"".concat(l,"-handler-up-inner")})),t.createElement("span",ee({},D,{onMouseDown:function(R){S(R,!1)},"aria-label":"Decrease Value","aria-disabled":m,className:E}),C||t.createElement("span",{unselectable:"on",className:"".concat(l,"-handler-down-inner")})))}function ye(e){var l=typeof e=="number"?we(e):Ie(e).fullStr,o=l.includes(".");return o?Ie(l.replace(/(\d)\.(\d)/g,"$1$2.")).fullStr:e+"0"}function Ze(e,l){var o=t.useRef(null);function C(){try{var m=e.selectionStart,g=e.selectionEnd,c=e.value,p=c.substring(0,m),S=c.substring(g);o.current={start:m,end:g,value:c,beforeTxt:p,afterTxt:S}}catch{}}function v(){if(e&&o.current&&l)try{var m=e.value,g=o.current,c=g.beforeTxt,p=g.afterTxt,S=g.start,s=m.length;if(m.endsWith(p))s=m.length-o.current.afterTxt.length;else if(m.startsWith(c))s=c.length;else{var f=c[S-1],d=m.indexOf(f,S-1);d!==-1&&(s=d+1)}e.setSelectionRange(s,s)}catch(E){ze(!1,"Something warning of cursor restore. Please fire issue about this: ".concat(E.message))}}return[C,v]}const ea=function(){var e=t.useRef(0),l=function(){Re.cancel(e.current)};return t.useEffect(function(){return l},[]),function(o){l(),e.current=Re(function(){o()})}};var aa=["prefixCls","className","style","min","max","step","defaultValue","value","disabled","readOnly","upHandler","downHandler","keyboard","controls","stringMode","parser","formatter","precision","decimalSeparator","onChange","onInput","onPressEnter","onStep"],Ce=function(l,o){return l||o.isEmpty()?o.toString():o.toNumber()},De=function(l){var o=N(l);return o.isInvalidate()?null:o},na=t.forwardRef(function(e,l){var o,C=e.prefixCls,v=C===void 0?"rc-input-number":C,m=e.className,g=e.style,c=e.min,p=e.max,S=e.step,s=S===void 0?1:S,f=e.defaultValue,d=e.value,E=e.disabled,D=e.readOnly,M=e.upHandler,R=e.downHandler,k=e.keyboard,_=e.controls,he=_===void 0?!0:_,ne=e.stringMode,q=e.parser,U=e.formatter,w=e.precision,h=e.decimalSeparator,L=e.onChange,W=e.onInput,A=e.onPressEnter,j=e.onStep,Ve=We(e,aa),re="".concat(v,"-input"),O=t.useRef(null),xe=t.useState(!1),te=B(xe,2),ue=te[0],oe=te[1],I=t.useRef(!1),K=t.useRef(!1),P=t.useRef(!1),Me=t.useState(function(){return N(d??f)}),ie=B(Me,2),i=ie[0],se=ie[1];function _e(n){d===void 0&&se(n)}var Y=t.useCallback(function(n,a){if(!a)return w>=0?w:Math.max(Ee(n),Ee(s))},[w,s]),z=t.useCallback(function(n){var a=String(n);if(q)return q(a);var u=a;return h&&(u=u.replace(h,".")),u.replace(/[^\w.-]+/g,"")},[q,h]),le=t.useRef(""),ce=t.useCallback(function(n,a){if(U)return U(n,{userTyping:a,input:String(le.current)});var u=typeof n=="number"?we(n):n;if(!a){var r=Y(u,a);if(Ae(u)&&(h||r>=0)){var b=h||".";u=X(u,b,r)}}return u},[U,Y,h]),Ue=t.useState(function(){var n=f??d;return i.isInvalidate()&&["string","number"].includes(je(n))?Number.isNaN(n)?"":n:ce(i.toString(),!1)}),fe=B(Ue,2),$=fe[0],de=fe[1];le.current=$;function T(n,a){de(ce(n.isInvalidate()?n.toString(!1):n.toString(!a),a))}var V=t.useMemo(function(){return De(p)},[p,w]),x=t.useMemo(function(){return De(c)},[c,w]),ve=t.useMemo(function(){return!V||!i||i.isInvalidate()?!1:V.lessEquals(i)},[V,i]),me=t.useMemo(function(){return!x||!i||i.isInvalidate()?!1:i.lessEquals(x)},[x,i]),Ke=Ze(O.current,ue),pe=B(Ke,2),Pe=pe[0],$e=pe[1],ge=function(a){return V&&!a.lessEquals(V)?V:x&&!x.lessEquals(a)?x:null},G=function(a){return!ge(a)},J=function(a,u){var r=a,b=G(r)||r.isEmpty();if(!r.isEmpty()&&!u&&(r=ge(r)||r,b=!0),!D&&!E&&b){var H=r.toString(),Q=Y(H,u);return Q>=0&&(r=N(X(H,".",Q)),G(r)||(r=N(X(H,".",Q,!0)))),r.equals(i)||(_e(r),L==null||L(r.isEmpty()?null:Ce(ne,r)),d===void 0&&T(r,u)),r}return i},Te=ea(),Se=function n(a){if(Pe(),de(a),!K.current){var u=z(a),r=N(u);r.isNaN()||J(r,!0)}W==null||W(a),Te(function(){var b=a;q||(b=a.replace(/ã€‚/g,".")),b!==a&&n(b)})},He=function(){K.current=!0},ke=function(){K.current=!1,Se(O.current.value)},qe=function(a){Se(a.target.value)},be=function(a){var u;if(!(a&&ve||!a&&me)){I.current=!1;var r=N(P.current?ye(s):s);a||(r=r.negate());var b=(i||N(0)).add(r.toString()),H=J(b,!1);j==null||j(Ce(ne,H),{offset:P.current?ye(s):s,type:a?"up":"down"}),(u=O.current)===null||u===void 0||u.focus()}},Ne=function(a){var u=N(z($)),r=u;u.isNaN()?r=i:r=J(u,a),d!==void 0?T(i,!1):r.isNaN()||T(r,!1)},Oe=function(){I.current=!0},Be=function(a){var u=a.which,r=a.shiftKey;I.current=!0,r?P.current=!0:P.current=!1,u===F.ENTER&&(K.current||(I.current=!1),Ne(!1),A==null||A(a)),k!==!1&&!K.current&&[F.UP,F.DOWN].includes(u)&&(be(F.UP===u),a.preventDefault())},Fe=function(){I.current=!1,P.current=!1},Le=function(){Ne(!1),oe(!1),I.current=!1};return Z(function(){i.isInvalidate()||T(i,!1)},[w]),Z(function(){var n=N(d);se(n);var a=N(z($));(!n.equals(a)||!I.current||U)&&T(n,I.current)},[d]),Z(function(){U&&$e()},[$]),t.createElement("div",{className:ae(v,m,(o={},y(o,"".concat(v,"-focused"),ue),y(o,"".concat(v,"-disabled"),E),y(o,"".concat(v,"-readonly"),D),y(o,"".concat(v,"-not-a-number"),i.isNaN()),y(o,"".concat(v,"-out-of-range"),!i.isInvalidate()&&!G(i)),o)),style:g,onFocus:function(){oe(!0)},onBlur:Le,onKeyDown:Be,onKeyUp:Fe,onCompositionStart:He,onCompositionEnd:ke,onBeforeInput:Oe},he&&t.createElement(Xe,{prefixCls:v,upNode:M,downNode:R,upDisabled:ve,downDisabled:me,onStep:be}),t.createElement("div",{className:"".concat(re,"-wrap")},t.createElement("input",ee({autoComplete:"off",role:"spinbutton","aria-valuemin":c,"aria-valuemax":p,"aria-valuenow":i.isInvalidate()?null:i.toString(),step:s},Ve,{ref:Ge(O,l),className:re,value:$,onChange:qe,disabled:E,readOnly:D}))))});na.displayName="InputNumber";export{na as I};
