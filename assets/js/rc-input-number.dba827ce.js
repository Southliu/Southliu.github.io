import{f as R,h as ee,g as We,c as q,d as Ae}from"./@babel_runtime.0b96ec9f.js";import{r as a}from"./react.017637b6.js";import{c as re}from"./classnames.96a48171.js";import{B as je,a as Ye,f as Ne,C as X,j as ze,K as F}from"./rc-util.88348ebb.js";import{n as he,t as Ie,g as b,a as Ce,v as Ge,b as Z}from"./@rc-component_mini-decimal.f5d80017.js";var Je=200,Qe=600;function Xe(e){var l=e.prefixCls,u=e.upNode,y=e.downNode,v=e.upDisabled,p=e.downDisabled,x=e.onStep,c=a.exports.useRef(),m=a.exports.useRef();m.current=x;var g=function(C,B){C.preventDefault(),m.current(B);function _(){m.current(B),c.current=setTimeout(_,Je)}c.current=setTimeout(_,Qe)},i=function(){clearTimeout(c.current)};if(a.exports.useEffect(function(){return i},[]),je())return null;var f="".concat(l,"-handler"),d=re(f,"".concat(f,"-up"),R({},"".concat(f,"-up-disabled"),v)),I=re(f,"".concat(f,"-down"),R({},"".concat(f,"-down-disabled"),p)),E={unselectable:"on",role:"button",onMouseUp:i,onMouseLeave:i};return a.exports.createElement("div",{className:"".concat(f,"-wrap")},a.exports.createElement("span",ee({},E,{onMouseDown:function(C){g(C,!0)},"aria-label":"Increase Value","aria-disabled":v,className:d}),u||a.exports.createElement("span",{unselectable:"on",className:"".concat(l,"-handler-up-inner")})),a.exports.createElement("span",ee({},E,{onMouseDown:function(C){g(C,!1)},"aria-label":"Decrease Value","aria-disabled":p,className:I}),y||a.exports.createElement("span",{unselectable:"on",className:"".concat(l,"-handler-down-inner")})))}function Re(e){var l=typeof e=="number"?he(e):Ie(e).fullStr,u=l.includes(".");return u?Ie(l.replace(/(\d)\.(\d)/g,"$1$2.")).fullStr:e+"0"}function Ze(e,l){var u=a.exports.useRef(null);function y(){try{var p=e.selectionStart,x=e.selectionEnd,c=e.value,m=c.substring(0,p),g=c.substring(x);u.current={start:p,end:x,value:c,beforeTxt:m,afterTxt:g}}catch{}}function v(){if(e&&u.current&&l)try{var p=e.value,x=u.current,c=x.beforeTxt,m=x.afterTxt,g=x.start,i=p.length;if(p.endsWith(m))i=p.length-u.current.afterTxt.length;else if(p.startsWith(c))i=c.length;else{var f=c[g-1],d=p.indexOf(f,g-1);d!==-1&&(i=d+1)}e.setSelectionRange(i,i)}catch(I){Ye(!1,"Something warning of cursor restore. Please fire issue about this: ".concat(I.message))}}return[y,v]}const er=function(){var e=a.exports.useRef(0),l=function(){Ne.cancel(e.current)};return a.exports.useEffect(function(){return l},[]),function(u){l(),e.current=Ne(function(){u()})}};var rr=["prefixCls","className","style","min","max","step","defaultValue","value","disabled","readOnly","upHandler","downHandler","keyboard","controls","stringMode","parser","formatter","precision","decimalSeparator","onChange","onInput","onPressEnter","onStep"],ye=function(l,u){return l||u.isEmpty()?u.toString():u.toNumber()},Ee=function(l){var u=b(l);return u.isInvalidate()?null:u},tr=a.exports.forwardRef(function(e,l){var u,y=e.prefixCls,v=y===void 0?"rc-input-number":y,p=e.className,x=e.style,c=e.min,m=e.max,g=e.step,i=g===void 0?1:g,f=e.defaultValue,d=e.value,I=e.disabled,E=e.readOnly,M=e.upHandler,C=e.downHandler,B=e.keyboard,_=e.controls,we=_===void 0?!0:_,te=e.stringMode,O=e.parser,U=e.formatter,h=e.precision,w=e.decimalSeparator,L=e.onChange,W=e.onInput,A=e.onPressEnter,j=e.onStep,De=We(e,rr),ne="".concat(v,"-input"),k=a.exports.useRef(null),Ve=a.exports.useState(!1),ae=q(Ve,2),oe=ae[0],ue=ae[1],N=a.exports.useRef(!1),K=a.exports.useRef(!1),P=a.exports.useRef(!1),Me=a.exports.useState(function(){return b(d??f)}),se=q(Me,2),s=se[0],ie=se[1];function _e(t){d===void 0&&ie(t)}var Y=a.exports.useCallback(function(t,r){if(!r)return h>=0?h:Math.max(Ce(t),Ce(i))},[h,i]),z=a.exports.useCallback(function(t){var r=String(t);if(O)return O(r);var o=r;return w&&(o=o.replace(w,".")),o.replace(/[^\w.-]+/g,"")},[O,w]),le=a.exports.useRef(""),ce=a.exports.useCallback(function(t,r){if(U)return U(t,{userTyping:r,input:String(le.current)});var o=typeof t=="number"?he(t):t;if(!r){var n=Y(o,r);if(Ge(o)&&(w||n>=0)){var S=w||".";o=Z(o,S,n)}}return o},[U,Y,w]),Ue=a.exports.useState(function(){var t=f??d;return s.isInvalidate()&&["string","number"].includes(Ae(t))?Number.isNaN(t)?"":t:ce(s.toString(),!1)}),fe=q(Ue,2),$=fe[0],de=fe[1];le.current=$;function T(t,r){de(ce(t.isInvalidate()?t.toString(!1):t.toString(!r),r))}var D=a.exports.useMemo(function(){return Ee(m)},[m,h]),V=a.exports.useMemo(function(){return Ee(c)},[c,h]),ve=a.exports.useMemo(function(){return!D||!s||s.isInvalidate()?!1:D.lessEquals(s)},[D,s]),pe=a.exports.useMemo(function(){return!V||!s||s.isInvalidate()?!1:s.lessEquals(V)},[V,s]),Ke=Ze(k.current,oe),me=q(Ke,2),Pe=me[0],$e=me[1],xe=function(r){return D&&!r.lessEquals(D)?D:V&&!V.lessEquals(r)?V:null},G=function(r){return!xe(r)},J=function(r,o){var n=r,S=G(n)||n.isEmpty();if(!n.isEmpty()&&!o&&(n=xe(n)||n,S=!0),!E&&!I&&S){var H=n.toString(),Q=Y(H,o);return Q>=0&&(n=b(Z(H,".",Q)),G(n)||(n=b(Z(H,".",Q,!0)))),n.equals(s)||(_e(n),L==null||L(n.isEmpty()?null:ye(te,n)),d===void 0&&T(n,o)),n}return s},Te=er(),ge=function t(r){if(Pe(),de(r),!K.current){var o=z(r),n=b(o);n.isNaN()||J(n,!0)}W==null||W(r),Te(function(){var S=r;O||(S=r.replace(/ã€‚/g,".")),S!==r&&t(S)})},He=function(){K.current=!0},Be=function(){K.current=!1,ge(k.current.value)},Oe=function(r){ge(r.target.value)},Se=function(r){var o;if(!(r&&ve||!r&&pe)){N.current=!1;var n=b(P.current?Re(i):i);r||(n=n.negate());var S=(s||b(0)).add(n.toString()),H=J(S,!1);j==null||j(ye(te,H),{offset:P.current?Re(i):i,type:r?"up":"down"}),(o=k.current)===null||o===void 0||o.focus()}},be=function(r){var o=b(z($)),n=o;o.isNaN()?n=s:n=J(o,r),d!==void 0?T(s,!1):n.isNaN()||T(n,!1)},ke=function(){N.current=!0},qe=function(r){var o=r.which,n=r.shiftKey;N.current=!0,n?P.current=!0:P.current=!1,o===F.ENTER&&(K.current||(N.current=!1),be(!1),A==null||A(r)),B!==!1&&!K.current&&[F.UP,F.DOWN].includes(o)&&(Se(F.UP===o),r.preventDefault())},Fe=function(){N.current=!1,P.current=!1},Le=function(){be(!1),ue(!1),N.current=!1};return X(function(){s.isInvalidate()||T(s,!1)},[h]),X(function(){var t=b(d);ie(t);var r=b(z($));(!t.equals(r)||!N.current||U)&&T(t,N.current)},[d]),X(function(){U&&$e()},[$]),a.exports.createElement("div",{className:re(v,p,(u={},R(u,"".concat(v,"-focused"),oe),R(u,"".concat(v,"-disabled"),I),R(u,"".concat(v,"-readonly"),E),R(u,"".concat(v,"-not-a-number"),s.isNaN()),R(u,"".concat(v,"-out-of-range"),!s.isInvalidate()&&!G(s)),u)),style:x,onFocus:function(){ue(!0)},onBlur:Le,onKeyDown:qe,onKeyUp:Fe,onCompositionStart:He,onCompositionEnd:Be,onBeforeInput:ke},we&&a.exports.createElement(Xe,{prefixCls:v,upNode:M,downNode:C,upDisabled:ve,downDisabled:pe,onStep:Se}),a.exports.createElement("div",{className:"".concat(ne,"-wrap")},a.exports.createElement("input",ee({autoComplete:"off",role:"spinbutton","aria-valuemin":c,"aria-valuemax":m,"aria-valuenow":s.isInvalidate()?null:s.toString(),step:i},De,{ref:ze(k,l),className:ne,value:$,onChange:Oe,disabled:I,readOnly:E}))))});tr.displayName="InputNumber";export{tr as I};
