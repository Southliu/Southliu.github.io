import{j as I,f as j,i as Q,_ as M,h as P,al as q}from"./inheritsLoose.4207bb94.js";import{r as o}from"./react.8249fdc7.js";import{r as F}from"./react-dom.a91f01d3.js";import{a as W}from"./rc-motion.ae576133.js";import{c as w}from"./classnames.2e4736b8.js";var z=o.forwardRef(function(e,d){var y=e.prefixCls,s=e.style,m=e.className,u=e.duration,l=u===void 0?4.5:u,E=e.eventKey,p=e.content,R=e.closable,A=e.closeIcon,S=A===void 0?"x":A,h=e.props,_=e.onClick,v=e.onNoticeClose,b=e.times,$=o.useState(!1),f=I($,2),C=f[0],g=f[1],x=function(){v(E)};o.useEffect(function(){if(!C&&l>0){var t=setTimeout(function(){x()},l*1e3);return function(){clearTimeout(t)}}},[l,C,b]);var c="".concat(y,"-notice");return o.createElement("div",j({},h,{ref:d,className:w(c,m,Q({},"".concat(c,"-closable"),R)),style:s,onMouseEnter:function(){g(!0)},onMouseLeave:function(){g(!1)},onClick:_}),o.createElement("div",{className:"".concat(c,"-content")},p),R&&o.createElement("a",{tabIndex:0,className:"".concat(c,"-close"),onClick:function(n){n.preventDefault(),n.stopPropagation(),x()}},S))});const B=z;var J=o.forwardRef(function(e,d){var y=e.prefixCls,s=y===void 0?"rc-notification":y,m=e.container,u=e.motion,l=e.maxCount,E=e.className,p=e.style,R=e.onAllRemoved,A=o.useState([]),S=I(A,2),h=S[0],_=S[1],v=function(n){var i,a=h.find(function(r){return r.key===n});a==null||(i=a.onClose)===null||i===void 0||i.call(a),_(function(r){return r.filter(function(k){return k.key!==n})})};o.useImperativeHandle(d,function(){return{open:function(n){_(function(i){var a=M(i),r=a.findIndex(function(L){return L.key===n.key}),k=P({},n);if(r>=0){var N;k.times=(((N=i[r])===null||N===void 0?void 0:N.times)||0)+1,a[r]=k}else k.times=0,a.push(k);return l>0&&a.length>l&&(a=a.slice(-l)),a})},close:function(n){v(n)},destroy:function(){_([])}}});var b=o.useState({}),$=I(b,2),f=$[0],C=$[1];o.useEffect(function(){var t={};h.forEach(function(n){var i=n.placement,a=i===void 0?"topRight":i;a&&(t[a]=t[a]||[],t[a].push(n))}),Object.keys(f).forEach(function(n){t[n]=t[n]||[]}),C(t)},[h]);var g=function(n){C(function(i){var a=P({},i),r=a[n]||[];return r.length||delete a[n],a})},x=o.useRef(!1);if(o.useEffect(function(){Object.keys(f).length>0?x.current=!0:x.current&&(R==null||R(),x.current=!1)},[f]),!m)return null;var c=Object.keys(f);return F.createPortal(o.createElement(o.Fragment,null,c.map(function(t){var n=f[t],i=n.map(function(r){return{config:r,key:r.key}}),a=typeof u=="function"?u(t):u;return o.createElement(W,j({key:t,className:w(s,"".concat(s,"-").concat(t),E==null?void 0:E(t)),style:p==null?void 0:p(t),keys:i,motionAppear:!0},a,{onAllRemoved:function(){g(t)}}),function(r,k){var N=r.config,L=r.className,T=r.style,K=N.key,H=N.times,D=N.className,G=N.style;return o.createElement(B,j({},N,{ref:k,prefixCls:s,className:w(L,D),style:P(P({},T),G),times:H,key:K,eventKey:K,onNoticeClose:v}))})})),m)}),U=["getContainer","motion","prefixCls","maxCount","className","style","onAllRemoved"],V=function(){return document.body},O=0;function X(){for(var e={},d=arguments.length,y=new Array(d),s=0;s<d;s++)y[s]=arguments[s];return y.forEach(function(m){m&&Object.keys(m).forEach(function(u){var l=m[u];l!==void 0&&(e[u]=l)})}),e}function oe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},d=e.getContainer,y=d===void 0?V:d,s=e.motion,m=e.prefixCls,u=e.maxCount,l=e.className,E=e.style,p=e.onAllRemoved,R=q(e,U),A=o.useState(),S=I(A,2),h=S[0],_=S[1],v=o.useRef(),b=o.createElement(J,{container:h,ref:v,prefixCls:m,motion:s,maxCount:u,className:l,style:E,onAllRemoved:p}),$=o.useState([]),f=I($,2),C=f[0],g=f[1],x=o.useMemo(function(){return{open:function(t){var n=X(R,t);(n.key===null||n.key===void 0)&&(n.key="rc-notification-".concat(O),O+=1),g(function(i){return[].concat(M(i),[{type:"open",config:n}])})},close:function(t){g(function(n){return[].concat(M(n),[{type:"close",key:t}])})},destroy:function(){g(function(t){return[].concat(M(t),[{type:"destroy"}])})}}},[]);return o.useEffect(function(){_(y())}),o.useEffect(function(){v.current&&C.length&&(C.forEach(function(c){switch(c.type){case"open":v.current.open(c.config);break;case"close":v.current.close(c.key);break;case"destroy":v.current.destroy();break}}),g([]))},[C]),[x,b]}export{B as N,oe as u};
