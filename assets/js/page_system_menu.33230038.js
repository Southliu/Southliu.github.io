import{j as s,r as n}from"./react.402eeaf7.js";import{I as B,S as M,r as i,A as $,c as ae}from"./components_Business.97a40718.js";import{M as I,d as R,e as ne}from"./components_Dates.ce0ac0d1.js";import{v as se}from"./components_Count.3df16e01.js";import{u as oe}from"./page_content_article.b28bf86b.js";import{c as S}from"./layouts.81f68454.js";import{u as re}from"./components_Fullscreen.dc33051e.js";import{U as ie,D as ce}from"./components_Buttons.72d70265.js";import{B as le}from"./components_Content.6a26484c.js";import{B as ue}from"./components_Search.00df5fcf.js";import{B as me}from"./components_Modal.4a9be453.js";import{B as pe}from"./components_Form.e497ef41.js";import{B as de}from"./components_Table.240f2427.js";import{B as fe}from"./components_Pagination.752ec5df.js";import{m as ge}from"./antd.2a715811.js";const U=[{label:"状态",name:"status",component:"Select",componentProps:{options:I}},{label:"模块",name:"module",wrapperCol:170,component:"Select",componentProps:{options:R}},{label:"控制器",name:"controller",component:"Input"}],F=e=>[{title:"ID",dataIndex:"id",width:200},{title:"名称",dataIndex:"name",width:200},{title:"状态",dataIndex:"status",width:200,render:r=>s.jsx("span",{children:se(r,I)})},{title:"模块",dataIndex:"module",width:200},{title:"控制器",dataIndex:"controller",width:200},{title:"创建时间",dataIndex:"created_at",width:200},{title:"更新时间",dataIndex:"updated_at",width:200},{title:"操作",dataIndex:"operate",width:200,fixed:"right",render:(r,C)=>e(r,C)}],O=e=>[{label:"名称",name:"name",rules:B,component:"Input"},{label:"状态",name:"status",rules:M,component:"Select",componentProps:{options:I}},{label:"模块",name:"module",rules:M,component:"Select",componentProps:{options:R}},{label:"控制器",name:"controller",rules:B,component:"Input"},{label:"创建菜单",name:"actions",hidden:!!e,component:"CheckboxGroup",componentProps:{options:ne}}],Oe=Object.freeze(Object.defineProperty({__proto__:null,createList:O,searchList:U,tableColumns:F},Symbol.toStringTag,{value:"Module"}));function he(e){return i.get("/authority/menu/index",{params:e})}function Se(e){return i.get(`/authority/menu/${e}`)}function xe(e){return i.post("/authority/menu",e)}function Ce(e,r){return i.put(`/authority/menu/${e}`,r)}function be(e){return i.delete(`/authority/menu/${e}`)}function ze(e){return i.get("/authority/menu/tree",{params:e})}function Ne(e){return i.put("/authority/menu/authorize/save",e)}const x={page:1,pageSize:20},L={status:1};function ye(){oe("菜单管理");const e=n.useRef(null),r=n.useRef(null),[C,m]=n.useState(!1),[u,p]=n.useState(!1),[z,d]=n.useState(!1),[N,P]=n.useState($),[b,T]=n.useState(""),[k,D]=n.useState(L),[_,j]=n.useState(x.page),[y,v]=n.useState(x.pageSize),[A,Q]=n.useState(0),[V,q]=n.useState([]),[E,G]=ge.useMessage(),{permissions:f}=re(),g="/authority/menu",c={page:S(`${g}/index`,f),create:S(`${g}/create`,f),update:S(`${g}/update`,f),delete:S(`${g}/delete`,f)},H=t=>{j(1),l({page:1,pageSize:y,...t})},l=n.useCallback(async t=>{try{p(!0);const{data:a}=await he(t),{items:o,total:h}=a;Q(h),q(o)}finally{p(!1)}},[]);n.useEffect(()=>{c.page&&l({...x})},[l,c.page]);const J=()=>{m(!0),P($),T(""),D(L)},K=async t=>{try{m(!0),P(ae(t)),T(t),d(!0);const{data:a}=await Se(t);D(a)}finally{d(!1)}},W=()=>{var t;(t=r.current)==null||t.handleSubmit()},X=()=>{m(!1)},w=()=>{var o;const a={...((o=e.current)==null?void 0:o.getFieldsValue())||{},page:_,pageSize:y};l(a)},Y=async t=>{try{d(!0);const a=()=>b?Ce(b,t):xe(t),{data:o}=await a();E.success((o==null?void 0:o.message)||"操作成功"),m(!1),w()}finally{d(!1)}},Z=async t=>{try{p(!0);const a=await be(t);(a==null?void 0:a.code)===200&&(E.success((a==null?void 0:a.message)||"删除成功"),w())}finally{p(!1)}},ee=n.useCallback((t,a)=>{var h;j(t),v(a);const o=(h=e.current)==null?void 0:h.getFieldsValue();l({...o,page:t,pageSize:a})},[l]),te=(t,a)=>s.jsxs(s.Fragment,{children:[c.update===!0&&s.jsx(ie,{className:"mr-5px",isLoading:u,onClick:()=>K(a.id)}),c.delete===!0&&s.jsx(ce,{className:"mr-5px",isLoading:u,handleDelete:()=>Z(a.id)})]});return s.jsx(le,{isPermission:c.page,children:s.jsxs(s.Fragment,{children:[G,s.jsx(ue,{formRef:e,list:U,data:x,isLoading:u,isCreate:c.create,onCreate:J,handleFinish:H}),s.jsx(de,{loading:u,columns:F(te),dataSource:V}),s.jsx(fe,{disabled:u,current:_,pageSize:y,total:A,onChange:ee}),s.jsx(me,{width:600,title:N,open:C,confirmLoading:z,onOk:W,onCancel:X,children:s.jsx(pe,{formRef:r,list:O(b),data:k,labelCol:{span:4},wrapperCol:{span:19},handleFinish:Y})})]})})}const ke=Object.freeze(Object.defineProperty({__proto__:null,default:ye},Symbol.toStringTag,{value:"Module"}));export{ze as g,ke as i,Oe as m,Ne as s};
