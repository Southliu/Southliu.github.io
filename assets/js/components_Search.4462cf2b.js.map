{"version":3,"file":"components_Search.4462cf2b.js","sources":["../../../src/components/Search/BasicSearch.tsx"],"sourcesContent":["import { ReactNode, Ref, useImperativeHandle } from 'react'\nimport type { IFormData, IFormList } from '#/form'\nimport type { ColProps } from 'antd'\nimport type { IFormFn } from '../Form/BasicForm'\nimport { memo } from 'react'\nimport { Button, FormProps } from 'antd'\nimport { Form } from 'antd'\nimport { SearchOutlined, PlusOutlined } from '@ant-design/icons'\nimport { getComponent } from '../Form/utils/componentMap'\nimport { handleValuePropName } from '../Form/utils/helper'\nimport { filterDayjs } from '../Dates/utils/helper'\n\ninterface IProps {\n  list: IFormList[];\n  data: IFormData;\n  isLoading?: boolean;\n  isSearch?: boolean;\n  isCreate?: boolean;\n  children?: ReactNode;\n  labelCol?: Partial<ColProps>;\n  wrapperCol?: Partial<ColProps>;\n  formRef?: Ref<IFormFn>;\n  onCreate?: () => void;\n  handleFinish: FormProps['onFinish'];\n}\n\nfunction BasicSearch(props: IProps) {\n  const {\n    list,\n    data,\n    formRef,\n    isLoading,\n    isSearch,\n    isCreate,\n    children,\n    labelCol,\n    wrapperCol,\n    handleFinish\n  } = props\n  const [form] = Form.useForm()\n\n  // 抛出外部方法\n  useImperativeHandle(\n    formRef,\n    () => ({\n      /**\n       * 获取表单值\n       * @param key - 表单唯一值\n       */\n      getFieldValue: (key: string) => {\n        return form.getFieldValue(key)\n      },\n      /** 获取表单全部值 */\n      getFieldsValue: () => {\n        return form.getFieldsValue()\n      },\n      /** 重置表单 */\n      handleReset: () => {\n        form.resetFields()\n      },\n      /** 提交表单  */\n      handleSubmit: () => {\n        form.submit()\n      }\n    } as IFormFn)\n  )\n\n  /** 点击新增 */\n  const onCreate = () => {\n    props.onCreate?.()\n  }\n\n  /**\n   * 提交表单\n   * @param values - 表单值\n   */\n  const onFinish: FormProps['onFinish'] = values => {\n    if (handleFinish) {\n      // 将dayjs类型转为字符串\n      const params = filterDayjs(values, list)\n      handleFinish?.(params)\n    }\n  }\n  \n  /**\n   * 表单提交失败处理\n   * @param errorInfo - 错误信息\n   */\n  const onFinishFailed: FormProps['onFinishFailed'] = errorInfo => {\n    console.warn('搜索错误:', errorInfo)\n  }\n\n  return (\n    <div id=\"searches\" className=\"py-3\">\n      <Form\n        name=\"basic\"\n        layout=\"inline\"\n        form={form}\n        labelCol={labelCol ? labelCol : { span: 8 }}\n        wrapperCol={wrapperCol ? wrapperCol : { span: 16 }}\n        initialValues={data}\n        onFinish={onFinish}\n        onFinishFailed={onFinishFailed}\n        autoComplete=\"off\"\n      >\n        {\n          list?.map(item => (\n            <Form.Item\n              key={`${item.name}`}\n              label={item.label}\n              name={item.name}\n              className='!mb-5px'\n              labelCol={{ style: { width: item.labelCol } }}\n              wrapperCol={{ style: { width: item.wrapperCol } }}\n              rules={item.rules}\n              valuePropName={handleValuePropName(item.component)}\n            >\n              { getComponent(item) }\n            </Form.Item>\n          ))\n        }\n\n        {\n          isSearch !== false &&\n          <Form.Item>\n            <Button\n              type=\"primary\"\n              htmlType=\"submit\"\n              className='!mb-5px'\n              loading={isLoading}\n              icon={<SearchOutlined />}\n            >\n              搜索\n            </Button>\n          </Form.Item>\n        }\n\n        {\n          isCreate !== false &&\n          <Form.Item>\n            <Button\n              type=\"primary\"\n              className='!mb-5px'\n              icon={<PlusOutlined />}\n              onClick={onCreate}\n          >\n              新增\n            </Button>\n          </Form.Item>\n        }\n\n        { children }\n      </Form>\n    </div>\n  )\n}\n\nexport default memo(BasicSearch)"],"names":["BasicSearch","props","list","data","formRef","isLoading","isSearch","isCreate","children","labelCol","wrapperCol","handleFinish","form","Form","useImperativeHandle","key","onCreate","_a","jsx","jsxs","values","params","filterDayjs","errorInfo","item","handleValuePropName","Button","SearchOutlined","PlusOutlined","memo"],"mappings":"wTA0BA,SAASA,EAAYC,EAAe,CAC5B,KAAA,CACJ,KAAAC,EACA,KAAAC,EACA,QAAAC,EACA,UAAAC,EACA,SAAAC,EACA,SAAAC,EACA,SAAAC,EACA,SAAAC,EACA,WAAAC,EACA,aAAAC,CACE,EAAAV,EACE,CAACW,CAAI,EAAIC,EAAK,QAAQ,EAG5BC,EAAA,oBACEV,EACA,KAAO,CAKL,cAAgBW,GACPH,EAAK,cAAcG,CAAG,EAG/B,eAAgB,IACPH,EAAK,iBAGd,YAAa,IAAM,CACjBA,EAAK,YAAY,CACnB,EAEA,aAAc,IAAM,CAClBA,EAAK,OAAO,CACd,CAAA,EACF,EAIF,MAAMI,EAAW,IAAM,QACrBC,EAAAhB,EAAM,WAAN,MAAAgB,EAAA,KAAAhB,EAAiB,EAuBnB,OACGiB,EAAA,MAAA,CAAI,GAAG,WAAW,UAAU,OAC3B,SAAAC,EAACN,EAAA,CACC,KAAK,QACL,OAAO,SACP,KAAAD,EACA,SAAUH,GAAsB,CAAE,KAAM,CAAE,EAC1C,WAAYC,GAA0B,CAAE,KAAM,EAAG,EACjD,cAAeP,EACf,SAzB4CiB,GAAA,CAChD,GAAIT,EAAc,CAEV,MAAAU,EAASC,EAAYF,EAAQlB,CAAI,EACvCS,GAAA,MAAAA,EAAeU,EACjB,CAAA,EAqBI,eAd2DE,GAAA,CACvD,QAAA,KAAK,QAASA,CAAS,CAAA,EAc3B,aAAa,MAGX,SAAA,CAAArB,GAAA,YAAAA,EAAM,IACJsB,GAAAN,EAACL,EAAK,KAAL,CAEC,MAAOW,EAAK,MACZ,KAAMA,EAAK,KACX,UAAU,UACV,SAAU,CAAE,MAAO,CAAE,MAAOA,EAAK,SAAW,EAC5C,WAAY,CAAE,MAAO,CAAE,MAAOA,EAAK,WAAa,EAChD,MAAOA,EAAK,MACZ,cAAeC,EAAoBD,EAAK,SAAS,EAE/C,WAAaA,CAAI,CAAA,EATd,GAAGA,EAAK,MAAA,GAejBlB,IAAa,IACZY,EAAAL,EAAK,KAAL,CACC,SAAAK,EAACQ,EAAA,CACC,KAAK,UACL,SAAS,SACT,UAAU,UACV,QAASrB,EACT,OAAOsB,EAAe,EAAA,EACvB,SAAA,IAAA,CAAA,EAGH,EAIApB,IAAa,IACZW,EAAAL,EAAK,KAAL,CACC,SAAAK,EAACQ,EAAA,CACC,KAAK,UACL,UAAU,UACV,OAAOE,EAAa,EAAA,EACpB,QAASZ,EACZ,SAAA,IAAA,CAAA,EAGD,EAGAR,CAAA,CAAA,CAEN,CAAA,CAAA,CAEJ,CAEA,MAAeqB,EAAAA,EAAAA,KAAK7B,CAAW"}