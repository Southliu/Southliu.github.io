{"version":3,"file":"rc-align.ce22d2ce.js","sources":["../../../node_modules/.pnpm/rc-align@4.0.15_biqbaboplfbrettd7655fr4n2y/node_modules/rc-align/es/hooks/useBuffer.js","../../../node_modules/.pnpm/rc-align@4.0.15_biqbaboplfbrettd7655fr4n2y/node_modules/rc-align/es/util.js","../../../node_modules/.pnpm/rc-align@4.0.15_biqbaboplfbrettd7655fr4n2y/node_modules/rc-align/es/Align.js"],"sourcesContent":["import React from 'react';\nexport default (function (callback, buffer) {\n  var calledRef = React.useRef(false);\n  var timeoutRef = React.useRef(null);\n\n  function cancelTrigger() {\n    window.clearTimeout(timeoutRef.current);\n  }\n\n  function trigger(force) {\n    cancelTrigger();\n\n    if (!calledRef.current || force === true) {\n      if (callback(force) === false) {\n        // Not delay since callback cancelled self\n        return;\n      }\n\n      calledRef.current = true;\n      timeoutRef.current = window.setTimeout(function () {\n        calledRef.current = false;\n      }, buffer);\n    } else {\n      timeoutRef.current = window.setTimeout(function () {\n        calledRef.current = false;\n        trigger();\n      }, buffer);\n    }\n  }\n\n  return [trigger, function () {\n    calledRef.current = false;\n    cancelTrigger();\n  }];\n});","import _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport ResizeObserver from 'resize-observer-polyfill';\nimport contains from \"rc-util/es/Dom/contains\";\nexport function isSamePoint(prev, next) {\n  if (prev === next) return true;\n  if (!prev || !next) return false;\n\n  if ('pageX' in next && 'pageY' in next) {\n    return prev.pageX === next.pageX && prev.pageY === next.pageY;\n  }\n\n  if ('clientX' in next && 'clientY' in next) {\n    return prev.clientX === next.clientX && prev.clientY === next.clientY;\n  }\n\n  return false;\n}\nexport function restoreFocus(activeElement, container) {\n  // Focus back if is in the container\n  if (activeElement !== document.activeElement && contains(container, activeElement) && typeof activeElement.focus === 'function') {\n    activeElement.focus();\n  }\n}\nexport function monitorResize(element, callback) {\n  var prevWidth = null;\n  var prevHeight = null;\n\n  function onResize(_ref) {\n    var _ref2 = _slicedToArray(_ref, 1),\n        target = _ref2[0].target;\n\n    if (!document.documentElement.contains(target)) return;\n\n    var _target$getBoundingCl = target.getBoundingClientRect(),\n        width = _target$getBoundingCl.width,\n        height = _target$getBoundingCl.height;\n\n    var fixedWidth = Math.floor(width);\n    var fixedHeight = Math.floor(height);\n\n    if (prevWidth !== fixedWidth || prevHeight !== fixedHeight) {\n      // https://webkit.org/blog/9997/resizeobserver-in-webkit/\n      Promise.resolve().then(function () {\n        callback({\n          width: fixedWidth,\n          height: fixedHeight\n        });\n      });\n    }\n\n    prevWidth = fixedWidth;\n    prevHeight = fixedHeight;\n  }\n\n  var resizeObserver = new ResizeObserver(onResize);\n\n  if (element) {\n    resizeObserver.observe(element);\n  }\n\n  return function () {\n    resizeObserver.disconnect();\n  };\n}","import _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _typeof from \"@babel/runtime/helpers/esm/typeof\";\n\n/**\n * Removed props:\n *  - childrenProps\n */\nimport { alignElement, alignPoint } from 'dom-align';\nimport isEqual from \"rc-util/es/isEqual\";\nimport addEventListener from \"rc-util/es/Dom/addEventListener\";\nimport isVisible from \"rc-util/es/Dom/isVisible\";\nimport useLayoutEffect from \"rc-util/es/hooks/useLayoutEffect\";\nimport { composeRef } from \"rc-util/es/ref\";\nimport React from 'react';\nimport useBuffer from \"./hooks/useBuffer\";\nimport { isSamePoint, monitorResize, restoreFocus } from \"./util\";\n\nfunction getElement(func) {\n  if (typeof func !== 'function') return null;\n  return func();\n}\n\nfunction getPoint(point) {\n  if (_typeof(point) !== 'object' || !point) return null;\n  return point;\n}\n\nvar Align = function Align(_ref, ref) {\n  var children = _ref.children,\n      disabled = _ref.disabled,\n      target = _ref.target,\n      align = _ref.align,\n      onAlign = _ref.onAlign,\n      monitorWindowResize = _ref.monitorWindowResize,\n      _ref$monitorBufferTim = _ref.monitorBufferTime,\n      monitorBufferTime = _ref$monitorBufferTim === void 0 ? 0 : _ref$monitorBufferTim;\n  var cacheRef = React.useRef({});\n  /** Popup node ref */\n\n  var nodeRef = React.useRef();\n  var childNode = React.Children.only(children); // ===================== Align ======================\n  // We save the props here to avoid closure makes props ood\n\n  var forceAlignPropsRef = React.useRef({});\n  forceAlignPropsRef.current.disabled = disabled;\n  forceAlignPropsRef.current.target = target;\n  forceAlignPropsRef.current.align = align;\n  forceAlignPropsRef.current.onAlign = onAlign;\n\n  var _useBuffer = useBuffer(function () {\n    var _forceAlignPropsRef$c = forceAlignPropsRef.current,\n        latestDisabled = _forceAlignPropsRef$c.disabled,\n        latestTarget = _forceAlignPropsRef$c.target,\n        latestAlign = _forceAlignPropsRef$c.align,\n        latestOnAlign = _forceAlignPropsRef$c.onAlign;\n    var source = nodeRef.current;\n\n    if (!latestDisabled && latestTarget && source) {\n      var _result;\n\n      var _element = getElement(latestTarget);\n\n      var _point = getPoint(latestTarget);\n\n      cacheRef.current.element = _element;\n      cacheRef.current.point = _point;\n      cacheRef.current.align = latestAlign; // IE lose focus after element realign\n      // We should record activeElement and restore later\n\n      var _document = document,\n          activeElement = _document.activeElement; // We only align when element is visible\n\n      if (_element && isVisible(_element)) {\n        _result = alignElement(source, _element, latestAlign);\n      } else if (_point) {\n        _result = alignPoint(source, _point, latestAlign);\n      }\n\n      restoreFocus(activeElement, source);\n\n      if (latestOnAlign && _result) {\n        latestOnAlign(source, _result);\n      }\n\n      return true;\n    }\n\n    return false;\n  }, monitorBufferTime),\n      _useBuffer2 = _slicedToArray(_useBuffer, 2),\n      _forceAlign = _useBuffer2[0],\n      cancelForceAlign = _useBuffer2[1]; // ===================== Effect =====================\n  // Handle props change\n\n\n  var _React$useState = React.useState(),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      element = _React$useState2[0],\n      setElement = _React$useState2[1];\n\n  var _React$useState3 = React.useState(),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      point = _React$useState4[0],\n      setPoint = _React$useState4[1];\n\n  useLayoutEffect(function () {\n    setElement(getElement(target));\n    setPoint(getPoint(target));\n  });\n  React.useEffect(function () {\n    if (cacheRef.current.element !== element || !isSamePoint(cacheRef.current.point, point) || !isEqual(cacheRef.current.align, align)) {\n      _forceAlign();\n    }\n  }); // Watch popup element resize\n\n  React.useEffect(function () {\n    var cancelFn = monitorResize(nodeRef.current, _forceAlign);\n    return cancelFn;\n  }, [nodeRef.current]); // Watch target element resize\n\n  React.useEffect(function () {\n    var cancelFn = monitorResize(element, _forceAlign);\n    return cancelFn;\n  }, [element]); // Listen for disabled change\n\n  React.useEffect(function () {\n    if (!disabled) {\n      _forceAlign();\n    } else {\n      cancelForceAlign();\n    }\n  }, [disabled]); // Listen for window resize\n\n  React.useEffect(function () {\n    if (monitorWindowResize) {\n      var cancelFn = addEventListener(window, 'resize', _forceAlign);\n      return cancelFn.remove;\n    }\n  }, [monitorWindowResize]); // Clear all if unmount\n\n  React.useEffect(function () {\n    return function () {\n      cancelForceAlign();\n    };\n  }, []); // ====================== Ref =======================\n\n  React.useImperativeHandle(ref, function () {\n    return {\n      forceAlign: function forceAlign() {\n        return _forceAlign(true);\n      }\n    };\n  }); // ===================== Render =====================\n\n  if ( /*#__PURE__*/React.isValidElement(childNode)) {\n    childNode = /*#__PURE__*/React.cloneElement(childNode, {\n      ref: composeRef(childNode.ref, nodeRef)\n    });\n  }\n\n  return childNode;\n};\n\nvar RcAlign = /*#__PURE__*/React.forwardRef(Align);\nRcAlign.displayName = 'Align';\nexport default RcAlign;"],"names":["useBuffer","callback","buffer","calledRef","React","timeoutRef","cancelTrigger","trigger","force","isSamePoint","prev","next","restoreFocus","activeElement","container","contains","monitorResize","element","prevWidth","prevHeight","onResize","_ref","_ref2","_slicedToArray","target","_target$getBoundingCl","width","height","fixedWidth","fixedHeight","resizeObserver","ResizeObserver","getElement","func","getPoint","point","_typeof","Align","ref","children","disabled","align","onAlign","monitorWindowResize","_ref$monitorBufferTim","monitorBufferTime","cacheRef","nodeRef","childNode","forceAlignPropsRef","_useBuffer","_forceAlignPropsRef$c","latestDisabled","latestTarget","latestAlign","latestOnAlign","source","_result","_element","_point","_document","isVisible","alignElement","alignPoint","_useBuffer2","_forceAlign","cancelForceAlign","_React$useState","_React$useState2","setElement","_React$useState3","_React$useState4","setPoint","useLayoutEffect","isEqual","cancelFn","addEventListener","composeRef","RcAlign"],"mappings":"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"}