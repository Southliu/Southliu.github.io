import{x as e,d as t,u as n,K as r,B as a}from"./rc-util@5.39.1_react-dom@18.2.0_react@18.2.0.BMjVa3px.js";import{d as o,g as l,c as i,b as u,e as c,h as d,f as s}from"./@babel_runtime@7.24.4.BmQrySDS.js";import{u as f,b as v,B as p}from"./rc-select@14.13.1_react-dom@18.2.0_react@18.2.0.DGItyltr.js";import{r as h}from"./react@18.2.0.BNo5BOs9.js";import{a as m,c as y,T as g}from"./rc-tree@5.8.5_react-dom@18.2.0_react@18.2.0.DioUWMB5.js";import"./classnames@2.5.1.C42auVll.js";import"./react-is@18.2.0.D9jp0pkd.js";import"./rc-overflow@1.3.2_react-dom@18.2.0_react@18.2.0.BzKyFbWL.js";import"./react-dom@18.2.0_react@18.2.0.D5_AXEzi.js";import"./rc-resize-observer@1.4.0_react-dom@18.2.0_react@18.2.0.Ce4aG0LA.js";import"./rc-motion@2.9.0_react-dom@18.2.0_react@18.2.0.DQ5U7wVb.js";function b(e){return!e||e.disabled||e.disableCheckbox||!1===e.checkable}function k(e){return null==e}var C=function(){return null},E=["children","value"];function w(t){return e(t).map((function(e){if(!h.isValidElement(e)||!e.type)return null;var t=e,n=t.key,r=t.props,a=r.children,l=r.value,u=i(r,E),c=o({key:n,value:l},u),d=w(a);return d.length&&(c.children=d),c})).filter((function(e){return e}))}function S(e){if(!e)return e;var n=o({},e);return"props"in n||Object.defineProperty(n,"props",{get:function(){return t(!1,"New `rc-tree-select` not support return node instance as argument anymore. Please consider to remove `props` access."),n}}),n}function x(e){var t=h.useRef();t.current=e;var n=h.useCallback((function(){return t.current.apply(t,arguments)}),[]);return n}function D(e,t,n){return h.useMemo((function(){return e?n?function(e,t){var n=t.id,r=t.pId,a=t.rootPId,l={},i=[];return e.map((function(e){var t=o({},e),r=t[n];return l[r]=t,t.key=t.key||r,t})).forEach((function(e){var t=e[r],n=l[t];n&&(n.children=n.children||[],n.children.push(e)),(t===a||!n&&null===a)&&i.push(e)})),i}(e,o({id:"id",pId:"pId",rootPId:null},!0!==n?n:{})):e:w(t)}),[t,n,e])}var I=h.createContext(null),N=h.createContext(null),T={width:0,height:0,display:"flex",overflow:"hidden",opacity:0,border:0,padding:0,margin:0},L=function(e,t){var a=f(),o=a.prefixCls,i=a.multiple,u=a.searchValue,s=a.toggleOpen,v=a.open,p=a.notFoundContent,m=h.useContext(N),y=m.virtual,k=m.listHeight,C=m.listItemHeight,E=m.listItemScrollOffset,w=m.treeData,S=m.fieldNames,x=m.onSelect,D=m.dropdownMatchSelectWidth,L=m.treeExpandAction,M=m.treeTitleRender,K=h.useContext(I),V=K.checkable,O=K.checkedKeys,P=K.halfCheckedKeys,_=K.treeExpandedKeys,H=K.treeDefaultExpandAll,A=K.treeDefaultExpandedKeys,R=K.onTreeExpand,j=K.treeIcon,W=K.showTreeIcon,F=K.switcherIcon,U=K.treeLine,B=K.treeNodeFilterProp,G=K.loadData,z=K.treeLoadedKeys,J=K.treeMotion,q=K.onTreeLoad,Q=K.keyEntities,X=h.useRef(),Y=n((function(){return w}),[v,w],(function(e,t){return t[0]&&e[1]!==t[1]})),Z=h.useState(null),$=c(Z,2),ee=$[0],te=$[1],ne=Q[ee],re=h.useMemo((function(){return V?{checked:O,halfChecked:P}:null}),[V,O,P]);h.useEffect((function(){var e;v&&!i&&O.length&&(null===(e=X.current)||void 0===e||e.scrollTo({key:O[0]}),te(O[0]))}),[v]);var ae=String(u).toLowerCase(),oe=h.useState(A),le=c(oe,2),ie=le[0],ue=le[1],ce=h.useState(null),de=c(ce,2),se=de[0],fe=de[1],ve=h.useMemo((function(){return _?l(_):u?se:ie}),[ie,se,_,u]);h.useEffect((function(){u&&fe(function(e,t){var n=[];return function e(r){r.forEach((function(r){var a=r[t.children];a&&(n.push(r[t.value]),e(a))}))}(e),n}(w,S))}),[u]);var pe=function(e){e.preventDefault()},he=function(e,t){var n=t.node;V&&b(n)||(x(n.key,{selected:!O.includes(n.key)}),i||s(!1))};if(h.useImperativeHandle(t,(function(){var e;return{scrollTo:null===(e=X.current)||void 0===e?void 0:e.scrollTo,onKeyDown:function(e){var t;switch(e.which){case r.UP:case r.DOWN:case r.LEFT:case r.RIGHT:null===(t=X.current)||void 0===t||t.onKeyDown(e);break;case r.ENTER:if(ne){var n=(null==ne?void 0:ne.node)||{},a=n.selectable,o=n.value;!1!==a&&he(0,{node:{key:ee},selected:!O.includes(o)})}break;case r.ESC:s(!1)}},onKeyUp:function(){}}})),0===Y.length)return h.createElement("div",{role:"listbox",className:"".concat(o,"-empty"),onMouseDown:pe},p);var me={fieldNames:S};return z&&(me.loadedKeys=z),ve&&(me.expandedKeys=ve),h.createElement("div",{onMouseDown:pe},ne&&v&&h.createElement("span",{style:T,"aria-live":"assertive"},ne.node.value),h.createElement(g,d({ref:X,focusable:!1,prefixCls:"".concat(o,"-tree"),treeData:Y,height:k,itemHeight:C,itemScrollOffset:E,virtual:!1!==y&&!1!==D,multiple:i,icon:j,showIcon:W,switcherIcon:F,showLine:U,loadData:u?null:G,motion:J,activeKey:ee,checkable:V,checkStrictly:!0,checkedKeys:re,selectedKeys:V?[]:O,defaultExpandAll:H,titleRender:M},me,{onActiveChange:te,onSelect:he,onCheck:he,onExpand:function(e){ue(e),fe(e),R&&R(e)},onLoad:q,filterTreeNode:function(e){return!!ae&&String(e[B]).toLowerCase().includes(ae)},expandAction:L})))},M=h.forwardRef(L),K="SHOW_ALL",V="SHOW_PARENT",O="SHOW_CHILD";function P(e,t,n,r){var a=new Set(e);return t===O?e.filter((function(e){var t=n[e];return!(t&&t.children&&t.children.some((function(e){var t=e.node;return a.has(t[r.value])}))&&t.children.every((function(e){var t=e.node;return b(t)||a.has(t[r.value])})))})):t===V?e.filter((function(e){var t=n[e],r=t?t.parent:null;return!(r&&!b(r.node)&&a.has(r.key))})):e}var _=["id","prefixCls","value","defaultValue","onChange","onSelect","onDeselect","searchValue","inputValue","onSearch","autoClearSearchValue","filterTreeNode","treeNodeFilterProp","showCheckedStrategy","treeNodeLabelProp","multiple","treeCheckable","treeCheckStrictly","labelInValue","fieldNames","treeDataSimpleMode","treeData","children","loadData","treeLoadedKeys","onTreeLoad","treeDefaultExpandAll","treeExpandedKeys","treeDefaultExpandedKeys","onTreeExpand","treeExpandAction","virtual","listHeight","listItemHeight","listItemScrollOffset","onDropdownVisibleChange","dropdownMatchSelectWidth","treeLine","treeIcon","showTreeIcon","switcherIcon","treeMotion","treeTitleRender"];var H=h.forwardRef((function(e,n){var r,f,g=e.id,b=e.prefixCls,E=void 0===b?"rc-tree-select":b,w=e.value,T=e.defaultValue,L=e.onChange,V=e.onSelect,H=e.onDeselect,A=e.searchValue,R=e.inputValue,j=e.onSearch,W=e.autoClearSearchValue,F=void 0===W||W,U=e.filterTreeNode,B=e.treeNodeFilterProp,G=void 0===B?"value":B,z=e.showCheckedStrategy,J=e.treeNodeLabelProp,q=e.multiple,Q=e.treeCheckable,X=e.treeCheckStrictly,Y=e.labelInValue,Z=e.fieldNames,$=e.treeDataSimpleMode,ee=e.treeData,te=e.children,ne=e.loadData,re=e.treeLoadedKeys,ae=e.onTreeLoad,oe=e.treeDefaultExpandAll,le=e.treeExpandedKeys,ie=e.treeDefaultExpandedKeys,ue=e.onTreeExpand,ce=e.treeExpandAction,de=e.virtual,se=e.listHeight,fe=void 0===se?200:se,ve=e.listItemHeight,pe=void 0===ve?20:ve,he=e.listItemScrollOffset,me=void 0===he?0:he,ye=e.onDropdownVisibleChange,ge=e.dropdownMatchSelectWidth,be=void 0===ge||ge,ke=e.treeLine,Ce=e.treeIcon,Ee=e.showTreeIcon,we=e.switcherIcon,Se=e.treeMotion,xe=e.treeTitleRender,De=i(e,_),Ie=v(g),Ne=Q&&!X,Te=Q||X,Le=X||Y,Me=Te||q,Ke=a(T,{value:w}),Ve=c(Ke,2),Oe=Ve[0],Pe=Ve[1],_e=h.useMemo((function(){return Q?z||O:K}),[z,Q]),He=h.useMemo((function(){return function(e){var t=e||{},n=t.label,r=t.value||"value";return{_title:n?[n]:["title","label"],value:r,key:r,children:t.children||"children"}}(Z)}),[JSON.stringify(Z)]),Ae=a("",{value:void 0!==A?A:R,postState:function(e){return e||""}}),Re=c(Ae,2),je=Re[0],We=Re[1],Fe=D(ee,te,$),Ue=function(e,t){return h.useMemo((function(){return y(e,{fieldNames:t,initWrapper:function(e){return o(o({},e),{},{valueEntities:new Map})},processEntity:function(e,n){var r=e.node[t.value];n.valueEntities.set(r,e)}})}),[e,t])}(Fe,He),Be=Ue.keyEntities,Ge=Ue.valueEntities,ze=h.useCallback((function(e){var t=[],n=[];return e.forEach((function(e){Ge.has(e)?n.push(e):t.push(e)})),{missingRawValues:t,existRawValues:n}}),[Ge]),Je=function(e,t,n){var r=n.treeNodeFilterProp,a=n.filterTreeNode,l=n.fieldNames.children;return h.useMemo((function(){if(!t||!1===a)return e;var n;if("function"==typeof a)n=a;else{var i=t.toUpperCase();n=function(e,t){var n=t[r];return String(n).toUpperCase().includes(i)}}return function e(r){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return r.reduce((function(r,i){var c=i[l],d=a||n(t,S(i)),s=e(c||[],d);return(d||s.length)&&r.push(o(o({},i),{},u({isLeaf:void 0},l,s))),r}),[])}(e)}),[e,t,l,r,a])}(Fe,je,{fieldNames:He,treeNodeFilterProp:G,filterTreeNode:U}),qe=h.useCallback((function(e){if(e){if(J)return e[J];for(var t=He._title,n=0;n<t.length;n+=1){var r=e[t[n]];if(void 0!==r)return r}}}),[He,J]),Qe=h.useCallback((function(e){var t=function(e){return Array.isArray(e)?e:void 0!==e?[e]:[]}(e);return t.map((function(e){return function(e){return!e||"object"!==s(e)}(e)?{value:e}:e}))}),[]),Xe=h.useCallback((function(e){return Qe(e).map((function(e){var t,n,r=e.label,a=e.value,o=e.halfChecked,l=Ge.get(a);if(l)r=null!==(n=r)&&void 0!==n?n:qe(l.node),t=l.node.disabled;else if(void 0===r){r=Qe(Oe).find((function(e){return e.value===a})).label}return{label:r,value:a,halfChecked:o,disabled:t}}))}),[Ge,qe,Qe,Oe]),Ye=h.useMemo((function(){return Qe(Oe)}),[Qe,Oe]),Ze=h.useMemo((function(){var e=[],t=[];return Ye.forEach((function(n){n.halfChecked?t.push(n):e.push(n)})),[e,t]}),[Ye]),$e=c(Ze,2),et=$e[0],tt=$e[1],nt=h.useMemo((function(){return et.map((function(e){return e.value}))}),[et]),rt=function(e,t,n,r){return h.useMemo((function(){var a=e.map((function(e){return e.value})),o=t.map((function(e){return e.value})),i=a.filter((function(e){return!r[e]}));if(n){var u=m(a,!0,r);a=u.checkedKeys,o=u.halfCheckedKeys}return[Array.from(new Set([].concat(l(i),l(a)))),o]}),[e,t,n,r])}(et,tt,Ne,Be),at=c(rt,2),ot=at[0],lt=at[1],it=h.useMemo((function(){var e=P(ot,_e,Be,He).map((function(e){var t,n;return null!==(t=null===(n=Be[e])||void 0===n||null===(n=n.node)||void 0===n?void 0:n[He.value])&&void 0!==t?t:e})).map((function(e){var t,n=et.find((function(t){return t.value===e}));return Y&&void 0!==n.label?t=n.label:!Y&&xe&&(t=xe(n)),{value:e,label:t}})),t=Xe(e),n=t[0];return!Me&&n&&k(n.value)&&k(n.label)?[]:t.map((function(e){var t;return o(o({},e),{},{label:null!==(t=e.label)&&void 0!==t?t:e.value})}))}),[He,Me,ot,et,Xe,_e,Be]),ut=(r=it,f=h.useRef({valueLabels:new Map}),h.useMemo((function(){var e=f.current.valueLabels,t=new Map,n=r.map((function(n){var r,a=n.value,l=null!==(r=n.label)&&void 0!==r?r:e.get(a);return t.set(a,l),o(o({},n),{},{label:l})}));return f.current.valueLabels=t,[n]}),[r])),ct=c(ut,1)[0],dt=x((function(e,n,r){var a=Xe(e);if(Pe(a),F&&We(""),L){var o=e;if(Ne){var i=P(e,_e,Be,He);o=i.map((function(e){var t=Ge.get(e);return t?t.node[He.value]:e}))}var u=n||{triggerValue:void 0,selected:void 0},c=u.triggerValue,d=u.selected,s=o;if(X){var f=tt.filter((function(e){return!o.includes(e.value)}));s=[].concat(l(s),l(f))}var v=Xe(s),p={preValue:et,triggerValue:c},m=!0;(X||"selection"===r&&!d)&&(m=!1),function(e,n,r,a,o,l){var i=null,u=null;function c(){u||(u=[],function e(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"0",o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return t.map((function(t,c){var d="".concat(a,"-").concat(c),s=t[l.value],f=r.includes(s),v=e(t[l.children]||[],d,f),p=h.createElement(C,t,v.map((function(e){return e.node})));if(n===s&&(i=p),f){var m={pos:d,node:p,children:v};return o||u.push(m),m}return null})).filter((function(e){return e}))}(a),u.sort((function(e,t){var n=e.node.props.value,a=t.node.props.value;return r.indexOf(n)-r.indexOf(a)})))}Object.defineProperty(e,"triggerNode",{get:function(){return t(!1,"`triggerNode` is deprecated. Please consider decoupling data with node."),c(),i}}),Object.defineProperty(e,"allCheckedNodes",{get:function(){return t(!1,"`allCheckedNodes` is deprecated. Please consider decoupling data with node."),c(),o?u:u.map((function(e){return e.node}))}})}(p,c,e,Fe,m,He),Te?p.checked=d:p.selected=d;var y=Le?v:v.map((function(e){return e.value}));L(Me?y:y[0],Le?null:v.map((function(e){return e.label})),p)}})),st=h.useCallback((function(e,t){var n,r=t.selected,a=t.source,o=Be[e],i=null==o?void 0:o.node,u=null!==(n=null==i?void 0:i[He.value])&&void 0!==n?n:e;if(Me){var c=r?[].concat(l(nt),[u]):ot.filter((function(e){return e!==u}));if(Ne){var d,s=ze(c),f=s.missingRawValues,v=s.existRawValues.map((function(e){return Ge.get(e).key}));if(r)d=m(v,!0,Be).checkedKeys;else d=m(v,{checked:!1,halfCheckedKeys:lt},Be).checkedKeys;c=[].concat(l(f),l(d.map((function(e){return Be[e].node[He.value]}))))}dt(c,{selected:r,triggerValue:u},a||"option")}else dt([u],{selected:!0,triggerValue:u},"option");r||!Me?null==V||V(u,S(i)):null==H||H(u,S(i))}),[ze,Ge,Be,He,Me,nt,dt,Ne,V,H,ot,lt]),ft=h.useCallback((function(e){if(ye){var n={};Object.defineProperty(n,"documentClickClose",{get:function(){return t(!1,"Second param of `onDropdownVisibleChange` has been removed."),!1}}),ye(e,n)}}),[ye]),vt=x((function(e,t){var n=e.map((function(e){return e.value}));"clear"!==t.type?t.values.length&&st(t.values[0].value,{selected:!1,source:"selection"}):dt(n,{},"selection")})),pt=h.useMemo((function(){return{virtual:de,dropdownMatchSelectWidth:be,listHeight:fe,listItemHeight:pe,listItemScrollOffset:me,treeData:Je,fieldNames:He,onSelect:st,treeExpandAction:ce,treeTitleRender:xe}}),[de,be,fe,pe,me,Je,He,st,ce,xe]),ht=h.useMemo((function(){return{checkable:Te,loadData:ne,treeLoadedKeys:re,onTreeLoad:ae,checkedKeys:ot,halfCheckedKeys:lt,treeDefaultExpandAll:oe,treeExpandedKeys:le,treeDefaultExpandedKeys:ie,onTreeExpand:ue,treeIcon:Ce,treeMotion:Se,showTreeIcon:Ee,switcherIcon:we,treeLine:ke,treeNodeFilterProp:G,keyEntities:Be}}),[Te,ne,re,ae,ot,lt,oe,le,ie,ue,Ce,Se,Ee,we,ke,G,Be]);return h.createElement(N.Provider,{value:pt},h.createElement(I.Provider,{value:ht},h.createElement(p,d({ref:n},De,{id:Ie,prefixCls:E,mode:Me?"multiple":void 0,displayValues:ct,onDisplayValuesChange:vt,searchValue:je,onSearch:function(e){We(e),null==j||j(e)},OptionList:M,emptyOptions:!Fe.length,onDropdownVisibleChange:ft,dropdownMatchSelectWidth:be}))))}));H.TreeNode=C,H.SHOW_ALL=K,H.SHOW_PARENT=V,H.SHOW_CHILD=O;export{H as G,K as S,C as T,V as a,O as b};
